{"version":3,"file":"bundle.js","sources":["../../../node_modules/util-deprecate/node.js","../../../node_modules/highland/lib/index.js","../../../node_modules/source-map/lib/base64.js","../../../node_modules/source-map/lib/base64-vlq.js","../../../node_modules/source-map/lib/util.js","../../../node_modules/source-map/lib/array-set.js","../../../node_modules/source-map/lib/binary-search.js","../../../node_modules/source-map/lib/quick-sort.js","../../../node_modules/source-map/lib/source-map-consumer.js","../../../node_modules/source-map/lib/source-node.js","../../../node_modules/source-map/source-map.js","../source/build-trace-collection.js","../source/src-map-reverse.js","../source/reverser.js","../source/index.js"],"sourcesContent":["\n/**\n * For Node.js, simply re-export the core `util.deprecate` function.\n */\n\nmodule.exports = require('util').deprecate;\n","/**\n * Highland: the high-level streams library\n *\n * Highland may be freely distributed under the Apache 2.0 license.\n * http://github.com/caolan/highland\n * Copyright (c) Caolan McMahon\n *\n */\n\n\nvar inherits = require('util').inherits;\nvar deprecate = require('util-deprecate');\nvar EventEmitter = require('events').EventEmitter;\nvar Decoder = require('string_decoder').StringDecoder;\n\n/**\n * The Stream constructor, accepts an array of values or a generator function\n * as an optional argument. This is typically the entry point to the Highland\n * APIs, providing a convenient way of chaining calls together.\n *\n * **Arrays -** Streams created from Arrays will emit each value of the Array\n * and then emit a [nil](#nil) value to signal the end of the Stream.\n *\n * **Generators -** These are functions which provide values for the Stream.\n * They are lazy and can be infinite, they can also be asynchronous (for\n * example, making a HTTP request). You emit values on the Stream by calling\n * `push(err, val)`, much like a standard Node.js callback. Once it has been\n * called, the generator function will not be called again unless you call\n * `next()`. This call to `next()` will signal you've finished processing the\n * current data and allow for the generator function to be called again. If the\n * Stream is still being consumed the generator function will then be called\n * again.\n *\n * You can also redirect a generator Stream by passing a new source Stream\n * to read from to next. For example: `next(other_stream)` - then any subsequent\n * calls will be made to the new source.\n *\n * **Node Readable Stream -** Pass in a Node Readable Stream object to wrap\n * it with the Highland API. Reading from the resulting Highland Stream will\n * begin piping the data from the Node Stream to the Highland Stream.\n *\n * A stream constructed in this way relies on `Readable#pipe` to end the\n * Highland Stream once there is no more data. Not all Readable Streams do\n * this. For example, `IncomingMessage` will only emit `close` when the client\n * aborts communications and will *not* properly call `end`. In this case, you\n * can provide an optional `onFinished` function with the signature\n * `onFinished(readable, callback)` as the second argument.\n *\n * This function will be passed the Readable and a callback that should called\n * when the Readable ends. If the Readable ended from an error, the error\n * should be passed as the first argument to the callback. `onFinished` should\n * bind to whatever listener is necessary to detect the Readable's completion.\n * If the callback is called multiple times, only the first invocation counts.\n * If the callback is called *after* the Readable has already ended (e.g., the\n * `pipe` method already called `end`), it will be ignored.\n *\n * The `onFinished` function may optionally return one of the following:\n *\n * - A cleanup function that will be called when the stream ends. It should\n * unbind any listeners that were added.\n * - An object with the following optional properties:\n *    - `onDestroy` - the cleanup function.\n *    - `continueOnError` - Whether or not to continue the stream when an\n *      error is passed to the callback. Set this to `true` if the Readable\n *      may continue to emit values after errors. Default: `false`.\n *\n * See [this issue](https://github.com/caolan/highland/issues/490) for a\n * discussion on why Highland cannot reliably detect stream completion for\n * all implementations and why the `onFinished` function is required.\n *\n * **EventEmitter / jQuery Elements -** Pass in both an event name and an\n * event emitter as the two arguments to the constructor and the first\n * argument emitted to the event handler will be written to the new Stream.\n *\n * You can pass a mapping hint as the third argument, which specifies how\n * event arguments are pushed into the stream. If no mapping hint is provided,\n * only the first value emitted with the event to the will be pushed onto the\n * Stream.\n *\n * If `mappingHint` is a number, an array of that length will be pushed onto\n * the stream, containing exactly that many parameters from the event. If it's\n * an array, it's used as keys to map the arguments into an object which is\n * pushed to the tream. If it is a function, it's called with the event\n * arguments, and the returned value is pushed.\n *\n * **Promise -** Accepts an ES6 / jQuery style promise and returns a\n * Highland Stream which will emit a single value (or an error). In case you use\n * [bluebird cancellation](http://bluebirdjs.com/docs/api/cancellation.html) Highland Stream will be empty for a cancelled promise.\n *\n * **Iterator -** Accepts an ES6 style iterator that implements the [iterator protocol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#The_.22iterator.22_protocol):\n * yields all the values from the iterator using its `next()` method and terminates when the\n * iterator's done value returns true. If the iterator's `next()` method throws, the exception will be emitted as an error,\n * and the stream will be ended with no further calls to `next()`.\n *\n * **Iterable -** Accepts an object that implements the [iterable protocol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#The_.22iterable.22_protocol),\n * i.e., contains a method that returns an object that conforms to the iterator protocol. The stream will use the\n * iterator defined in the `Symbol.iterator` property of the iterable object to generate emitted values.\n *\n * @id _(source)\n * @section Stream Objects\n * @name _(source)\n * @param {Array | Function | Iterator | Iterable | Promise | Readable Stream | String} source - (optional) source to take values from from\n * @param {Function} onFinished - (optional) a function that detects when the readable completes. Second argument. Only valid if `source` is a Readable.\n * @param {EventEmitter | jQuery Element} eventEmitter - (optional) An event emitter. Second argument. Only valid if `source` is a String.\n * @param {Array | Function | Number} mappingHint - (optional) how to pass the\n * arguments to the callback. Only valid if `source` is a String.\n * @api public\n *\n * // from an Array\n * _([1, 2, 3, 4]);\n *\n * // using a generator function\n * _(function (push, next) {\n *     push(null, 1);\n *     push(err);\n *     next();\n * });\n *\n * // a stream with no source, can pipe node streams through it etc.\n * var through = _();\n *\n * // wrapping a Node Readable Stream so you can easily manipulate it\n * _(readable).filter(hasSomething).pipe(writeable);\n *\n * // wrapping a Readable that may signify completion by emitting `close`\n * // (e.g., IncomingMessage).\n * _(req, function (req, callback) {\n *     req.on('end', callback)\n *         .on('close', callback)\n *         .on('error', callback);\n *\n *     return function () {\n *         req.removeListener('end', callback);\n *         req.removeListener('close', callback);\n *         req.removeListener('error', callback);\n *     };\n * }).pipe(writable);\n *\n * // wrapping a Readable that may emit values after errors.\n * _(req, function (req, callback) {\n *     req.on('error', callback);\n *\n *     return {\n *         onDestroy: function () {\n *             req.removeListener('error', callback);\n *         },\n *         continueOnError: true\n *     };\n * }).pipe(writable);\n *\n * // creating a stream from events\n * _('click', btn).each(handleEvent);\n *\n * // creating a stream from events with a mapping array\n * _('request', httpServer, ['req', 'res']).each(handleEvent);\n * //=> { req: IncomingMessage, res: ServerResponse }\n *\n * // creating a stream from events with a mapping function\n * _('request', httpServer, function(req, res) {\n *     return res;\n * }).each(handleEvent);\n * //=> IncomingMessage\n *\n * // from a Promise object\n * var foo = _($.getJSON('/api/foo'));\n *\n * //from an iterator\n * var map = new Map([['a', 1], ['b', 2]]);\n * var bar = _(map.values()).toArray(_.log);\n * //=> [1, 2]\n *\n * //from an iterable\n * var set = new Set([1, 2, 2, 3, 4]);\n * var bar = _(set).toArray(_.log);\n * //=> [ 1, 2, 3, 4]\n */\n\n/*eslint-disable no-multi-spaces */\nexports = module.exports = function (/*optional*/xs, /*optional*/secondArg, /*optional*/ mappingHint) {\n    /*eslint-enable no-multi-spaces */\n    return new Stream(xs, secondArg, mappingHint);\n};\n\nvar _ = exports;\n\n// Create quick slice reference variable for speed\nvar slice = Array.prototype.slice;\nvar hasOwn = Object.prototype.hasOwnProperty;\n\n// ES5 detected value, used for switch between ES5 and ES3 code\nvar isES5 = (function () {\n    'use strict';\n    return Function.prototype.bind && !this;\n}());\n\n\n_.isUndefined = function (x) {\n    return typeof x === 'undefined';\n};\n\n_.isFunction = function (x) {\n    return typeof x === 'function';\n};\n\n_.isObject = function (x) {\n    return typeof x === 'object' && x !== null;\n};\n\n_.isString = function (x) {\n    return typeof x === 'string';\n};\n\n_.isArray = Array.isArray || function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n};\n\n// setImmediate browser fallback\nif (typeof setImmediate === 'undefined') {\n    _.setImmediate = function (fn) {\n        setTimeout(fn, 0);\n    };\n}\n// check no process.stdout to detect browserify\nelse if (typeof process === 'undefined' || !(process.stdout)) {\n    // modern browser - but not a direct alias for IE10 compatibility\n    _.setImmediate = function (fn) {\n        setImmediate(fn);\n    };\n}\nelse {\n    _.setImmediate = setImmediate;\n}\n\n/**\n * The end of stream marker. This is sent along the data channel of a Stream\n * to tell consumers that the Stream has ended. See the example map code for\n * an example of detecting the end of a Stream.\n *\n * Note: `nil` is setup as a global where possible. This makes it convenient\n * to access, but more importantly lets Streams from different Highland\n * instances work together and detect end-of-stream properly. This is mostly\n * useful for NPM where you may have many different Highland versions installed.\n *\n * @id nil\n * @section Utils\n * @name _.nil\n * @api public\n *\n * var map = function (iter, source) {\n *     return source.consume(function (err, val, push, next) {\n *         if (err) {\n *             push(err);\n *             next();\n *         }\n *         else if (val === _.nil) {\n *             push(null, val);\n *         }\n *         else {\n *             push(null, iter(val));\n *             next();\n *         }\n *     });\n * };\n */\n\n// set up a global nil object in cases where you have multiple Highland\n// instances installed (often via npm)\nvar _global = this;\nif (typeof global !== 'undefined') {\n    _global = global;\n}\nelse if (typeof window !== 'undefined') {\n    _global = window;\n}\nif (!_global.nil) {\n    _global.nil = {};\n}\nvar nil = _.nil = _global.nil;\n\n/**\n * Transforms a function with specific arity (all arguments must be\n * defined) in a way that it can be called as a chain of functions until\n * the arguments list is saturated.\n *\n * This function is not itself curryable.\n *\n * @id curry\n * @name _.curry(fn, [*arguments])\n * @section Functions\n * @param {Function} fn - the function to curry\n * @param args.. - any number of arguments to pre-apply to the function\n * @returns Function\n * @api public\n *\n * fn = curry(function (a, b, c) {\n *     return a + b + c;\n * });\n *\n * fn(1)(2)(3) == fn(1, 2, 3)\n * fn(1, 2)(3) == fn(1, 2, 3)\n * fn(1)(2, 3) == fn(1, 2, 3)\n */\n\n_.curry = function (fn /* args... */) {\n    var args = slice.call(arguments);\n    return _.ncurry.apply(this, [fn.length].concat(args));\n};\n\n/**\n * Same as `curry` but with a specific number of arguments. This can be\n * useful when functions do not explicitly define all its parameters.\n *\n * This function is not itself curryable.\n *\n * @id ncurry\n * @name _.ncurry(n, fn, [args...])\n * @section Functions\n * @param {Number} n - the number of arguments to wait for before apply fn\n * @param {Function} fn - the function to curry\n * @param args... - any number of arguments to pre-apply to the function\n * @returns Function\n * @api public\n *\n * fn = ncurry(3, function () {\n *     return Array.prototype.join.call(arguments, '.');\n * });\n *\n * fn(1, 2, 3) == '1.2.3';\n * fn(1, 2)(3) == '1.2.3';\n * fn(1)(2)(3) == '1.2.3';\n */\n\n_.ncurry = function (n, fn /* args... */) {\n    var largs = slice.call(arguments, 2);\n    if (largs.length >= n) {\n        return fn.apply(this, largs.slice(0, n));\n    }\n\n    return _.partial.apply(this, [_.ncurry, n, fn].concat(largs));\n};\n\n/**\n * Partially applies the function (regardless of whether it has had curry\n * called on it). This will always postpone execution until at least the next\n * call of the partially applied function.\n *\n * @id partial\n * @name _.partial(fn, args...)\n * @section Functions\n * @param {Function} fn - function to partial apply\n * @param args... - the arguments to apply to the function\n * @api public\n *\n * var addAll = function () {\n *     var args = Array.prototype.slice.call(arguments);\n *     return foldl1(add, args);\n * };\n * var f = partial(addAll, 1, 2);\n * f(3, 4) == 10\n */\n\n_.partial = function (f /* args... */) {\n    var args = slice.call(arguments, 1);\n    return function () {\n        return f.apply(this, args.concat(slice.call(arguments)));\n    };\n};\n\n/**\n * Evaluates the function `fn` with the argument positions swapped. Only\n * works with functions that accept two arguments.\n *\n * @id flip\n * @name _.flip(fn, [x, y])\n * @section Functions\n * @param {Function} fn - function to flip argument application for\n * @param x - parameter to apply to the right hand side of f\n * @param y - parameter to apply to the left hand side of f\n * @api public\n *\n * div(2, 4) == 0.5\n * flip(div, 2, 4) == 2\n * flip(div)(2, 4) == 2\n */\n\n_.flip = _.curry(function (fn, x, y) { return fn(y, x); });\n\n/**\n * Creates a composite function, which is the application of function1 to\n * the results of function2. You can pass an arbitrary number of arguments\n * and have them composed. This means you can't partially apply the compose\n * function itself.\n *\n * @id compose\n * @name _.compose(fn1, fn2, ...)\n * @section Functions\n * @api public\n *\n * var add1 = add(1);\n * var mul3 = mul(3);\n *\n * var add1mul3 = compose(mul3, add1);\n * add1mul3(2) == 9\n */\n\n_.compose = function (/*functions...*/) {\n    var fns = slice.call(arguments).reverse();\n    return _.seq.apply(null, fns);\n};\n\n/**\n * The reversed version of [compose](#compose). Where arguments are in the\n * order of application.\n *\n * @id seq\n * @name _.seq(fn1, fn2, ...)\n * @section Functions\n * @api public\n *\n * var add1 = add(1);\n * var mul3 = mul(3);\n *\n * var add1mul3 = seq(add1, mul3);\n * add1mul3(2) == 9\n */\n\n_.seq = function () {\n    var fns = slice.call(arguments);\n    return function () {\n        if (!fns.length) {\n            return null;\n        }\n        var r = fns[0].apply(this, arguments);\n        for (var i = 1; i < fns.length; i++) {\n            r = fns[i].call(this, r);\n        }\n        return r;\n    };\n};\n\nfunction nop() {\n    // Do nothing.\n}\n\nfunction defaultReadableOnFinish(readable, callback) {\n    // It's possible that `close` is emitted *before* `end`, so we simply\n    // cannot handle that case. See\n    // https://github.com/caolan/highland/issues/490 for details.\n\n    // pipe already pushes on end, so no need to bind to `end`.\n\n    // write any errors into the stream\n    readable.once('error', callback);\n\n    return function () {\n        readable.removeListener('error', callback);\n    };\n}\n\nfunction pipeReadable(xs, onFinish, stream) {\n    var response = onFinish(xs, streamEndCb);\n    var unbound = false;\n\n    var cleanup = null;\n    var endOnError = true;\n\n    if (_.isFunction(response)) {\n        cleanup = response;\n    }\n    else if (response != null) {\n        cleanup = response.onDestroy;\n        endOnError = !response.continueOnError;\n    }\n\n    xs.pipe(stream);\n\n    // TODO: Replace with onDestroy in v3.\n    stream._destructors.push(unbind);\n\n    function streamEndCb(error) {\n        if (stream._nil_pushed) {\n            return;\n        }\n\n        if (error) {\n            stream.write(new StreamError(error));\n        }\n\n        if (error == null || endOnError) {\n            unbind();\n            stream.end();\n        }\n    }\n\n    function unbind() {\n        if (unbound) {\n            return;\n        }\n\n        unbound = true;\n\n        if (cleanup) {\n            cleanup();\n        }\n\n        if (xs.unpipe) {\n            xs.unpipe(stream);\n        }\n    }\n}\n\nfunction promiseStream(promise) {\n    var nilScheduled = false;\n    return _(function (push) {\n        // We need to push asynchronously so that errors thrown from handling\n        // these values are not caught by the promise. Also, return null so\n        // that bluebird-based promises don't complain about handlers being\n        // created but not returned. See\n        // https://github.com/caolan/highland/issues/588.\n        promise = promise.then(function (value) {\n            nilScheduled = true;\n            _.setImmediate(function () {\n                push(null, value);\n                push(null, nil);\n            });\n            return null;\n        }, function (err) {\n            nilScheduled = true;\n            _.setImmediate(function () {\n                push(err);\n                push(null, nil);\n            });\n            return null;\n        });\n\n        // Using finally also handles bluebird promise cancellation, so we do\n        // it if we can.\n        if (_.isFunction(promise['finally'])) { // eslint-disable-line dot-notation\n            promise['finally'](function () { // eslint-disable-line dot-notation\n                if (!nilScheduled) {\n                    _.setImmediate(function () {\n                        push(null, nil);\n                    });\n                }\n                return null;\n            });\n        }\n    });\n}\n\nfunction iteratorStream(it) {\n    return _(function (push, next) {\n        var iterElem, iterErr;\n        try {\n            iterElem = it.next();\n        }\n        catch (err) {\n            iterErr = err;\n        }\n\n        if (iterErr) {\n            push(iterErr);\n            push(null, _.nil);\n        }\n        else if (iterElem.done) {\n            if (!_.isUndefined(iterElem.value)) {\n                // generators can return a final\n                // value on completion using return\n                // keyword otherwise value will be\n                // undefined\n                push(null, iterElem.value);\n            }\n            push(null, _.nil);\n        }\n        else {\n            push(null, iterElem.value);\n            next();\n        }\n\n    });\n}\n\nfunction hintMapper(mappingHint) {\n    var mappingHintType = (typeof mappingHint);\n    var mapper;\n\n    if (mappingHintType === 'function') {\n        mapper = mappingHint;\n    }\n    else if (mappingHintType === 'number') {\n        mapper = function () {\n            return slice.call(arguments, 0, mappingHint);\n        };\n    }\n    else if (_.isArray(mappingHint)) {\n        mapper = function () {\n            var args = arguments;\n            return mappingHint.reduce(function (ctx, hint, idx) {\n                ctx[hint] = args[idx];\n                return ctx;\n            }, {});\n        };\n    }\n    else {\n        mapper = function (x) { return x; };\n    }\n\n    return mapper;\n}\n\nfunction pipeStream(src, dest, write, end, passAlongErrors) {\n    var resume = null;\n    var s = src.consume(function (err, x, push, next) {\n        var canContinue;\n        if (err) {\n            if (passAlongErrors) {\n                canContinue = write.call(dest, new StreamError(err));\n            }\n            else {\n                src.emit('error', err);\n                canContinue = true;\n            }\n        }\n        else if (x === nil) {\n            end.call(dest);\n            return;\n        }\n        else {\n            canContinue = write.call(dest, x);\n        }\n\n        if (canContinue !== false) {\n            next();\n        }\n        else {\n            resume = next;\n        }\n    });\n\n    dest.on('drain', onConsumerDrain);\n\n    // Since we don't keep a reference to piped-to streams,\n    // save a callback that will unbind the event handler.\n    src._destructors.push(function () {\n        dest.removeListener('drain', onConsumerDrain);\n    });\n\n    dest.emit('pipe', src);\n\n    s.resume();\n    return dest;\n\n    function onConsumerDrain() {\n        if (resume) {\n            var oldResume = resume;\n            resume = null;\n            oldResume();\n        }\n    }\n}\n\nfunction generatorPush(stream, write) {\n    if (!write) {\n        write = stream.write;\n    }\n\n    return function (err, x) {\n        // This will set _nil_pushed if necessary.\n        write.call(stream, err ? new StreamError(err) : x);\n    };\n}\n\n\n/**\n * Actual Stream constructor wrapped the the main exported function\n */\n\n/*eslint-disable no-multi-spaces */\nfunction Stream(/*optional*/xs, /*optional*/secondArg, /*optional*/mappingHint) {\n    /*eslint-enable no-multi-spaces */\n    if (xs && _.isStream(xs)) {\n        // already a Stream\n        return xs;\n    }\n\n    EventEmitter.call(this);\n    var self = this;\n\n    // used to detect Highland Streams using isStream(x), this\n    // will work even in cases where npm has installed multiple\n    // versions, unlike an instanceof check\n    self.__HighlandStream__ = true;\n\n    self.id = ('' + Math.random()).substr(2, 6);\n    this.paused = true;\n    this._incoming = [];\n    this._outgoing = [];\n    this._consumers = [];\n    this._observers = [];\n    this._destructors = [];\n    this._send_events = false;\n    this._nil_pushed = false;\n    this._delegate = null;\n    this._is_observer = false;\n    this._in_consume_cb = false;\n    this._repeat_resume = false;\n\n    // Used by consume() to signal that next() hasn't been called, so resume()\n    // shouldn't ask for more data. Backpressure handling is getting fairly\n    // complicated, and this is very much a hack to get consume() backpressure\n    // to work correctly.\n    this._consume_waiting_for_next = false;\n    this.source = null;\n\n    // Old-style node Stream.pipe() checks for this\n    this.writable = true;\n\n    self.on('newListener', function (ev) {\n        if (ev === 'data') {\n            self._send_events = true;\n            _.setImmediate(self.resume.bind(self));\n        }\n        else if (ev === 'end') {\n            // this property avoids us checking the length of the\n            // listners subscribed to each event on each _send() call\n            self._send_events = true;\n        }\n    });\n\n    // TODO: write test to cover this removeListener code\n    self.on('removeListener', function (ev) {\n        if (ev === 'end' || ev === 'data') {\n            var end_listeners = self.listeners('end').length;\n            var data_listeners = self.listeners('data').length;\n            if (end_listeners + data_listeners === 0) {\n                // stop emitting events\n                self._send_events = false;\n            }\n        }\n    });\n\n    if (_.isUndefined(xs)) {\n        // nothing else to do\n        return this;\n    }\n    else if (_.isArray(xs)) {\n        self._incoming = xs.concat([nil]);\n        return this;\n    }\n    else if (_.isFunction(xs)) {\n        this._generator = xs;\n        this._generator_push = generatorPush(this);\n        this._generator_next = function (s) {\n            if (self._nil_pushed) {\n                throw new Error('Cannot call next after nil');\n            }\n\n            if (s) {\n                // we MUST pause to get the redirect object into the _incoming\n                // buffer otherwise it would be passed directly to _send(),\n                // which does not handle StreamRedirect objects!\n                var _paused = self.paused;\n                if (!_paused) {\n                    self.pause();\n                }\n                self.write(new StreamRedirect(s));\n                if (!_paused) {\n                    self._resume(false);\n                }\n            }\n            else {\n                self._generator_running = false;\n            }\n            if (!self.paused) {\n                self._resume(false);\n            }\n        };\n\n        return this;\n    }\n    else if (_.isObject(xs)) {\n        // check to see if we have a readable stream\n        if (_.isFunction(xs.on) && _.isFunction(xs.pipe)) {\n            var onFinish = _.isFunction(secondArg) ? secondArg : defaultReadableOnFinish;\n            pipeReadable(xs, onFinish, self);\n            return this;\n        }\n        else if (_.isFunction(xs.then)) {\n            //probably a promise\n            return promiseStream(xs);\n        }\n        // must check iterators and iterables in this order\n        // because generators are both iterators and iterables:\n        // their Symbol.iterator method returns the `this` object\n        // and an infinite loop would result otherwise\n        else if (_.isFunction(xs.next)) {\n            //probably an iterator\n            return iteratorStream(xs);\n        }\n        else if (!_.isUndefined(_global.Symbol) && xs[_global.Symbol.iterator]) {\n            //probably an iterable\n            return iteratorStream(xs[_global.Symbol.iterator]());\n        }\n        else {\n            throw new Error(\n                'Object was not a stream, promise, iterator or iterable: ' + (typeof xs)\n            );\n        }\n    }\n    else if (_.isString(xs)) {\n        var mapper = hintMapper(mappingHint);\n\n        var callback_func = function () {\n            var ctx = mapper.apply(this, arguments);\n            self.write(ctx);\n        };\n\n        secondArg.on(xs, callback_func);\n        var removeMethod = secondArg.removeListener // EventEmitter\n                           || secondArg.unbind;     // jQuery\n\n        if (removeMethod) {\n            this._destructors.push(function() {\n                removeMethod.call(secondArg, xs, callback_func);\n            });\n        }\n\n        return this;\n    }\n    else {\n        throw new Error(\n            'Unexpected argument type to Stream(): ' + (typeof xs)\n        );\n    }\n}\ninherits(Stream, EventEmitter);\n\n/**\n * Creates a stream that sends a single value then ends.\n *\n * @id of\n * @section Utils\n * @name _.of(x)\n * @param x - the value to send\n * @returns Stream\n * @api public\n *\n * _.of(1).toArray(_.log); // => [1]\n */\n\n_.of = function (x) {\n    return _([x]);\n};\n\n/**\n * Creates a stream that sends a single error then ends.\n *\n * @id fromError\n * @section Utils\n * @name _.fromError(err)\n * @param error - the error to send\n * @returns Stream\n * @api public\n *\n * _.fromError(new Error('Single Error')).toCallback(function (err, result) {\n *     // err contains Error('Single Error') object\n * }\n */\n\n_.fromError = function (error) {\n    return _(function (push) {\n        push(error);\n        push(null, _.nil);\n    });\n};\n\n/**\n * adds a top-level _.foo(mystream) style export for Stream methods\n */\n\nfunction exposeMethod(name) {\n    var f = Stream.prototype[name];\n    var n = f.length;\n    _[name] = _.ncurry(n + 1, function () {\n        var args = slice.call(arguments);\n        var s = _(args.pop());\n        return f.apply(s, args);\n    });\n}\n\n/**\n * Used as an Error marker when writing to a Stream's incoming buffer\n */\n\nfunction StreamError(err) {\n    this.__HighlandStreamError__ = true;\n    this.error = err;\n}\n\n/**\n * Used as a Redirect marker when writing to a Stream's incoming buffer\n */\n\nfunction StreamRedirect(to) {\n    this.__HighlandStreamRedirect__ = true;\n    this.to = to;\n}\n\n/**\n * Returns true if `x` is a Highland Stream.\n *\n * @id isStream\n * @section Utils\n * @name _.isStream(x)\n * @param x - the object to test\n * @returns {Boolean}\n * @api public\n *\n * _.isStream('foo')  // => false\n * _.isStream(_([1,2,3]))  // => true\n */\n\n_.isStream = function (x) {\n    return _.isObject(x) && !!x.__HighlandStream__;\n};\n\n_._isStreamError = function (x) {\n    return _.isObject(x) && !!x.__HighlandStreamError__;\n};\n\n_._isStreamRedirect = function (x) {\n    return _.isObject(x) && !!x.__HighlandStreamRedirect__;\n};\n\n/**\n * Sends errors / data to consumers, observers and event handlers\n */\n\nStream.prototype._send = function (err, x) {\n    //console.log(['_send', this.id, err, x]);\n    var token;\n\n    if (this._consumers.length) {\n        token = err ? new StreamError(err) : x;\n        // this._consumers may be changed from under us,\n        // so we keep a copy.\n        var consumers = this._consumers;\n        for (var i = 0, len = consumers.length; i < len; i++) {\n            consumers[i].write(token);\n        }\n    }\n    if (this._observers.length) {\n        token = err ? new StreamError(err) : x;\n        // this._observers may be changed from under us,\n        // so we keep a copy.\n        var observers = this._observers;\n        for (var j = 0, len2 = observers.length; j < len2; j++) {\n            observers[j].write(token);\n        }\n    }\n    if (this._send_events) {\n        if (err) {\n            this.emit('error', err);\n        }\n        else if (x === nil) {\n            this.emit('end');\n        }\n        else {\n            this.emit('data', x);\n        }\n    }\n\n    if (x === nil) {\n        this._onEnd();\n    }\n};\n\n\nStream.prototype._onEnd = function _onEnd() {\n    if (this.ended) {\n        return;\n    }\n\n    this.pause();\n\n    this.ended = true;\n\n    if (this.source) {\n        var source = this.source;\n        source._removeConsumer(this);\n        source._removeObserver(this);\n    }\n\n    var i, len;\n\n    // _removeConsumer may modify this._consumers.\n    var consumers = this._consumers;\n    for (i = 0, len = consumers.length; i < len; i++) {\n        this._removeConsumer(consumers[i]);\n    }\n\n    // Don't use _removeObserver for efficiency reasons.\n    var observer;\n    for (i = 0, len = this._observers.length; i < len; i++) {\n        observer = this._observers[i];\n        if (observer.source === this) {\n            observer.source = null;\n        }\n    }\n\n    for (i = 0, len = this._destructors.length; i < len; i++) {\n        this._destructors[i].call(this);\n    }\n\n    this.source = null;\n    this._consumers = [];\n    this._incoming = [];\n    this._outgoing = [];\n    this._delegate = null;\n    this._generator = null;\n    this._observers = [];\n    this._destructors = [];\n};\n\n/**\n * Pauses the stream. All Highland Streams start in the paused state.\n *\n * It is unlikely that you will need to manually call this method.\n *\n * @id pause\n * @section Stream Objects\n * @name Stream.pause()\n * @api public\n *\n * var xs = _(generator);\n * xs.pause();\n */\n\nStream.prototype.pause = function () {\n    //console.log(['pause', this.id]);\n    this.paused = true;\n    if (!this._is_observer && this.source) {\n        this.source._checkBackPressure();\n    }\n};\n\n/**\n * When there is a change in downstream consumers, it will often ask\n * the parent Stream to re-check its state and pause/resume accordingly.\n */\n\nStream.prototype._checkBackPressure = function () {\n    if (!this._consumers.length) {\n        this._repeat_resume = false;\n        this.pause();\n        return;\n    }\n    for (var i = 0, len = this._consumers.length; i < len; i++) {\n        if (this._consumers[i].paused) {\n            this._repeat_resume = false;\n            this.pause();\n            return;\n        }\n    }\n\n    this._resume(false);\n};\n\n/**\n * Starts pull values out of the incoming buffer and sending them downstream,\n * this will exit early if this causes a downstream consumer to pause.\n */\n\nStream.prototype._readFromBuffer = function () {\n    //console.log(['_readFromBuffer', this.id, this.paused, this._incoming]);\n    var len = this._incoming.length;\n    var i = 0;\n    while (i < len && !this.paused) {\n        var x = this._incoming[i];\n        if (_._isStreamError(x)) {\n            this._send(x.error);\n        }\n        else if (_._isStreamRedirect(x)) {\n            this._redirect(x.to);\n        }\n        else {\n            this._send(null, x);\n        }\n        i++;\n    }\n    // remove processed data from _incoming buffer\n    this._incoming.splice(0, i);\n};\n\n/**\n * Starts pull values out of the incoming buffer and sending them downstream,\n * this will exit early if this causes a downstream consumer to pause.\n */\n\nStream.prototype._sendOutgoing = function () {\n    //console.log(['_sendOutgoing', this.id, this.paused, this._outgoing]);\n    var len = this._outgoing.length;\n    var i = 0;\n    while (i < len && !this.paused) {\n        var x = this._outgoing[i];\n        if (_._isStreamError(x)) {\n            Stream.prototype._send.call(this, x.error);\n        }\n        else if (_._isStreamRedirect(x)) {\n            this._redirect(x.to);\n        }\n        else {\n            Stream.prototype._send.call(this, null, x);\n        }\n        i++;\n    }\n    // remove processed data from _outgoing buffer\n    this._outgoing.splice(0, i);\n};\n\nStream.prototype._resume = function (forceResumeSource) {\n    //console.log(['resume', this.id]);\n    if (this._resume_running || this._in_consume_cb) {\n        //console.log(['resume already processing _incoming buffer, ignore resume call']);\n        // already processing _incoming buffer, ignore resume call\n        this._repeat_resume = true;\n        return;\n    }\n    this._resume_running = true;\n    do {\n        // use a repeat flag to avoid recursing resume() calls\n        this._repeat_resume = false;\n        this.paused = false;\n\n        // send values from outgoing buffer first\n        this._sendOutgoing();\n\n        // send values from incoming buffer before reading from source\n        this._readFromBuffer();\n\n        // we may have paused while reading from buffer\n        if (!this.paused && !this._is_observer) {\n            // ask parent for more data\n            if (this.source) {\n                if (!this._consume_waiting_for_next || forceResumeSource) {\n                    //console.log(['ask parent for more data']);\n                    this.source._checkBackPressure();\n                }\n            }\n            // run _generator to fill up _incoming buffer\n            else if (this._generator) {\n                //console.log(['run generator to fill up _incoming buffer']);\n                this._runGenerator();\n            }\n            else {\n                // perhaps a node stream is being piped in\n                this.emit('drain');\n            }\n        }\n    } while (this._repeat_resume);\n    this._resume_running = false;\n};\n\n/**\n * Resumes a paused Stream. This will either read from the Stream's incoming\n * buffer or request more data from an upstream source. Never call this method\n * on a stream that has been consumed (via a call to [consume](#consume) or any\n * other transform).\n *\n * @id resume\n * @section Stream Objects\n * @name Stream.resume()\n * @api public\n *\n * var xs = _(generator);\n * xs.resume();\n */\n\nStream.prototype.resume = function () {\n    this._resume(true);\n};\n\n/**\n * Ends a Stream. This is the same as sending a [nil](#nil) value as data.\n * You shouldn't need to call this directly, rather it will be called by\n * any [Node Readable Streams](http://nodejs.org/api/stream.html#stream_class_stream_readable)\n * you pipe in.\n *\n * Only call this function on streams that were constructed with no source\n * (i.e., with `_()`).\n *\n * @id end\n * @section Stream Objects\n * @name Stream.end()\n * @api public\n *\n * mystream.end();\n */\n\nStream.prototype.end = function () {\n    if (this._nil_pushed) {\n        // Allow ending multiple times.\n        return;\n    }\n\n    this.write(nil);\n};\n\n/**\n * Pipes a Highland Stream to a [Node Writable\n * Stream](http://nodejs.org/api/stream.html#stream_class_stream_writable).\n * This will pull all the data from the source Highland Stream and write it to\n * the destination, automatically managing flow so that the destination is not\n * overwhelmed by a fast source.\n *\n * Users may optionally pass an object that may contain any of these fields:\n *\n * - `end` - Ends the destination when this stream ends. Default: `true`. This\n *   option has no effect if the destination is either `process.stdout` or\n *   `process.stderr`. Those two streams are never ended.\n *\n * Like [Readable#pipe](https://nodejs.org/api/stream.html#stream_readable_pipe_destination_options),\n * this function will throw errors if there is no `error` handler installed on\n * the stream.\n *\n * This function returns the destination so you can chain together `pipe` calls.\n *\n * **NOTE**: While Highland streams created via `_()` and [pipeline](#pipeline)\n * support being piped to, it is almost never appropriate to `pipe` from a\n * Highland stream to another Highland stream. Those two cases are meant for\n * use when piping from *Node* streams. You might be tempted to use `pipe` to\n * construct reusable transforms. Do not do it. See [through](#through) for a\n * better way.\n *\n * @id pipe\n * @section Consumption\n * @name Stream.pipe(dest, options)\n * @param {Writable Stream} dest - the destination to write all data to\n * @param {Object} options - (optional) pipe options.\n * @api public\n *\n * var source = _(generator);\n * var dest = fs.createWriteStream('myfile.txt')\n * source.pipe(dest);\n *\n * // chained call\n * source.pipe(through).pipe(dest);\n *\n * // DO NOT do this! It will not work. The stream returned by oddDoubler does\n * // not support being piped to.\n * function oddDoubler() {\n *     return _()\n *         return x % 2; // odd numbers only\n *     })\n *     .map(function (x) {\n *         return x * 2;\n *     });\n * }\n *\n * _([1, 2, 3, 4]).pipe(oddDoubler()) // => Garbage\n */\n\nStream.prototype.pipe = function (dest, options) {\n    options = options || {};\n\n    // stdout and stderr are special case writables that cannot be closed\n    var canClose = dest !== process.stdout && dest !== process.stderr && options.end !== false;\n\n    var end;\n    if (canClose) {\n        end = dest.end;\n    }\n    else {\n        end = nop;\n    }\n\n    return pipeStream(this, dest, dest.write, end, false);\n};\n\n/**\n * Destroys a stream by unlinking it from any consumers and sources. This will\n * stop all consumers from receiving events from this stream and removes this\n * stream as a consumer of any source stream.\n *\n * This function calls end() on the stream and unlinks it from any piped-to streams.\n *\n * @id destroy\n * @section Stream Objects\n * @name Stream.destroy()\n * @api public\n */\n\nStream.prototype.destroy = function () {\n    if (this.ended) {\n        return;\n    }\n\n    if (!this._nil_pushed) {\n        this.end();\n    }\n\n    this._onEnd();\n};\n\n/**\n * Runs the generator function for this Stream. If the generator is already\n * running (it has been called and not called next() yet) then this function\n * will do nothing.\n */\n\nStream.prototype._runGenerator = function () {\n    //console.log(['_runGenerator', this.id]);\n    // if _generator already running, exit\n    if (this._generator_running) {\n        return;\n    }\n    this._generator_running = true;\n    this._generator(this._generator_push, this._generator_next);\n};\n\n/**\n * Performs the redirect from one Stream to another. In order for the\n * redirect to happen at the appropriate time, it is put on the incoming\n * buffer as a StreamRedirect object, and this function is called\n * once it is read from the buffer.\n */\n\nStream.prototype._redirect = function (to) {\n    //console.log(['_redirect', this.id, '=>', to.id]);\n    // coerce to Stream\n    to = _(to);\n\n    while (to._delegate) {\n        to = to._delegate;\n    }\n\n    to._consumers = this._consumers.map(function (c) {\n        c.source = to;\n        return c;\n    });\n\n    // TODO: copy _observers\n    this._consumers = [];\n    //[this.consume = function () {\n    //    return to.consume.apply(to, arguments);\n    //};\n    //this._removeConsumer = function () {\n    //    return to._removeConsumer.apply(to, arguments);\n    //};\n\n    // this will cause a memory leak as long as the root object is around\n    to._delegate_source = this._delegate_source || this;\n    to._delegate_source._delegate = to;\n\n    if (this.paused) {\n        to.pause();\n    }\n    else {\n        this.pause();\n        to._checkBackPressure();\n    }\n};\n\n/**\n * Adds a new consumer Stream, which will accept data and provide backpressure\n * to this Stream. Adding more than one consumer will cause an exception to be\n * thrown as the backpressure strategy must be explicitly chosen by the\n * developer (through calling fork or observe).\n */\n\nStream.prototype._addConsumer = function (s) {\n    if (this._consumers.length) {\n        throw new Error(\n            'Stream already being consumed, you must either fork() or observe()'\n        );\n    }\n    s.source = this;\n    this._consumers.push(s);\n    this._checkBackPressure();\n};\n\n/**\n * Removes a consumer from this Stream.\n */\n\nStream.prototype._removeConsumer = function (s) {\n    var src = this;\n    while (src._delegate) {\n        src = src._delegate;\n    }\n    src._consumers = src._consumers.filter(function (c) {\n        return c !== s;\n    });\n    if (s.source === src) {\n        s.source = null;\n    }\n    src._checkBackPressure();\n};\n\n/**\n * Removes an observer from this Stream.\n */\n\nStream.prototype._removeObserver = function (s) {\n    this._observers = this._observers.filter(function (o) {\n        return o !== s;\n    });\n    if (s.source === this) {\n        s.source = null;\n    }\n};\n\n/**\n * Consumes values from a Stream (once resumed) and returns a new Stream for\n * you to optionally push values onto using the provided push / next functions.\n *\n * This function forms the basis of many higher-level Stream operations.\n * It will not cause a paused stream to immediately resume, but behaves more\n * like a 'through' stream, handling values as they are read.\n *\n * @id consume\n * @section Transforms\n * @name Stream.consume(f)\n * @param {Function} f - the function to handle errors and values\n * @api public\n *\n * var filter = function (f, source) {\n *     return source.consume(function (err, x, push, next) {\n *         if (err) {\n *             // pass errors along the stream and consume next value\n *             push(err);\n *             next();\n *         }\n *         else if (x === _.nil) {\n *             // pass nil (end event) along the stream\n *             push(null, x);\n *         }\n *         else {\n *             // pass on the value only if the value passes the predicate\n *             if (f(x)) {\n *                 push(null, x);\n *             }\n *             next();\n *         }\n *     });\n * };\n */\n\nStream.prototype.consume = function (f) {\n    var self = this;\n    while (self._delegate) {\n        self = self._delegate;\n    }\n    var s = new Stream();\n\n    // Hack. Not needed in v3.0.\n    s._is_consumer = true;\n\n    var async;\n    var next_called;\n    var _send = s._send;\n    var push = function (err, x) {\n        //console.log(['push', err, x, s.paused]);\n        if (s._nil_pushed) {\n            throw new Error('Cannot write to stream after nil');\n        }\n        if (x === nil) {\n            // ended, remove consumer from source\n            s._nil_pushed = true;\n            s._consume_waiting_for_next = false;\n            self._removeConsumer(s);\n\n            // We previously paused the stream, but since a nil was pushed,\n            // next won't be called and we must manually resume.\n            if (async) {\n                s._resume(false);\n            }\n        }\n        if (s.paused) {\n            if (err) {\n                s._outgoing.push(new StreamError(err));\n            }\n            else {\n                s._outgoing.push(x);\n            }\n        }\n        else {\n            _send.call(s, err, x);\n        }\n    };\n    var next = function (s2) {\n        //console.log(['next', async]);\n        s._consume_waiting_for_next = false;\n        if (s._nil_pushed) {\n            throw new Error('Cannot call next after nil');\n        }\n        if (s2) {\n            // we MUST pause to get the redirect object into the _incoming\n            // buffer otherwise it would be passed directly to _send(),\n            // which does not handle StreamRedirect objects!\n            var _paused = s.paused;\n            if (!_paused) {\n                s.pause();\n            }\n            s.write(new StreamRedirect(s2));\n            if (!_paused) {\n                s._resume(false);\n            }\n        }\n        else if (async) {\n            s._resume(false);\n        }\n        else {\n            next_called = true;\n        }\n    };\n    s._send = function (err, x) {\n        async = false;\n        next_called = false;\n        s._in_consume_cb = true;\n\n        f(err, x, push, next);\n\n        s._in_consume_cb = false;\n        async = true;\n\n        // Don't pause if x is nil -- as next will never be called after\n        if (!next_called && x !== nil) {\n            s._consume_waiting_for_next = true;\n            s.pause();\n        }\n\n        if (s._repeat_resume) {\n            s._repeat_resume = false;\n            s._resume(false);\n        }\n    };\n    self._addConsumer(s);\n    self._already_consumed = true;\n    return s;\n};\nexposeMethod('consume');\n\n/**\n * Consumes a single item from the Stream. Unlike consume, this function will\n * not provide a new stream for you to push values onto, and it will unsubscribe\n * as soon as it has a single error, value or nil from the source.\n *\n * You probably won't need to use this directly, but it is used internally by\n * some functions in the Highland library.\n *\n * @id pull\n * @section Consumption\n * @name Stream.pull(f)\n * @param {Function} f - the function to handle data\n * @api public\n *\n * xs.pull(function (err, x) {\n *     // do something\n * });\n */\n\nStream.prototype.pull = function (f) {\n    var s = this.consume(function (err, x) {\n        s.source._removeConsumer(s);\n        f(err, x);\n    });\n    s.id = 'pull:' + s.id;\n    s.resume();\n};\n\n/**\n * Writes a value to the Stream. If the Stream is paused it will go into the\n * Stream's incoming buffer, otherwise it will be immediately processed and\n * sent to the Stream's consumers (if any). Returns false if the Stream is\n * paused, true otherwise. This lets Node's pipe method handle back-pressure.\n *\n * You shouldn't need to call this yourself, but it may be called by Node\n * functions which treat Highland Streams as a [Node Writable Stream](http://nodejs.org/api/stream.html#stream_class_stream_writable).\n *\n * Only call this function on streams that were constructed with no source\n * (i.e., with `_()`).\n\n * @id write\n * @section Stream Objects\n * @name Stream.write(x)\n * @param x - the value to write to the Stream\n * @api public\n *\n * var xs = _();\n * xs.write(1);\n * xs.write(2);\n * xs.end();\n *\n * xs.toArray(function (ys) {\n *     // ys will be [1, 2]\n * });\n *\n * // Do *not* do this.\n * var xs2 = _().toArray(_.log);\n * xs2.write(1); // This call is illegal.\n */\n\nStream.prototype.write = function (x) {\n    if (this._nil_pushed) {\n        throw new Error('Cannot write to stream after nil');\n    }\n\n    // The check for _is_consumer is kind of a hack. Not\n    // needed in v3.0.\n    if (x === _.nil && !this._is_consumer) {\n        this._nil_pushed = true;\n    }\n\n    if (this.paused) {\n        this._incoming.push(x);\n    }\n    else {\n        if (_._isStreamError(x)) {\n            this._send(x.error);\n        }\n        else {\n            this._send(null, x);\n        }\n    }\n    return !this.paused;\n};\n\n/**\n * Forks a stream, allowing you to add additional consumers with shared\n * back-pressure. A stream forked to multiple consumers will only pull values\n * from its source as fast as the slowest consumer can handle them.\n *\n * **NOTE**: Do not depend on a consistent execution order between the forks.\n * This transform only guarantees that all forks will process a value `foo`\n * before any will process a second value `bar`. It does *not* guarantee the\n * order in which the forks process `foo`.\n *\n * **TIP**: Be careful about modifying stream values within the forks (or using\n * a library that does so). Since the same value will be passed to every fork,\n * changes made in one fork will be visible in any fork that executes after it.\n * Add to that the inconsistent execution order, and you can end up with subtle\n * data corruption bugs. If you need to modify any values, you should make a\n * copy and modify the copy instead.\n *\n * *Deprecation warning:* It is currently possible to `fork` a stream after\n * [consuming](#consume) it (e.g., via a [transform](#Transforms)). This will\n * no longer be possible in the next major release. If you are going to `fork`\n * a stream, always call `fork` on it.\n *\n * @id fork\n * @section Higher-order Streams\n * @name Stream.fork()\n * @api public\n *\n * var xs = _([1, 2, 3, 4]);\n * var ys = xs.fork();\n * var zs = xs.fork();\n *\n * // no values will be pulled from xs until zs also resume\n * ys.resume();\n *\n * // now both ys and zs will get values from xs\n * zs.resume();\n */\n\n// Hack our way around the fact that util.deprecate is all-or-nothing for a\n// function.\nvar warnForkAfterConsume = deprecate(function () {\n}, 'Highland: Calling Stream.fork() on a stream that has already been consumed is deprecated. Always call fork() on a stream that is meant to be forked.');\n\nStream.prototype.fork = function () {\n    if (this._already_consumed) {\n        // Trigger deprecation warning.\n        warnForkAfterConsume();\n    }\n\n    var s = new Stream();\n    s.id = 'fork:' + s.id;\n    s.source = this;\n    this._consumers.push(s);\n    this._checkBackPressure();\n    return s;\n};\n\n/**\n * Observes a stream, allowing you to handle values as they are emitted, without\n * adding back-pressure or causing data to be pulled from the source. This can\n * be useful when you are performing two related queries on a stream where one\n * would block the other. Just be aware that a slow observer could fill up its\n * buffer and cause memory issues. Where possible, you should use [fork](#fork).\n *\n * @id observe\n * @section Higher-order Streams\n * @name Stream.observe()\n * @api public\n *\n * var xs = _([1, 2, 3, 4]);\n * var ys = xs.fork();\n * var zs = xs.observe();\n *\n * // now both zs and ys will receive data as fast as ys can handle it\n * ys.resume();\n */\n\nStream.prototype.observe = function () {\n    var s = new Stream();\n    s.id = 'observe:' + s.id;\n    s.source = this;\n    s._is_observer = true;\n    this._observers.push(s);\n    return s;\n};\n\n/**\n * Extracts errors from a Stream and applies them to an error handler\n * function. Returns a new Stream with the errors removed (unless the error\n * handler chooses to rethrow them using `push`). Errors can also be\n * transformed and put back onto the Stream as values.\n *\n * @id errors\n * @section Transforms\n * @name Stream.errors(f)\n * @param {Function} f - the function to pass all errors to\n * @api public\n *\n * getDocument.errors(function (err, push) {\n *     if (err.statusCode === 404) {\n *         // not found, return empty doc\n *         push(null, {});\n *     }\n *     else {\n *         // otherwise, re-throw the error\n *         push(err);\n *     }\n * });\n */\n\nStream.prototype.errors = function (f) {\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            f(err, push);\n            next();\n        }\n        else if (x === nil) {\n            push(null, nil);\n        }\n        else {\n            push(null, x);\n            next();\n        }\n    });\n};\nexposeMethod('errors');\n\n/**\n * Like the [errors](#errors) method, but emits a Stream end marker after\n * an Error is encountered.\n *\n * @id stopOnError\n * @section Transforms\n * @name Stream.stopOnError(f)\n * @param {Function} f - the function to handle an error\n * @api public\n *\n * brokenStream.stopOnError(function (err) {\n *     //console.error('Something broke: ' + err);\n * });\n */\n\nStream.prototype.stopOnError = function (f) {\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            f(err, push);\n            push(null, nil);\n        }\n        else if (x === nil) {\n            push(null, nil);\n        }\n        else {\n            push(null, x);\n            next();\n        }\n    });\n};\nexposeMethod('stopOnError');\n\n/**\n * Iterates over every value from the Stream, calling the iterator function\n * on each of them. This method consumes the Stream.\n *\n * If an error from the Stream reaches this call, it will emit an `error` event\n * (i.e., it will call `emit('error')` on the stream being consumed).  This\n * event will cause an error to be thrown if unhandled.\n *\n * While `each` consumes the stream, it is possible to chain [done](#done) (and\n * *only* `done`) after it.\n *\n * @id each\n * @section Consumption\n * @name Stream.each(f)\n * @param {Function} f - the iterator function\n * @api public\n *\n * _([1, 2, 3, 4]).each(function (x) {\n *     // will be called 4 times with x being 1, 2, 3 and 4\n * });\n */\n\nStream.prototype.each = function (f) {\n    var self = this;\n    var s = this.consume(function (err, x, push, next) {\n        if (err) {\n            self.emit('error', err);\n        }\n        else if (x === nil) {\n            push(null, nil);\n        }\n        else {\n            f(x);\n            next();\n        }\n    });\n    s.resume();\n    return s;\n};\nexposeMethod('each');\n\n/**\n * Applies all values from a Stream as arguments to a function. This method consumes the stream.\n * `f` will always be called when the `nil` token is encountered, even when the stream is empty.\n *\n * @id apply\n * @section Consumption\n * @name Stream.apply(f)\n * @param {Function} f - the function to apply arguments to\n * @api public\n *\n * _([1, 2, 3]).apply(function (a, b, c) {\n *     // a === 1\n *     // b === 2\n *     // c === 3\n * });\n *\n * _([1, 2, 3]).apply(function (a) {\n *     // arguments.length === 3\n *     // a === 1\n * });\n */\n\nStream.prototype.apply = function (f) {\n    return this.toArray(function (args) {\n        f.apply(null, args);\n    });\n};\nexposeMethod('apply');\n\n/**\n * Collects all values from a Stream into an Array and calls a function with\n * the result. This method consumes the stream.\n *\n * If an error from the Stream reaches this call, it will emit an `error` event\n * (i.e., it will call `emit('error')` on the stream being consumed).  This\n * event will cause an error to be thrown if unhandled.\n *\n * @id toArray\n * @section Consumption\n * @name Stream.toArray(f)\n * @param {Function} f - the callback to provide the completed Array to\n * @api public\n *\n * _([1, 2, 3, 4]).toArray(function (x) {\n *     // parameter x will be [1,2,3,4]\n * });\n */\n\nStream.prototype.toArray = function (f) {\n    var self = this;\n    return this.collect().pull(function (err, x) {\n        if (err) {\n            self.emit('error', err);\n        }\n        else {\n            f(x);\n        }\n    });\n};\n\n/**\n * Calls a function once the Stream has ended. This method consumes the stream.\n * If the Stream has already ended, the function is called immediately.\n *\n * If an error from the Stream reaches this call, it will emit an `error` event\n * (i.e., it will call `emit('error')` on the stream being consumed).  This\n * event will cause an error to be thrown if unhandled.\n *\n * As a special case, it is possible to chain `done` after a call to\n * [each](#each) even though both methods consume the stream.\n *\n * @id done\n * @section Consumption\n * @name Stream.done(f)\n * @param {Function} f - the callback\n * @api public\n *\n * var total = 0;\n * _([1, 2, 3, 4]).each(function (x) {\n *     total += x;\n * }).done(function () {\n *     // total will be 10\n * });\n */\n\nStream.prototype.done = function (f) {\n    if (this.ended) {\n        f();\n        return null;\n    }\n    var self = this;\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            self.emit('error', err);\n        }\n        else if (x === nil) {\n            f();\n        }\n        else {\n            next();\n        }\n    }).resume();\n};\n\n/**\n * Returns the result of a stream to a nodejs-style callback function.\n *\n * If the stream contains a single value, it will call `cb`\n * with the single item emitted by the stream (if present).\n * If the stream is empty, `cb` will be called without any arguments.\n * If an error is encountered in the stream, this function will stop\n * consumption and call `cb` with the error.\n * If the stream contains more than one item, it will stop consumption\n * and call `cb` with an error.\n *\n * @id toCallback\n * @section Consumption\n * @name Stream.toCallback(cb)\n * @param {Function} cb - the callback to provide the error/result to\n * @api public\n *\n * _([1, 2, 3, 4]).collect().toCallback(function (err, result) {\n *     // parameter result will be [1,2,3,4]\n *     // parameter err will be null\n * });\n */\n\nStream.prototype.toCallback = function (cb) {\n    var value;\n    var hasValue = false; // In case an emitted value === null or === undefined.\n\n    this.consume(function (err, x, push, next) {\n        if (err) {\n            push(null, nil);\n            if (hasValue) {\n                cb(new Error('toCallback called on stream emitting multiple values'));\n            }\n            else {\n                cb(err);\n            }\n        }\n        else if (x === nil) {\n            if (hasValue) {\n                cb(null, value);\n            }\n            else {\n                cb();\n            }\n        }\n        else {\n            if (hasValue) {\n                push(null, nil);\n                cb(new Error('toCallback called on stream emitting multiple values'));\n            }\n            else {\n                value = x;\n                hasValue = true;\n                next();\n            }\n        }\n    }).resume();\n};\n\n/**\n * Creates a new Stream of transformed values by applying a function to each\n * value from the source. The transformation function can be replaced with\n * a non-function value for convenience, and it will emit that value\n * for every data event on the source Stream.\n *\n * *Deprecation warning:* The use of the convenience non-function argument for\n * `map` is deprecated and will be removed in the next major version.\n *\n * @id map\n * @section Transforms\n * @name Stream.map(f)\n * @param {Function} f - the transformation function or value to map to\n * @api public\n *\n * var doubled = _([1, 2, 3, 4]).map(function (x) {\n *     return x * 2;\n * });\n */\n\n// Hack our way around the fact that util.deprecate is all-or-nothing for a\n// function.\nvar warnMapWithValue = deprecate(function() {\n}, 'Highland: Calling Stream.map() with a non-function argument is deprecated.');\n\nStream.prototype.map = function (f) {\n    if (!_.isFunction(f)) {\n        warnMapWithValue();\n        var val = f;\n        f = function () {\n            return val;\n        };\n    }\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(err, x);\n        }\n        else {\n            var fnVal, fnErr;\n            try {\n                fnVal = f(x);\n            }\n            catch (e) {\n                fnErr = e;\n            }\n            push(fnErr, fnVal);\n            next();\n        }\n    });\n};\nexposeMethod('map');\n\n/**\n * Creates a new Stream which applies a function to each value from the source\n * and re-emits the source value. Useful when you want to mutate the value or\n * perform side effects\n *\n * @id doto\n * @section Transforms\n * @name Stream.doto(f)\n * @param {Function} f - the function to apply\n * @api public\n *\n * var appended = _([[1], [2], [3], [4]]).doto(function (x) {\n *     x.push(1);\n * });\n *\n * _([1, 2, 3]).doto(console.log)\n * // 1\n * // 2\n * // 3\n * // => 1, 2, 3\n */\n\nStream.prototype.doto = function (f) {\n    return this.map(function (x) {\n        f(x);\n        return x;\n    });\n};\nexposeMethod('doto');\n\n/**\n * An alias for the [doto](#doto) method.\n *\n * @id tap\n * @section Transforms\n * @name Stream.tap(f)\n * @param {Function} f - the function to apply\n * @api public\n *\n * _([1, 2, 3]).tap(console.log)\n */\n\nStream.prototype.tap = Stream.prototype.doto;\n_.tap = _.doto;\n\n/**\n * Limits number of values through the stream to a maximum of number of values\n * per window. Errors are not limited but allowed to pass through as soon as\n * they are read from the source.\n *\n * @id ratelimit\n * @section Transforms\n * @name Stream.ratelimit(num, ms)\n * @param {Number} num - the number of operations to perform per window\n * @param {Number} ms - the window of time to limit the operations in (in ms)\n * @api public\n *\n * _([1, 2, 3, 4, 5]).ratelimit(2, 100);\n *\n * // after 0ms => 1, 2\n * // after 100ms => 1, 2, 3, 4\n * // after 200ms => 1, 2, 3, 4, 5\n */\n\nStream.prototype.ratelimit = function (num, ms) {\n    if (num < 1) {\n        throw new Error('Invalid number of operations per ms: ' + num);\n    }\n    var sent = 0;\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(null, nil);\n        }\n        else {\n            if (sent < num) {\n                sent++;\n                push(null, x);\n                next();\n            }\n            else {\n                setTimeout(function () {\n                    sent = 1;\n                    push(null, x);\n                    next();\n                }, ms);\n            }\n        }\n    });\n};\nexposeMethod('ratelimit');\n\n/**\n * Creates a new Stream of values by applying each item in a Stream to an\n * iterator function which must return a (possibly empty) Stream. Each item on\n * these result Streams are then emitted on a single output Stream.\n *\n * This transform is functionally equivalent to `.map(f).sequence()`.\n *\n * @id flatMap\n * @section Higher-order Streams\n * @name Stream.flatMap(f)\n * @param {Function} f - the iterator function\n * @api public\n *\n * var readFile = _.wrapCallback(fs.readFile);\n * filenames.flatMap(readFile)\n */\n\nStream.prototype.flatMap = function (f) {\n    return this.map(f).sequence();\n};\nexposeMethod('flatMap');\n\n/**\n * Retrieves values associated with a given property from all elements in\n * the collection.\n *\n * @id pluck\n * @section Transforms\n * @name Stream.pluck(property)\n * @param {String} prop - the property to which values should be associated\n * @api public\n *\n * var docs = [\n *     {type: 'blogpost', title: 'foo'},\n *     {type: 'blogpost', title: 'bar'},\n *     {type: 'comment', title: 'baz'}\n * ];\n *\n * _(docs).pluck('title').toArray(function (xs) {\n *    // xs is now ['foo', 'bar', 'baz']\n * });\n */\n\nStream.prototype.pluck = function (prop) {\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(err, x);\n        }\n        else if (_.isObject(x)) {\n            push(null, x[prop]);\n            next();\n        }\n        else {\n            push(new Error(\n                'Expected Object, got ' + (typeof x)\n            ));\n            next();\n        }\n    });\n};\nexposeMethod('pluck');\n\n/**\n * Only applies the transformation strategy on Objects.\n * This helper is used in `pick` and `pickBy`\n **/\n\nvar objectOnly = _.curry(function(strategy, x) {\n    if (_.isObject(x)) {\n        return strategy(x);\n    }\n    else {\n        throw new Error(\n            'Expected Object, got ' + (typeof x)\n        );\n    }\n});\n\n\n/**\n *\n * Retrieves copies of all the elements in the collection\n * that satisfy a given predicate. Note: When using ES3,\n * only enumerable elements are selected. Both enumerable\n * and non-enumerable elements are selected when using ES5.\n *\n * @id pickBy\n * @section Transforms\n * @name Stream.pickBy(f)\n * @param {Function} f - the predicate function\n * @api public\n *\n *  var dogs = [\n *      {breed: 'chihuahua', name: 'Princess', age: 5},\n *      {breed: 'labrador', name: 'Rocky', age: 3},\n *      {breed: 'german-shepherd', name: 'Waffles', age: 9}\n *  ];\n\n *  _(dogs).pickBy(function (key, value) {\n *      return value > 4;\n *  }).toArray(function (xs) {\n *    // xs is now:\n *    [\n *      { age: 5 },\n *      {},\n *      { age: 9 }\n *    ]\n *  });\n */\n\nStream.prototype.pickBy = function (f) {\n    return this.map(objectOnly(function (x) {\n        var out = {};\n\n        // prevents testing overridden properties multiple times.\n        var seen = isES5 ? Object.create(null) : {};\n        var obj = x;  // variable used to traverse prototype chain\n        function testAndAdd (prop) {\n            if (seen[prop] !== true && f(prop, x[prop])) {\n                out[prop] = x[prop];\n                seen[prop] = true;\n            }\n        }\n        if (isES5) {\n            do {\n                Object.getOwnPropertyNames(obj).forEach(testAndAdd);\n                obj = Object.getPrototypeOf(obj);\n            } while (obj);\n        }\n        else {\n            for (var k in x) {\n                testAndAdd(k);\n            }\n        }\n        return out;\n    }));\n};\nexposeMethod('pickBy');\n\n/**\n *\n * Retrieves copies of all elements in the collection,\n * with only the whitelisted keys. If one of the whitelisted\n * keys does not exist, it will be ignored.\n *\n * @id pick\n * @section Transforms\n * @name Stream.pick(properties)\n * @param {Array} properties - property names to white filter\n * @api public\n *\n * var dogs = [\n *      {breed: 'chihuahua', name: 'Princess', age: 5},\n *      {breed: 'labrador', name: 'Rocky', age: 3},\n *      {breed: 'german-shepherd', name: 'Waffles', age: 9}\n * ];\n *\n * _(dogs).pick(['breed', 'age']).toArray(function (xs) {\n *       // xs is now:\n *       [\n *           {breed: 'chihuahua', age: 5},\n *           {breed: 'labrador', age: 3},\n *           {breed: 'german-shepherd', age: 9}\n *       ]\n * });\n *\n * _(dogs).pick(['owner']).toArray(function (xs) {\n *      // xs is now:\n *      [\n *          {},\n *          {},\n *          {}\n *      ]\n * });*/\n\nStream.prototype.pick = function (properties) {\n    return this.map(objectOnly(function(x) {\n        var out = {};\n        for (var i = 0, length = properties.length; i < length; i++) {\n            var p = properties[i];\n            if (p in x) {\n                out[p] = x[p];\n            }\n        }\n        return out;\n    }));\n};\nexposeMethod('pick');\n\n/**\n * Creates a new Stream that includes only the values that pass a truth test.\n *\n * @id filter\n * @section Transforms\n * @name Stream.filter(f)\n * @param {Function} f - the truth test function\n * @api public\n *\n * var evens = _([1, 2, 3, 4]).filter(function (x) {\n *     return x % 2 === 0;\n * });\n */\n\nStream.prototype.filter = function (f) {\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(err, x);\n        }\n        else {\n            var fnVal, fnErr;\n            try {\n                fnVal = f(x);\n            }\n            catch (e) {\n                fnErr = e;\n            }\n\n            if (fnErr) {\n                push(fnErr);\n            }\n            else if (fnVal) {\n                push(null, x);\n            }\n            next();\n        }\n    });\n};\nexposeMethod('filter');\n\n/**\n * Filters using a predicate which returns a Stream. If you need to check\n * against an asynchronous data source when filtering a Stream, this can\n * be convenient. The Stream returned from the filter function should have\n * a Boolean as its first value (all other values on the Stream will be\n * disregarded).\n *\n * @id flatFilter\n * @section Higher-order Streams\n * @name Stream.flatFilter(f)\n * @param {Function} f - the truth test function which returns a Stream\n * @api public\n *\n * var checkExists = _.wrapCallback(fs.access);\n *\n * filenames.flatFilter(checkExists)\n */\n\nStream.prototype.flatFilter = function (f) {\n    return this.flatMap(function (x) {\n        return f(x).take(1).otherwise(errorStream())\n        .flatMap(function (bool) {\n            return _(bool ? [x] : []);\n        });\n    });\n\n    function errorStream() {\n        return _(function (push) {\n            push(new Error('Stream returned by function was empty.'));\n            push(null, _.nil);\n        });\n    }\n};\nexposeMethod('flatFilter');\n\n/**\n * The inverse of [filter](#filter).\n *\n * @id reject\n * @section Transforms\n * @name Stream.reject(f)\n * @param {Function} f - the truth test function\n * @api public\n *\n * var odds = _([1, 2, 3, 4]).reject(function (x) {\n *     return x % 2 === 0;\n * });\n */\n\nStream.prototype.reject = function (f) {\n    return this.filter(_.compose(_.not, f));\n};\nexposeMethod('reject');\n\n/**\n * A convenient form of [filter](#filter), which returns the first object from a\n * Stream that passes the provided truth test.\n *\n * @id find\n * @section Transforms\n * @name Stream.find(f)\n * @param {Function} f - the truth test function which returns a Stream\n * @api public\n *\n * var docs = [\n *     {type: 'blogpost', title: 'foo'},\n *     {type: 'blogpost', title: 'bar'},\n *     {type: 'comment', title: 'foo'}\n * ];\n *\n * var f = function (x) {\n *     return x.type == 'blogpost';\n * };\n *\n * _(docs).find(f);\n * // => {type: 'blogpost', title: 'foo'}\n *\n * // example with partial application\n * var firstBlogpost = _.find(f);\n *\n * firstBlogpost(docs)\n * // => {type: 'blogpost', title: 'foo'}\n */\n\nStream.prototype.find = function (f) {\n    return this.filter(f).take(1);\n};\nexposeMethod('find');\n\n/**\n * A convenient form of [where](#where), which returns the first object from a\n * Stream that matches a set of property values. findWhere is to [where](#where) as [find](#find) is to [filter](#filter).\n *\n * @id findWhere\n * @section Transforms\n * @name Stream.findWhere(props)\n * @param {Object} props - the properties to match against\n * @api public\n *\n * var docs = [\n *     {type: 'blogpost', title: 'foo'},\n *     {type: 'blogpost', title: 'bar'},\n *     {type: 'comment', title: 'foo'}\n * ];\n *\n * _(docs).findWhere({type: 'blogpost'})\n * // => {type: 'blogpost', title: 'foo'}\n *\n * // example with partial application\n * var firstBlogpost = _.findWhere({type: 'blogpost'});\n *\n * firstBlogpost(docs)\n * // => {type: 'blogpost', title: 'foo'}\n */\n\nStream.prototype.findWhere = function (props) {\n    return this.where(props).take(1);\n};\nexposeMethod('findWhere');\n\n\n/**\n * A convenient form of [reduce](#reduce), which groups items based on a function or property name\n *\n * @id group\n * @section Transforms\n * @name Stream.group(f)\n * @param {Function | String} f - the function or property name on which to group,\n *                              toString() is called on the result of a function.\n * @api public\n *\n * var docs = [\n *     {type: 'blogpost', title: 'foo'},\n *     {type: 'blogpost', title: 'bar'},\n *     {type: 'comment', title: 'foo'}\n * ];\n *\n * var f = function (x) {\n *     return x.type;\n * };\n *\n * _(docs).group(f); OR _(docs).group('type');\n * // => {\n * // =>    'blogpost': [{type: 'blogpost', title: 'foo'}, {type: 'blogpost', title: 'bar'}]\n * // =>    'comment': [{type: 'comment', title: 'foo'}]\n * // =>  }\n *\n */\n\nStream.prototype.group = function (f) {\n    var lambda = _.isString(f) ? _.get(f) : f;\n    return this.reduce({}, function (m, o) {\n        var key = lambda(o);\n        if (!hasOwn.call(m, key)) { m[key] = []; }\n        m[key].push(o);\n        return m;\n    });\n};\nexposeMethod('group');\n\n/**\n * Filters a Stream to drop all non-truthy values.\n *\n * @id compact\n * @section Transforms\n * @name Stream.compact()\n * @api public\n *\n * var compacted = _([0, 1, false, 3, null, undefined, 6]).compact();\n * // => 1, 3, 6\n */\n\nStream.prototype.compact = function () {\n    return this.filter(function (x) {\n        return x;\n    });\n};\nexposeMethod('compact');\n\n/**\n * A convenient form of [filter](#filter), which returns all objects from a Stream\n * which match a set of property values.\n *\n * @id where\n * @section Transforms\n * @name Stream.where(props)\n * @param {Object} props - the properties to match against\n * @api public\n *\n * var docs = [\n *     {type: 'blogpost', title: 'foo'},\n *     {type: 'blogpost', title: 'bar'},\n *     {type: 'comment', title: 'foo'}\n * ];\n *\n * _(docs).where({title: 'foo'})\n * // => {type: 'blogpost', title: 'foo'}\n * // => {type: 'comment', title: 'foo'}\n *\n * // example with partial application\n * var getBlogposts = _.where({type: 'blogpost'});\n *\n * getBlogposts(docs)\n * // => {type: 'blogpost', title: 'foo'}\n * // => {type: 'blogpost', title: 'bar'}\n */\n\nStream.prototype.where = function (props) {\n    return this.filter(function (x) {\n        for (var k in props) {\n            if (x[k] !== props[k]) {\n                return false;\n            }\n        }\n        return true;\n    });\n};\nexposeMethod('where');\n\n/**\n * Filters out all duplicate values from the stream and keeps only the first\n * occurence of each value, using the provided function to define equality.\n *\n * Note:\n *\n * - Memory: In order to guarantee that each unique item is chosen only once,\n *   we need to keep an internal buffer of all unique values. This may outgrow\n *   the available memory if you are not cautious about the size of your stream\n *   and the number of unique objects you may receive on it.\n * - Errors: The comparison function should never throw an error. However, if\n *   it does, this transform will emit an error for each all that throws. This\n *   means that one value may turn into multiple errors.\n *\n * @id uniqBy\n * @section Transforms\n * @name Stream.uniqBy(compare)\n * @param {Function} compare - custom equality predicate\n * @api public\n *\n * var colors = [ 'blue', 'red', 'red', 'yellow', 'blue', 'red' ]\n *\n * _(colors).uniqBy(function(a, b) { return a[1] === b[1]; })\n * // => 'blue'\n * // => 'red'\n *\n */\n\nStream.prototype.uniqBy = function (compare) {\n    var uniques = [];\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(err, x);\n        }\n        else {\n            var seen = false;\n            var hasErr;\n            for (var i = 0, len = uniques.length; i < len; i++) {\n                try {\n                    seen = compare(x, uniques[i]);\n                }\n                catch (e) {\n                    hasErr = e;\n                    seen = true;\n                }\n                if (seen) {\n                    break;\n                }\n            }\n            if (!seen) {\n                uniques.push(x);\n                push(null, x);\n            }\n            if (hasErr) {\n                push(hasErr);\n            }\n            next();\n        }\n    });\n};\nexposeMethod('uniqBy');\n\n/**\n * Filters out all duplicate values from the stream and keeps only the first\n * occurence of each value, using `===` to define equality.\n *\n * Like [uniqBy](#uniqBy), this transform needs to store a buffer containing\n * all unique values that has been encountered. Be careful about using this\n * transform on a stream that has many unique values.\n *\n * @id uniq\n * @section Transforms\n * @name Stream.uniq()\n * @api public\n *\n * var colors = [ 'blue', 'red', 'red', 'yellow', 'blue', 'red' ]\n *\n * _(colors).uniq()\n * // => 'blue'\n * // => 'red'\n * // => 'yellow'\n */\n\nStream.prototype.uniq = function () {\n    if (!_.isUndefined(_global.Set)) {\n        var uniques = new _global.Set(),\n            size = uniques.size;\n\n        return this.consume(function (err, x, push, next) {\n            if (err) {\n                push(err);\n                next();\n            }\n            else if (x === nil) {\n                push(err, x);\n            }\n            // pass NaN through as Set does not respect strict\n            // equality in this case.\n            else if (x !== x) {\n                push(null, x);\n                next();\n            }\n            else {\n                uniques.add(x);\n                if (uniques.size > size) {\n                    size = uniques.size;\n                    push(null, x);\n                }\n                next();\n            }\n        });\n    }\n    return this.uniqBy(function (a, b) {\n        return a === b;\n    });\n};\nexposeMethod('uniq');\n\n/**\n * Takes a *finite* stream of streams and returns a stream where the first\n * element from each separate stream is combined into a single data event,\n * followed by the second elements of each stream and so on until the shortest\n * input stream is exhausted.\n *\n * *Note:* This transform will be renamed `zipAll` in the next major version\n * release.\n *\n * @id zipAll0\n * @section Higher-order Streams\n * @name Stream.zipAll0()\n * @api public\n *\n * _([\n *     _([1, 2, 3]),\n *     _([4, 5, 6]),\n *     _([7, 8, 9]),\n *     _([10, 11, 12])\n * ]).zipAll0()\n * // => [1, 4, 7, 10], [2, 5, 8, 11], [3, 6, 9, 12]\n *\n * // shortest stream determines length of output stream\n * _([\n *     _([1, 2, 3, 4]),\n *     _([5, 6, 7, 8]),\n *     _([9, 10, 11, 12]),\n *     _([13, 14])\n * ]).zipAll0()\n * // => [1, 5, 9, 13], [2, 6, 10, 14]\n */\n\nStream.prototype.zipAll0 = function () {\n    var returned = 0;\n    var z = [];\n    var finished = false;\n\n    function nextValue(index, max, src, push, next) {\n        src.pull(function (err, x) {\n            if (err) {\n                push(err);\n                nextValue(index, max, src, push, next);\n            }\n            else if (x === _.nil) {\n                if (!finished) {\n                    finished = true;\n                    push(null, nil);\n                }\n            }\n            else {\n                returned++;\n                z[index] = x;\n                if (returned === max) {\n                    push(null, z);\n                    next();\n                }\n            }\n        });\n    }\n\n    return this.collect().flatMap(function (array) {\n        if (!array.length) {\n            return _([]);\n        }\n\n        return _(function (push, next) {\n            returned = 0;\n            z = [];\n            for (var i = 0, length = array.length; i < length; i++) {\n                nextValue(i, length, array[i], push, next);\n            }\n        });\n    });\n\n};\nexposeMethod('zipAll0');\n\n/**\n * Takes a stream and a *finite* stream of `N` streams\n * and returns a stream of the corresponding `(N+1)`-tuples.\n *\n * *Note:* This transform will be renamed `zipEach` in the next major version\n * release.\n *\n * @id zipAll\n * @section Higher-order Streams\n * @name Stream.zipAll(ys)\n * @param {Array | Stream} ys - the array of streams to combine values with\n * @api public\n *\n * _([1,2,3]).zipAll([[4, 5, 6], [7, 8, 9], [10, 11, 12]])\n * // => [1, 4, 7, 10], [2, 5, 8, 11], [3, 6, 9, 12]\n *\n * // shortest stream determines length of output stream\n * _([1, 2, 3, 4]).zipAll([[5, 6, 7, 8], [9, 10, 11, 12], [13, 14]])\n * // => [1, 5, 9, 13], [2, 6, 10, 14]\n */\n\nStream.prototype.zipAll = function (ys) {\n    return _([this]).concat(_(ys).map(_)).zipAll0();\n};\nexposeMethod('zipAll');\n\n/**\n * Takes two Streams and returns a Stream of corresponding pairs. The size of\n * the resulting stream is the smaller of the two source streams.\n *\n * @id zip\n * @section Higher-order Streams\n * @name Stream.zip(ys)\n * @param {Array | Stream} ys - the other stream to combine values with\n * @api public\n *\n * _(['a', 'b', 'c']).zip([1, 2, 3])  // => ['a', 1], ['b', 2], ['c', 3]\n *\n * _(['a', 'b', 'c']).zip(_([1]))  // => ['a', 1]\n */\n\nStream.prototype.zip = function (ys) {\n    return _([this, _(ys)]).zipAll0();\n};\nexposeMethod('zip');\n\n/**\n * Takes one Stream and batches incoming data into arrays of given length\n *\n * @id batch\n * @section Transforms\n * @name Stream.batch(n)\n * @param {Number} n - length of the array to batch\n * @api public\n *\n * _([1, 2, 3, 4, 5]).batch(2)  // => [1, 2], [3, 4], [5]\n */\n\nStream.prototype.batch = function (n) {\n    return this.batchWithTimeOrCount(-1, n);\n};\nexposeMethod('batch');\n\n/**\n * Takes one Stream and batches incoming data within a maximum time frame\n * into arrays of a maximum length.\n *\n * @id batchWithTimeOrCount\n * @section Transforms\n * @name Stream.batchWithTimeOrCount(ms, n)\n * @param {Number} ms - the maximum milliseconds to buffer a batch\n * @param {Number} n - the maximum length of the array to batch\n * @api public\n *\n * _(function (push) {\n *     push(1);\n *     push(2);\n *     push(3);\n *     setTimeout(push, 20, 4);\n * }).batchWithTimeOrCount(10, 2)\n *\n * // => [1, 2], [3], [4]\n */\n\nStream.prototype.batchWithTimeOrCount = function (ms, n) {\n    var batched = [],\n        timeout;\n\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            if (batched.length > 0) {\n                push(null, batched);\n                clearTimeout(timeout);\n            }\n\n            push(null, nil);\n        }\n        else {\n            batched.push(x);\n\n            if (batched.length === n) {\n                push(null, batched);\n                batched = [];\n                clearTimeout(timeout);\n            }\n            else if (batched.length === 1 && ms >= 0) {\n                timeout = setTimeout(function () {\n                    push(null, batched);\n                    batched = [];\n                }, ms);\n            }\n\n            next();\n        }\n    });\n};\nexposeMethod('batchWithTimeOrCount');\n\n/**\n * Creates a new Stream with the separator interspersed between the elements of the source.\n *\n * `intersperse` is effectively the inverse of [splitBy](#splitBy).\n *\n * @id intersperse\n * @section Transforms\n * @name Stream.intersperse(sep)\n * @param {String} sep - the value to intersperse between the source elements\n * @api public\n *\n * _(['ba', 'a', 'a']).intersperse('n')  // => 'ba', 'n', 'a', 'n', 'a'\n * _(['mississippi']).splitBy('ss').intersperse('ss')  // => 'mi', 'ss', 'i', 'ss', 'ippi'\n * _(['foo']).intersperse('bar')  // => 'foo'\n */\n\nStream.prototype.intersperse = function (separator) {\n    var started = false;\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(null, nil);\n        }\n        else {\n            if (started) {\n                push(null, separator);\n            }\n            else {\n                started = true;\n            }\n            push(null, x);\n            next();\n        }\n    });\n};\nexposeMethod('intersperse');\n\n/**\n * Splits the source Stream by a separator and emits the pieces in between, much like splitting a string.\n *\n * `splitBy` is effectively the inverse of [intersperse](#intersperse).\n *\n * @id splitBy\n * @section Transforms\n * @name Stream.splitBy(sep)\n * @param {String | RegExp} sep - the separator to split on\n * @api public\n *\n * _(['mis', 'si', 's', 'sippi']).splitBy('ss')  // => 'mi', 'i', 'ippi'\n * _(['ba', 'a', 'a']).intersperse('n').splitBy('n')  // => 'ba', 'a', 'a'\n * _(['foo']).splitBy('bar')  // => 'foo'\n */\n\nStream.prototype.splitBy = function (sep) {\n    var decoder = new Decoder();\n    var buffer = false;\n\n    function drain(x, push) {\n        buffer = (buffer || '') + decoder.write(x);\n        var pieces = buffer.split(sep);\n        buffer = pieces.pop();\n\n        pieces.forEach(function (piece) {\n            push(null, piece);\n        });\n    }\n\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            if (_.isString(buffer)) {\n                drain(decoder.end(), push);\n                push(null, buffer);\n            }\n            push(null, nil);\n        }\n        else {\n            drain(x, push);\n            next();\n        }\n    });\n};\nexposeMethod('splitBy');\n\n/**\n * [splitBy](#splitBy) over newlines.\n *\n * @id split\n * @section Transforms\n * @name Stream.split()\n * @api public\n *\n * _(['a\\n', 'b\\nc\\n', 'd', '\\ne']).split()  // => 'a', 'b', 'c', 'd', 'e'\n * _(['a\\r\\nb\\nc']]).split()  // => 'a', 'b', 'c'\n */\n\nStream.prototype.split = function () {\n    return this.splitBy(/\\r?\\n/);\n};\nexposeMethod('split');\n\n/**\n * Creates a new Stream with the values from the source in the range of `start` (inclusive) to `end` (exclusive).\n * `start` and `end` must be of type `Number`, if `start` is not a `Number` it will default to `0`\n * and, likewise, `end` will default to `Infinity`: this could result in the whole stream being be\n * returned.\n *\n * @id slice\n * @section Transforms\n * @name Stream.slice(start, end)\n * @param {Number} start - integer representing index to start reading from source (inclusive)\n * @param {Number} stop - integer representing index to stop reading from source (exclusive)\n * @api public\n *\n * _([1, 2, 3, 4]).slice(1, 3) // => 2, 3\n */\n\nStream.prototype.slice = function(start, end) {\n    var index = 0;\n    start = typeof start != 'number' || start < 0 ? 0 : start;\n    end = typeof end != 'number' ? Infinity : end;\n\n    if (start === 0 && end === Infinity) {\n        return this;\n    }\n    else if (start >= end) {\n        return _([]);\n    }\n    var s = this.consume(function (err, x, push, next) {\n        var done = x === nil;\n        if (err) {\n            push(err);\n        }\n        else if (!done && index++ >= start) {\n            push(null, x);\n        }\n\n        if (!done && index < end) {\n            next();\n        }\n        else {\n            push(null, nil);\n        }\n    });\n    s.id = 'slice:' + s.id;\n    return s;\n};\nexposeMethod('slice');\n\n/**\n * Creates a new Stream with the first `n` values from the source. `n` must be of type `Number`,\n * if not the whole stream will be returned.\n *\n * @id take\n * @section Transforms\n * @name Stream.take(n)\n * @param {Number} n - integer representing number of values to read from source\n * @api public\n *\n * _([1, 2, 3, 4]).take(2) // => 1, 2\n */\n\nStream.prototype.take = function (n) {\n    var s = this.slice(0, n);\n    s.id = 'take:' + s.id;\n    return s;\n};\nexposeMethod('take');\n\n/**\n * Acts as the inverse of [`take(n)`](#take) - instead of returning the first `n` values, it ignores the\n * first `n` values and then emits the rest. `n` must be of type `Number`, if not the whole stream will\n * be returned. All errors (even ones emitted before the nth value) will be emitted.\n *\n * @id drop\n * @section Transforms\n * @name Stream.drop(n)\n * @param {Number} n - integer representing number of values to read from source\n * @api public\n *\n * _([1, 2, 3, 4]).drop(2) // => 3, 4\n */\n\nStream.prototype.drop = function (n) {\n    return this.slice(n, Infinity);\n};\nexposeMethod('drop');\n\n/**\n * Creates a new Stream with only the first value from the source.\n *\n * @id head\n * @section Transforms\n * @name Stream.head()\n * @api public\n *\n * _([1, 2, 3, 4]).head() // => 1\n */\n\nStream.prototype.head = function () {\n    return this.take(1);\n};\nexposeMethod('head');\n\n/**\n * Drops all values from the Stream apart from the last one (if any).\n *\n * @id last\n * @section Transforms\n * @name Stream.last()\n * @api public\n *\n * _([1, 2, 3, 4]).last()  // => 4\n */\n\nStream.prototype.last = function () {\n    var nothing = {};\n    var prev = nothing;\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            if (prev !== nothing) {\n                push(null, prev);\n            }\n            push(null, nil);\n        }\n        else {\n            prev = x;\n            next();\n        }\n    });\n};\nexposeMethod('last');\n\n/**\n * Collects all values together then emits each value individually in sorted\n * order. The method for sorting the elements is defined by the comparator\n * function supplied as a parameter.\n *\n * The comparison function takes two arguments `a` and `b` and should return\n *\n * - a negative number if `a` should sort before `b`.\n * - a positive number if `a` should sort after `b`.\n * - zero if `a` and `b` may sort in any order (i.e., they are equal).\n *\n * This function must also define a [partial\n * order](https://en.wikipedia.org/wiki/Partially_ordered_set). If it does not,\n * the resulting ordering is undefined.\n *\n * @id sortBy\n * @section Transforms\n * @name Stream.sortBy(f)\n * @param {Function} f - the comparison function\n * @api public\n *\n * var sorts = _([3, 1, 4, 2]).sortBy(function (a, b) {\n *     return b - a;\n * }).toArray(_.log);\n *\n * //=> [4, 3, 2, 1]\n */\n\nStream.prototype.sortBy = function (f) {\n    return this.collect().invoke('sort', [f]).sequence();\n};\nexposeMethod('sortBy');\n\n/**\n * Collects all values together then emits each value individually but in sorted order.\n * The method for sorting the elements is ascending lexical.\n *\n * @id sort\n * @section Transforms\n * @name Stream.sort()\n * @api public\n *\n * var sorted = _(['b', 'z', 'g', 'r']).sort().toArray(_.log);\n * // => ['b', 'g', 'r', 'z']\n */\n\nStream.prototype.sort = function () {\n    return this.sortBy();\n};\nexposeMethod('sort');\n\n\n/**\n * Transforms a stream using an arbitrary target transform.\n *\n * If `target` is a function, this transform passes the current Stream to it,\n * returning the result.\n *\n * If `target` is a [Duplex\n * Stream](https://nodejs.org/api/stream.html#stream_class_stream_duplex_1),\n * this transform pipes the current Stream through it. It will always return a\n * Highland Stream (instead of the piped to target directly as in\n * [pipe](#pipe)). Any errors emitted will be propagated as Highland errors.\n *\n * **TIP**: Passing a function to `through` is a good way to implement complex\n * reusable stream transforms. You can even construct the function dynamically\n * based on certain inputs. See examples below.\n *\n * @id through\n * @section Higher-order Streams\n * @name Stream.through(target)\n * @param {Function | Duplex Stream} target - the stream to pipe through or a\n * function to call.\n * @api public\n *\n * // This is a static complex transform.\n * function oddDoubler(s) {\n *     return s.filter(function (x) {\n *         return x % 2; // odd numbers only\n *     })\n *     .map(function (x) {\n *         return x * 2;\n *     });\n * }\n *\n * // This is a dynamically-created complex transform.\n * function multiplyEvens(factor) {\n *     return function (x) {\n *         return s.filter(function (x) {\n *             return x % 2 === 0;\n *         })\n *         .map(function (x) {\n *             return x * factor;\n *         });\n *     };\n * }\n *\n * _([1, 2, 3, 4]).through(oddDoubler); // => 2, 6\n *\n * _([1, 2, 3, 4]).through(multiplyEvens(5)); // => 10, 20\n *\n * // Can also be used with Node Through Streams\n * _(filenames).through(jsonParser).map(function (obj) {\n *     // ...\n * });\n *\n * // All errors will be propagated as Highland errors\n * _(['zz{\"a\": 1}']).through(jsonParser).errors(function (err) {\n *   console.log(err); // => SyntaxError: Unexpected token z\n * });\n */\n\nStream.prototype.through = function (target) {\n    var output;\n\n    if (_.isFunction(target)) {\n        return target(this);\n    }\n    else {\n        target.pause();\n        output = _();\n        this.on('error', writeErr);\n        target.on('error', writeErr);\n        return this.pipe(target).pipe(output);\n    }\n\n    function writeErr(err) {\n        output.write(new StreamError(err));\n    }\n};\nexposeMethod('through');\n\n/**\n * Creates a 'Through Stream', which passes data through a pipeline\n * of functions or other through Streams. This is particularly useful\n * when combined with partial application of Highland functions to expose a\n * Node-compatible Through Stream.\n *\n * This is not a method on a Stream, and it only exposed at the top-level\n * as `_.pipeline`. It takes an arbitrary number of arguments.\n *\n * @id pipeline\n * @section Higher-order Streams\n * @name _.pipeline(...)\n * @api public\n *\n * var through = _.pipeline(\n *     _.map(parseJSON),\n *     _.filter(isBlogpost),\n *     _.reduce(collectCategories)\n *     _.through(otherPipeline)\n * );\n *\n * readStream.pipe(through).pipe(outStream);\n *\n * // Alternatively, you can use pipeline to manipulate a stream in\n * // the chained method call style:\n *\n * var through2 = _.pipeline(function (s) {\n *     return s.map(parseJSON).filter(isBlogpost); // etc.\n * });\n */\n\n_.pipeline = function (/*through...*/) {\n    if (!arguments.length) {\n        return _();\n    }\n    var start = arguments[0], rest, startHighland;\n    if (!_.isStream(start) && !_.isFunction(start.resume)) {\n        // not a Highland stream or Node stream, start with empty stream\n        start = _();\n        startHighland = start;\n        rest = slice.call(arguments);\n    }\n    else {\n        // got a stream as first argument, co-erce to Highland stream\n        startHighland = _(start);\n        rest = slice.call(arguments, 1);\n    }\n\n    var end = rest.reduce(function (src, dest) {\n        return src.through(dest);\n    }, startHighland);\n\n    var wrapper = _(function (push, next) {\n        end.pull(function (err, x) {\n            push(err, x);\n            if (x !== nil) {\n                next();\n            }\n        });\n    });\n\n    wrapper.write = function (x) {\n        return start.write(x);\n    };\n\n    wrapper.end = function () {\n        return start.end();\n    };\n\n    start.on('drain', function () {\n        wrapper.emit('drain');\n    });\n\n    return wrapper;\n};\n\n/**\n * Reads values from a Stream of Streams or Arrays, emitting them on a single\n * output Stream. This can be thought of as a [flatten](#flatten), just one\n * level deep, often used for resolving asynchronous actions such as a HTTP\n * request or reading a file.\n *\n * @id sequence\n * @section Higher-order Streams\n * @name Stream.sequence()\n * @api public\n *\n * var nums = _([\n *     _([1, 2, 3]),\n *     _([4, 5, 6])\n * ]);\n *\n * nums.sequence()  // => 1, 2, 3, 4, 5, 6\n *\n * // using sequence to read from files in series\n * var readFile = _.wrapCallback(fs.readFile);\n * filenames.map(readFile).sequence()\n */\n\nStream.prototype.sequence = function () {\n    var original = this;\n    var curr = this;\n    return _(function (push, next) {\n        curr.pull(function (err, x) {\n            if (err) {\n                push(err);\n                next();\n            }\n            else if (_.isArray(x)) {\n                if (onOriginalStream()) {\n                    // just send all values from array directly\n                    x.forEach(function (y) {\n                        push(null, y);\n                    });\n                }\n                else {\n                    push(null, x);\n                }\n                next();\n            }\n            else if (_.isStream(x)) {\n                if (onOriginalStream()) {\n                    // switch to reading new stream\n                    curr = x;\n                    next();\n                }\n                else {\n                    // sequence only goes 1 level deep\n                    push(null, x);\n                    next();\n                }\n            }\n            else if (x === nil) {\n                if (onOriginalStream()) {\n                    push(null, nil);\n                }\n                else {\n                    // resume reading from original\n                    curr = original;\n                    next();\n                }\n            }\n            else {\n                if (onOriginalStream()) {\n                    // we shouldn't be getting non-stream (or array)\n                    // values from the top-level stream\n                    push(new Error(\n                        'Expected Stream, got ' + (typeof x)\n                    ));\n                    next();\n                }\n                else {\n                    push(null, x);\n                    next();\n                }\n            }\n        });\n    });\n\n    function onOriginalStream() {\n        return curr === original;\n    }\n};\nexposeMethod('sequence');\n\n/**\n * An alias for the [sequence](#sequence) method.\n *\n * @id series\n * @section Higher-order Streams\n * @name Stream.series()\n * @api public\n *\n * var readFile = _.wrapCallback(fs.readFile);\n * filenames.map(readFile).series()\n */\n\nStream.prototype.series = Stream.prototype.sequence;\n_.series = _.sequence;\n\n/**\n * Recursively reads values from a Stream which may contain nested Streams\n * or Arrays. As values or errors are encountered, they are emitted on a\n * single output Stream.\n *\n * @id flatten\n * @section Higher-order Streams\n * @name Stream.flatten()\n * @api public\n *\n * _([1, [2, 3], [[4]]]).flatten();  // => 1, 2, 3, 4\n *\n * var nums = _(\n *     _([1, 2, 3]),\n *     _([4, _([5, 6]) ])\n * );\n *\n * nums.flatten();  // => 1, 2, 3, 4, 5, 6\n */\n\nStream.prototype.flatten = function () {\n    var curr = this;\n    var stack = [];\n    return _(function (push, next) {\n        curr.pull(function (err, x) {\n            if (err) {\n                push(err);\n                next();\n                return;\n            }\n            if (_.isArray(x)) {\n                x = _(x);\n            }\n            if (_.isStream(x)) {\n                stack.push(curr);\n                curr = x;\n                next();\n            }\n            else if (x === nil) {\n                if (stack.length) {\n                    curr = stack.pop();\n                    next();\n                }\n                else {\n                    push(null, nil);\n                }\n            }\n            else {\n                push(null, x);\n                next();\n            }\n        });\n    });\n};\nexposeMethod('flatten');\n\n/**\n * Takes a Stream of Streams and reads from them in parallel, buffering\n * the results until they can be returned to the consumer in their original\n * order.\n *\n * @id parallel\n * @section Higher-order Streams\n * @name Stream.parallel(n)\n * @param {Number} n - the maximum number of concurrent reads/buffers\n * @api public\n *\n * var readFile = _.wrapCallback(fs.readFile);\n * var filenames = _(['foo.txt', 'bar.txt', 'baz.txt']);\n *\n * // read from up to 10 files at once\n * filenames.map(readFile).parallel(10);\n */\n\nStream.prototype.parallel = function (n) {\n    var source = this;\n    var running = [];\n    var ended = false;\n    var reading_source = false;\n\n    if (typeof n !== 'number') {\n        throw new Error('Must specify a number to parallel().');\n    }\n\n    if (n <= 0) {\n        throw new Error('The parallelism factor must be positive');\n    }\n\n    return _(function (push, next) {\n        if (running.length < n && !ended && !reading_source) {\n            // get another stream if not already waiting for one\n            reading_source = true;\n            source.pull(function (err, x) {\n                reading_source = false;\n                if (err) {\n                    push(err);\n                }\n                else if (x === nil) {\n                    ended = true;\n                }\n                else if (!_.isStream(x)) {\n                    push(new Error('Expected Stream, got ' + (typeof x)));\n                }\n                else {\n                    // got a new source, add it to the running array\n                    var run = {stream: x, buffer: []};\n                    running.push(run);\n                    x.consume(function (_err, y, _push, _next) {\n                        if (running[0] === run) {\n                            // current output stream\n                            if (y === nil) {\n                                // remove self from running and check\n                                // to see if we need to read from source again\n                                running.shift();\n                                flushBuffer();\n                                next();\n\n                            }\n                            else {\n                                // push directly onto parallel output stream\n                                push(_err, y);\n                            }\n                        }\n                        else {\n                            // we're reading ahead, buffer the output\n                            run.buffer.push([_err, y]);\n                        }\n                        if (y !== nil) {\n                            // keep reading until we hit nil\n                            _next();\n                        }\n                    }).resume();\n                }\n                // check if we need to get any more streams\n                return next();\n            });\n        }\n        else if (!running.length && ended) {\n            // nothing more to do\n            push(null, nil);\n        }\n\n        function flushBuffer() {\n            while (running.length && running[0].buffer.length) {\n                var buf = running[0].buffer;\n                for (var i = 0; i < buf.length; i++) {\n                    if (buf[i][1] === nil) {\n                        // this stream has ended\n                        running.shift();\n                        break;\n                    }\n                    else {\n                        // send the buffered output\n                        push.apply(null, buf[i]);\n                    }\n                }\n                buf.length = 0;\n            }\n        }\n        // else wait for more data to arrive from running streams\n    });\n};\nexposeMethod('parallel');\n\n/**\n * Switches source to an alternate Stream if the current Stream is empty.\n *\n * @id otherwise\n * @section Higher-order Streams\n * @name Stream.otherwise(ys)\n * @param {Stream | Function} ys - alternate stream (or stream-returning function) to use if this stream is empty\n * @api public\n *\n * _([1,2,3]).otherwise(['foo'])  // => 1, 2, 3\n * _([]).otherwise(['foo'])       // => 'foo'\n *\n * _.otherwise(_(['foo']), _([1,2,3]))    // => 1, 2, 3\n * _.otherwise(_(['foo']), _([]))         // => 'foo'\n */\n\nStream.prototype.otherwise = function (ys) {\n    var xs = this;\n    return xs.consume(function (err, x, push, next) {\n        if (err) {\n            // got an error, just keep going\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            // hit the end without redirecting to xs, use alternative\n            if (_.isFunction(ys)) {\n                next(ys());\n            }\n            else {\n                next(ys);\n            }\n        }\n        else {\n            // got a value, push it, then redirect to xs\n            push(null, x);\n            next(xs);\n        }\n    });\n};\nexposeMethod('otherwise');\n\n/**\n * Adds a value to the end of a Stream.\n *\n * @id append\n * @section Transforms\n * @name Stream.append(y)\n * @param y - the value to append to the Stream\n * @api public\n *\n * _([1, 2, 3]).append(4)  // => 1, 2, 3, 4\n */\n\nStream.prototype.append = function (y) {\n    return this.consume(function (err, x, push, next) {\n        if (x === nil) {\n            push(null, y);\n            push(null, _.nil);\n        }\n        else {\n            push(err, x);\n            next();\n        }\n    });\n};\nexposeMethod('append');\n\n/**\n * Boils down a Stream to a single value. The memo is the initial state\n * of the reduction, and each successive step of it should be returned by\n * the iterator function. The iterator is passed two arguments:\n * the memo and the next value.\n *\n * If the iterator throws an error, the reduction stops and the resulting\n * stream will emit that error instead of a value.\n *\n * *Note:* The order of the `memo` and `iterator` arguments will be flipped in\n * the next major version release.\n *\n * @id reduce\n * @section Transforms\n * @name Stream.reduce(memo, iterator)\n * @param memo - the initial state of the reduction\n * @param {Function} iterator - the function which reduces the values\n * @api public\n *\n * var add = function (a, b) {\n *     return a + b;\n * };\n *\n * _([1, 2, 3, 4]).reduce(0, add)  // => 10\n */\n\nStream.prototype.reduce = function (z, f) {\n    // This can't be implemented with scan(), because we don't know if the\n    // errors that we see from the scan were thrown by the iterator or just\n    // passed through from the source stream.\n    return this.consume(function (err, x, push, next) {\n        if (x === nil) {\n            push(null, z);\n            push(null, _.nil);\n        }\n        else if (err) {\n            push(err);\n            next();\n        }\n        else {\n            try {\n                z = f(z, x);\n            }\n            catch (e) {\n                push(e);\n                push(null, _.nil);\n                return;\n            }\n\n            next();\n        }\n    });\n};\nexposeMethod('reduce');\n\n/**\n * Same as [reduce](#reduce), but uses the first element as the initial\n * state instead of passing in a `memo` value.\n *\n * @id reduce1\n * @section Transforms\n * @name Stream.reduce1(iterator)\n * @param {Function} iterator - the function which reduces the values\n * @api public\n *\n * _([1, 2, 3, 4]).reduce1(add)  // => 10\n */\n\nStream.prototype.reduce1 = function (f) {\n    var self = this;\n    return _(function (push, next) {\n        self.pull(function (err, x) {\n            if (err) {\n                push(err);\n                next();\n            }\n            else if (x === nil) {\n                push(null, nil);\n            }\n            else {\n                next(self.reduce(x, f));\n            }\n        });\n    });\n};\nexposeMethod('reduce1');\n\n/**\n * Groups all values into an Array and passes down the stream as a single\n * data event. This is a bit like doing [toArray](#toArray), but instead\n * of accepting a callback and consuming the stream, it passes the value on.\n *\n * @id collect\n * @section Transforms\n * @name Stream.collect()\n * @api public\n *\n * _(['foo', 'bar']).collect().toArray(function (xs) {\n *     // xs will be [['foo', 'bar']]\n * });\n */\n\nStream.prototype.collect = function () {\n    var xs = [];\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(null, xs);\n            push(null, nil);\n        }\n        else {\n            xs.push(x);\n            next();\n        }\n    });\n};\nexposeMethod('collect');\n\n/**\n * Like [reduce](#reduce), but emits each intermediate value of the\n * reduction as it is calculated.\n *\n * If the iterator throws an error, the scan will stop and the stream will\n * emit that error. Any intermediate values that were produced before the\n * error will still be emitted.\n *\n * *Note:* The order of the `memo` and `iterator` arguments will be flipped in\n * the next major version release.\n *\n * @id scan\n * @section Transforms\n * @name Stream.scan(memo, iterator)\n * @param memo - the initial state of the reduction\n * @param {Function} iterator - the function which reduces the values\n * @api public\n *\n * _([1, 2, 3, 4]).scan(0, add)  // => 0, 1, 3, 6, 10\n */\n\nStream.prototype.scan = function (z, f) {\n    var self = this;\n    return _([z]).concat(\n        self.consume(function (err, x, push, next) {\n            if (x === nil) {\n                push(null, _.nil);\n            }\n            else if (err) {\n                push(err);\n                next();\n            }\n            else {\n                try {\n                    z = f(z, x);\n                }\n                catch (e) {\n                    push(e);\n                    push(null, _.nil);\n                    return;\n                }\n\n                push(null, z);\n                next();\n            }\n        })\n    );\n};\nexposeMethod('scan');\n\n/**\n * Same as [scan](#scan), but uses the first element as the initial\n * state instead of passing in a `memo` value.\n *\n * @id scan1\n * @section Transforms\n * @name Stream.scan1(iterator)\n * @param {Function} iterator - the function which reduces the values\n * @api public\n *\n * _([1, 2, 3, 4]).scan1(add)  // => 1, 3, 6, 10\n */\n\nStream.prototype.scan1 = function (f) {\n    var self = this;\n    return _(function (push, next) {\n        self.pull(function (err, x) {\n            if (err) {\n                push(err);\n                next();\n            }\n            else if (x === nil) {\n                push(null, nil);\n            }\n            else {\n                next(self.scan(x, f));\n            }\n        });\n    });\n};\nexposeMethod('scan1');\n\nfunction HighlandTransform(push) {\n    this.push = push;\n}\n\nHighlandTransform.prototype['@@transducer/init'] = function () {\n    return this.push;\n};\n\nHighlandTransform.prototype['@@transducer/result'] = function (push) {\n    // Don't push nil here. Otherwise, we can't catch errors from `result`\n    // and propagate them. The `transduce` implementation will do it.\n    return push;\n};\n\nHighlandTransform.prototype['@@transducer/step'] = function (push, input) {\n    push(null, input);\n    return push;\n};\n\n/**\n * Applies the transformation defined by the the given *transducer* to the\n * stream. A transducer is any function that follows the\n * [Transducer Protocol](https://github.com/cognitect-labs/transducers-js#transformer-protocol).\n * See\n * [transduce-js](https://github.com/cognitect-labs/transducers-js#transducers-js)\n * for more details on what transducers actually are.\n *\n * The `result` object that is passed in through the\n * [Transformer Protocol](https://github.com/cognitect-labs/transducers-js#transformer-protocol)\n * will be the `push` function provided by the [consume](#consume) transform.\n *\n * Like [scan](#scan), if the transducer throws an exception, the transform\n * will stop and emit that error. Any intermediate values that were produced\n * before the error will still be emitted.\n *\n * @id transduce\n * @section Transforms\n * @name Stream.transduce(xf)\n * @param {Function} xf - The transducer.\n * @api public\n *\n * var xf = require('transducer-js').map(_.add(1));\n * _([1, 2, 3, 4]).transduce(xf);\n * // => 2, 3, 4, 5\n */\n\nStream.prototype.transduce = function transduce(xf) {\n    var transform = null,\n        memo = null;\n\n    return this.consume(function (err, x, push, next) {\n        if (transform == null) {\n            transform = xf(new HighlandTransform(push));\n            memo = transform['@@transducer/init']();\n        }\n\n        if (err) {\n            // Pass through errors, like we always do.\n            push(err);\n            next();\n        }\n        else if (x === _.nil) {\n            // Push may be different from memo depending on the transducer that\n            // we get.\n            runResult(push, memo);\n        }\n        else {\n            var res = runStep(push, memo, x);\n\n            if (!res) {\n                return;\n            }\n\n            memo = res;\n            if (memo['@@transducer/reduced']) {\n                runResult(memo['@@transducer/value']);\n            }\n            else {\n                next();\n            }\n        }\n    });\n\n    function runResult(push, _memo) {\n        try {\n            transform['@@transducer/result'](_memo);\n        }\n        catch (e) {\n            push(e);\n        }\n        push(null, _.nil);\n    }\n\n    function runStep(push, _memo, x) {\n        try {\n            return transform['@@transducer/step'](_memo, x);\n        }\n        catch (e) {\n            push(e);\n            push(null, _.nil);\n            return null;\n        }\n    }\n};\nexposeMethod('transduce');\n\n/**\n * Concatenates a Stream to the end of this Stream.\n *\n * Be aware that in the top-level export, the args may be in the reverse\n * order to what you'd expect `_([a], [b]) => b, a`, as this follows the\n * convention of other top-level exported functions which do `x` to `y`.\n *\n * @id concat\n * @section Higher-order Streams\n * @name Stream.concat(ys)\n * @param {Stream | Array} ys - the values to concatenate onto this Stream\n * @api public\n *\n * _([1, 2]).concat([3, 4])  // => 1, 2, 3, 4\n * _.concat([3, 4], [1, 2])  // => 1, 2, 3, 4\n */\n\nStream.prototype.concat = function (ys) {\n    ys = _(ys);\n    return this.consume(function (err, x, push, next) {\n        if (x === nil) {\n            next(ys);\n        }\n        else {\n            push(err, x);\n            next();\n        }\n    });\n};\nexposeMethod('concat');\n\n/**\n * Takes a Stream of Streams and merges their values and errors into a\n * single new Stream. The merged stream ends when all source streams have\n * ended.\n *\n * Note that no guarantee is made with respect to the order in which\n * values for each stream end up in the merged stream. Values in the\n * merged stream will, however, respect the order they were emitted from\n * their respective streams.\n *\n * @id merge\n * @section Higher-order Streams\n * @name Stream.merge()\n * @api public\n *\n * var readFile = _.wrapCallback(fs.readFile);\n *\n * var txt = _(['foo.txt', 'bar.txt']).map(readFile)\n * var md = _(['baz.md']).map(readFile)\n *\n * _([txt, md]).merge();\n * // => contents of foo.txt, bar.txt and baz.txt in the order they were read\n */\n\nStream.prototype.merge = function () {\n    var self = this;\n    var srcs = [];\n\n    var srcsNeedPull = [],\n        first = true,\n        async = false;\n\n    return _(function (push, next) {\n        if (first) {\n            first = false;\n            getSourcesSync(push, next);\n        }\n\n        if (srcs.length === 0) {\n            push(null, nil);\n        }\n        else if (srcsNeedPull.length) {\n            pullFromAllSources(push, next);\n            next();\n        }\n        else {\n            async = true;\n        }\n    });\n\n    // Make a handler for the main merge loop.\n    function srcPullHandler(push, next, src) {\n        return function (err, x) {\n            if (err) {\n                push(err);\n                srcsNeedPull.push(src);\n            }\n            else if (x === nil) {\n                srcs = srcs.filter(function (s) {\n                    return s !== src;\n                });\n            }\n            else {\n                if (src === self) {\n                    srcs.push(x);\n                    srcsNeedPull.push(x);\n                    srcsNeedPull.unshift(self);\n                }\n                else {\n                    push(null, x);\n                    srcsNeedPull.push(src);\n                }\n            }\n\n            if (async) {\n                async = false;\n                next();\n            }\n        };\n    }\n\n\n    function pullFromAllSources(push, next) {\n        var _srcs = srcsNeedPull;\n        srcsNeedPull = [];\n        _srcs.forEach(function (src) {\n            src.pull(srcPullHandler(push, next, src));\n        });\n    }\n\n    // Pulls as many sources as possible from self synchronously.\n    function getSourcesSync(push, next) {\n        // Shadows the outer async variable.\n        var asynchronous;\n        var done = false;\n\n        var pull_cb = function(err, x) {\n            asynchronous = false;\n            if (done) {\n                // This means the pull was async. Handle like\n                // regular async.\n                srcPullHandler(push, next, self)(err, x);\n            }\n            else {\n                if (err) {\n                    push(err);\n                }\n                else if (x === nil) {\n                    done = true;\n                }\n                else {\n                    srcs.push(x);\n                    srcsNeedPull.push(x);\n                }\n            }\n        };\n\n        while (!done) {\n            asynchronous = true;\n            self.pull(pull_cb);\n\n            // Async behavior, record self as a src and return.\n            if (asynchronous) {\n                done = true;\n                srcs.unshift(self);\n            }\n        }\n    }\n\n};\nexposeMethod('merge');\n\n/**\n * Takes a Stream of Streams and merges their values and errors into a\n * single new Stream, limitting the number of unpaused streams that can\n * running at any one time.\n *\n * Note that no guarantee is made with respect to the order in which\n * values for each stream end up in the merged stream. Values in the\n * merged stream will, however, respect the order they were emitted from\n * their respective streams.\n *\n * @id mergeWithLimit\n * @section Higher-order Streams\n * @name Stream.mergeWithLimit(n)\n * @param {Number} n - the maximum number of streams to run in parallel\n * @api public\n *\n * var readFile = _.wrapCallback(fs.readFile);\n *\n * var txt = _(['foo.txt', 'bar.txt']).flatMap(readFile)\n * var md = _(['baz.md']).flatMap(readFile)\n * var js = _(['bosh.js']).flatMap(readFile)\n *\n * _([txt, md, js]).mergeWithLimit(2);\n * // => contents of foo.txt, bar.txt, baz.txt and bosh.js in the order\n * // they were read, but bosh.js is not read until either foo.txt and bar.txt\n * // has completely been read or baz.md has been read\n */\n\n\nStream.prototype.mergeWithLimit = function (n){\n    var self = this;\n    var processCount = 0;\n    var waiting = false;\n    if (typeof n !== 'number' || n < 1) {\n        throw new Error('mergeWithLimit expects a positive number, but got: ' + n);\n    }\n\n    if (n === Infinity) {\n        return this.merge();\n    }\n    return _(function(push, next){\n        self.pull(function(err, x){\n            var done = x === nil;\n            if (err){\n                push(err);\n                next();\n            }\n            else if (x === nil) {\n                push(null, nil);\n            }\n            else {\n                processCount++;\n                push(err, x);\n                // console.log('start', x.id);\n                x._destructors.push(function(){\n                    processCount--;\n                    // console.log('end', x.id);\n                    if (waiting) {\n                        // console.log('get more');\n                        waiting = false;\n                        next();\n                    }\n                });\n                if (!done && processCount < n) {\n                    next();\n                }\n                else {\n                    // console.log('wait till something ends');\n                    waiting = true;\n                }\n            }\n\n        });\n    }).merge();\n};\nexposeMethod('mergeWithLimit');\n\n/**\n * Calls a named method on each object from the Stream - returning\n * a new stream with the result of those calls.\n *\n * @id invoke\n * @section Transforms\n * @name Stream.invoke(method, args)\n * @param {String} method - the method name to call\n * @param {Array} args - the arguments to call the method with\n * @api public\n *\n * _(['foo', 'bar']).invoke('toUpperCase', [])  // => 'FOO', 'BAR'\n *\n * var readFile = _.wrapCallback(fs.readFile);\n * filenames.flatMap(readFile).invoke('toString', ['utf8']);\n */\n\nStream.prototype.invoke = function (method, args) {\n    return this.map(function (x) {\n        return x[method].apply(x, args);\n    });\n};\nexposeMethod('invoke');\n\n/**\n * Takes a Stream of callback-accepting node-style functions,\n * [wraps](#wrapCallback) each one into a stream-returning function,\n * calls them with the arguments provided, and returns the results\n * as a Stream.\n *\n * This can be used as a control flow shortcut and draws parallels\n * with some control flow functions from [async](https://github.com/caolan/async).\n * A few rough correspondences include:\n *\n * - `.nfcall([]).series()` to `async.series()`\n * - `.nfcall([]).parallel(n)` to `async.parallelLimit(n)`\n * - `.nfcall(args)` to `async.applyEach(..., args)`\n * - `.nfcall(args).series()` to `async.applyEachSeries(..., args)`\n *\n * @id nfcall\n * @section Transforms\n * @name Stream.nfcall(args)\n * @param {Array} args - the arguments to call each function with\n * @api public\n *\n * _([\n *   function (callback) {\n *     setTimeout(function () {\n *       callback(null, 'one');\n *     }, 200);\n *   },\n *   function (callback) {\n *     setTimeout(function () {\n *       callback(null, 'two');\n *     }, 100);\n *   }\n * ]).nfcall([]).parallel(2).toArray(function (xs) {\n *   // xs is ['one', 'two'] even though second function had a shorter timeout\n * });\n *\n * _([enableSearch, updateSchema]).nfcall(['bucket']).toArray(callback);\n * // does roughly the same as\n * async.applyEach([enableSearch, updateSchema], 'bucket', callback);\n *\n * _([\n *   fs.appendFile,\n *   fs.appendFile\n * ]).nfcall(['example.txt', 'hello']).series().toArray(function() {\n *   // example.txt now contains 'hellohello'\n * });\n *\n */\n\nStream.prototype.nfcall = function (args) {\n    return this.map(function (x) {\n        return _.wrapCallback(x).apply(x, args);\n    });\n};\nexposeMethod('nfcall');\n\n/**\n * Ensures that only one data event is push downstream (or into the buffer)\n * every `ms` milliseconds, any other values are dropped.\n *\n * @id throttle\n * @section Transforms\n * @name Stream.throttle(ms)\n * @param {Number} ms - the minimum milliseconds between each value\n * @api public\n *\n * _('mousemove', document).throttle(1000);\n */\n\nStream.prototype.throttle = function (ms) {\n    var last = 0 - ms;\n    return this.consume(function (err, x, push, next) {\n        var now = new Date().getTime();\n        if (err) {\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            push(null, nil);\n        }\n        else if (now - ms >= last) {\n            last = now;\n            push(null, x);\n            next();\n        }\n        else {\n            next();\n        }\n    });\n};\nexposeMethod('throttle');\n\n/**\n * Holds off pushing data events downstream until there has been no more\n * data for `ms` milliseconds. Sends the last value that occurred before\n * the delay, discarding all other values.\n *\n * **Implementation Note**: This transform will will not wait the full `ms`\n * delay to emit a pending value (if any) once it see a `nil`, as that\n * guarantees that there will be no more values.\n *\n * @id debounce\n * @section Transforms\n * @name Stream.debounce(ms)\n * @param {Number} ms - the milliseconds to wait before sending data\n * @api public\n *\n * function delay(x, ms, push) {\n *     setTimeout(function () {\n *         push(null, x);\n *     }, ms);\n * }\n *\n * // sends last keyup event after user has stopped typing for 1 second\n * $('keyup', textbox).debounce(1000);\n *\n * // A nil triggers the emit immediately\n * _(function (push, next) {\n *     delay(0, 100, push);\n *     delay(1, 200, push);\n *     delay(_.nil, 250, push);\n * }).debounce(75);\n * // => after 175ms => 1\n * // => after 250ms (not 275ms!) => 1 2\n */\n\nStream.prototype.debounce = function (ms) {\n    var t = null;\n    var nothing = {};\n    var last = nothing;\n\n    return this.consume(function (err, x, push, next) {\n        if (err) {\n            // let errors through regardless\n            push(err);\n            next();\n        }\n        else if (x === nil) {\n            if (t) {\n                clearTimeout(t);\n            }\n            if (last !== nothing) {\n                push(null, last);\n            }\n            push(null, nil);\n        }\n        else {\n            last = x;\n            if (t) {\n                clearTimeout(t);\n            }\n            t = setTimeout(push.bind(this, null, x), ms);\n            next();\n        }\n    });\n};\nexposeMethod('debounce');\n\n/**\n * Creates a new Stream, which when read from, only returns the last\n * seen value from the source. The source stream does not experience\n * back-pressure. Useful if you're using a Stream to model a changing\n * property which you need to query periodically.\n *\n * @id latest\n * @section Transforms\n * @name Stream.latest()\n * @api public\n *\n * // slowThing will always get the last known mouse position\n * // when it asks for more data from the mousePosition stream\n * mousePosition.latest().map(slowThing)\n */\n\nStream.prototype.latest = function () {\n    var nothing = {},\n        latest = nothing,\n        errors = [],\n        ended = false,\n        onValue = null;\n\n    this.consume(function (err, x, push, next) {\n        if (onValue != null) {\n            var cb = onValue;\n            onValue = null;\n            cb(err, x);\n        }\n\n        if (err) {\n            errors.push(err);\n            next();\n        }\n        else if (x === nil) {\n            ended = true;\n        }\n        else {\n            latest = x;\n            next();\n        }\n    }).resume();\n\n    return _(function (push, next) {\n        var oldErrors = errors;\n        errors = [];\n\n        if (!oldErrors.length && latest === nothing && !ended) {\n            // We haven't gotten any data yet. We can't call next\n            // because that might cause the stream to call the generator\n            // again, resulting in an infinite loop. Thus, we stick a\n            // a callback to be called whenever we get a value.\n            onValue = function (err, x) {\n                push(err, x);\n                if (x !== nil) {\n                    next();\n                }\n            };\n        }\n        else {\n            oldErrors.forEach(push);\n            if (latest !== nothing) {\n                push(null, latest);\n            }\n            if (ended) {\n                push(null, nil);\n            }\n            else {\n                next();\n            }\n        }\n    });\n};\nexposeMethod('latest');\n\n/**\n * Returns values from an Object as a Stream. Reads properties\n * lazily, so if you don't read from all keys on an object, not\n * all properties will be read from (may have an effect where getters\n * are used).\n *\n * @id values\n * @section Objects\n * @name _.values(obj)\n * @param {Object} obj - the object to return values from\n * @api public\n *\n * _.values({foo: 1, bar: 2, baz: 3})  // => 1, 2, 3\n */\n\n_.values = function (obj) {\n    return _.keys(obj).map(function (k) {\n        return obj[k];\n    });\n};\n\n/**\n * Returns keys from an Object as a Stream.\n *\n * @id keys\n * @section Objects\n * @name _.keys(obj)\n * @param {Object} obj - the object to return keys from\n * @api public\n *\n * _.keys({foo: 1, bar: 2, baz: 3})  // => 'foo', 'bar', 'baz'\n */\n\nfunction keys (obj) {\n    var keysArray = [];\n    for (var k in obj) {\n        if (hasOwn.call(obj, k)) {\n            keysArray.push(k);\n        }\n    }\n    return keysArray;\n}\n\n_.keys = function (obj) {\n    return _(keys(obj));\n};\n\n/**\n * Returns key/value pairs for an Object as a Stream. Reads properties\n * lazily, so if you don't read from all keys on an object, not\n * all properties will be read from (may have an effect where getters\n * are used).\n *\n * @id pairs\n * @section Objects\n * @name _.pairs(obj)\n * @param {Object} obj - the object to return key/value pairs from\n * @api public\n *\n * _.pairs({foo: 1, bar: 2})  // => ['foo', 1], ['bar', 2]\n */\n\n_.pairs = function (obj) {\n    return _.keys(obj).map(function (k) {\n        return [k, obj[k]];\n    });\n};\n\n/**\n * Extends one object with the properties of another. **Note:** The\n * arguments are in the reverse order of other libraries such as\n * underscore. This is so it follows the convention of other functions in\n * this library and so you can more meaningfully partially apply it.\n *\n * @id extend\n * @section Objects\n * @name _.extend(a, b)\n * @param {Object} a - the properties to extend b with\n * @param {Object} b - the original object to extend\n * @api public\n *\n * _.extend({name: 'bar'}, {name: 'foo', price: 20})\n * // => {name: 'bar', price: 20}\n *\n * // example of partial application\n * var publish = _.extend({published: true});\n *\n * publish({title: 'test post'})\n * // => {title: 'test post', published: true}\n */\n\n_.extend = _.curry(function (extensions, target) {\n    for (var k in extensions) {\n        if (hasOwn.call(extensions, k)) {\n            target[k] = extensions[k];\n        }\n    }\n    return target;\n});\n\n/**\n * Returns a property from an object.\n *\n * @id get\n * @section Objects\n * @name _.get(prop, obj)\n * @param {String} prop - the property to return\n * @param {Object} obj - the object to read properties from\n * @api public\n *\n * var obj = {foo: 'bar', baz: 123};\n * _.get('foo', obj) // => 'bar'\n *\n * // making use of partial application\n * var posts = [\n *   {title: 'one'},\n *   {title: 'two'},\n *   {title: 'three'}\n * ];\n *\n * _(posts).map(_.get('title'))  // => 'one', 'two', 'three'\n */\n\n_.get = _.curry(function (prop, obj) {\n    return obj[prop];\n});\n\n/**\n * Updates a property on an object, returning the updated object.\n *\n * @id set\n * @section Objects\n * @name _.set(prop, value, obj)\n * @param {String} prop - the property to return\n * @param value - the value to set the property to\n * @param {Object} obj - the object to set properties on\n * @api public\n *\n * var obj = {foo: 'bar', baz: 123};\n * _.set('foo', 'wheeee', obj) // => {foo: 'wheeee', baz: 123}\n *\n * // making use of partial application\n * var publish = _.set('published', true);\n *\n * publish({title: 'example'})  // => {title: 'example', published: true}\n */\n\n_.set = _.curry(function (prop, val, obj) {\n    obj[prop] = val;\n    return obj;\n});\n\n/**\n * Logs values to the console, a simple wrapper around `console.log` that\n * it suitable for passing to other functions by reference without having to\n * call `bind`.\n *\n * @id log\n * @section Utils\n * @name _.log(args..)\n * @api public\n *\n * _.log('Hello, world!');\n *\n * _([1, 2, 3, 4]).each(_.log);\n */\n\n_.log = function () {\n    console.log.apply(console, arguments);\n};\n\n/**\n * Wraps a node-style async function which accepts a callback, transforming\n * it to a function which accepts the same arguments minus the callback and\n * returns a Highland Stream instead. The wrapped function keeps its context,\n * so you can safely use it as a method without binding (see the second\n * example below).\n *\n * `wrapCallback` also accepts an optional `mappingHint`, which specifies how\n * callback arguments are pushed to the stream. This can be used to handle\n * non-standard callback protocols that pass back more than one value.\n *\n * `mappingHint` can be a function, number, or array. See the documentation on\n * [EventEmitter Stream Objects](#Stream Objects) for details on the mapping\n * hint. If `mappingHint` is a function, it will be called with all but the\n * first argument that is passed to the callback. The first is still assumed to\n * be the error argument.\n *\n * @id wrapCallback\n * @section Utils\n * @name _.wrapCallback(f)\n * @param {Function} f - the node-style function to wrap\n * @param {Array | Function | Number} mappingHint - (optional) how to pass the\n * arguments to the callback\n * @api public\n *\n * var fs = require('fs');\n *\n * var readFile = _.wrapCallback(fs.readFile);\n *\n * readFile('example.txt').apply(function (data) {\n *     // data is now the contents of example.txt\n * });\n *\n * function Reader(file) {\n *     this.file = file;\n * }\n *\n * Reader.prototype.read = function(cb) {\n *     fs.readFile(this.file, cb);\n * };\n *\n * Reader.prototype.readStream = _.wrapCallback(Reader.prototype.read);\n */\n\n/*eslint-disable no-multi-spaces */\n_.wrapCallback = function (f, /*optional*/mappingHint) {\n    /*eslint-enable no-multi-spaces */\n    var mapper = hintMapper(mappingHint);\n\n    return function () {\n        var self = this;\n        var args = slice.call(arguments);\n        return _(function (push) {\n            var cb = function (err) {\n                if (err) {\n                    push(err);\n                }\n                else {\n                    var cbArgs = slice.call(arguments, 1);\n                    var v = mapper.apply(this, cbArgs);\n                    push(null, v);\n                }\n                push(null, nil);\n            };\n            f.apply(self, args.concat([cb]));\n        });\n    };\n};\n\n/**\n * Takes an object or a constructor function and returns that object or\n * constructor with streamified versions of its function properties.\n * Passed constructors will also have their prototype functions\n * streamified.  This is useful for wrapping many node style async\n * functions at once, and for preserving those functions' context.\n *\n * @id streamifyAll\n * @section Utils\n * @name _.streamifyAll(source)\n * @param {Object | Function} source - the function or object with\n * node-style function properties.\n * @api public\n *\n * var fs = _.streamifyAll(require('fs'));\n *\n * fs.readFileStream('example.txt').apply(function (data) {\n *     // data is now the contents of example.txt\n * });\n */\n\nfunction isClass (fn) {\n    if (!(typeof fn === 'function' && fn.prototype)) { return false; }\n    var getKeys = isES5 ? Object.getOwnPropertyNames : keys;\n    var allKeys = getKeys(fn.prototype);\n    return allKeys.length > 0 && !(allKeys.length === 1 &&\n            allKeys[0] === 'constructor');\n}\n\nfunction inheritedKeys (obj) {\n    var allProps = {};\n    var curr = obj;\n    var handleProp = function (prop) {\n        allProps[prop] = true;\n    };\n    while (Object.getPrototypeOf(curr)) {\n        var props = Object.getOwnPropertyNames(curr);\n        props.forEach(handleProp);\n        curr = Object.getPrototypeOf(curr);\n    }\n    return keys(allProps);\n}\n\nfunction streamifyAll (inp, suffix) {\n    // will not streamify inherited functions in ES3\n    var getKeys = isES5 ? inheritedKeys : keys;\n    var allKeys = getKeys(inp);\n\n    for (var i = 0, len = allKeys.length; i < len; i++) {\n        var key = allKeys[i];\n        var val;\n\n        // will skip context aware getters\n        try {\n            val = inp[key];\n        }\n        catch (e) {\n            // Ignore\n        }\n\n        if (val && typeof val === 'function' && !isClass(val) &&\n                !val.__HighlandStreamifiedFunction__) {\n\n            var streamified = _.wrapCallback(val);\n            streamified.__HighlandStreamifiedFunction__ = true;\n            inp[key + suffix] = streamified;\n        }\n    }\n    return inp;\n}\n\n_.streamifyAll = function (arg) {\n    if (typeof arg !== 'function' && typeof arg !== 'object') {\n        throw new TypeError('takes an object or a constructor function');\n    }\n    var suffix = 'Stream';\n\n    var ret = streamifyAll(arg, suffix);\n    if (isClass(arg)) {\n        ret.prototype = streamifyAll(arg.prototype, suffix);\n    }\n    return ret;\n};\n\n/**\n * Add two values. Can be partially applied.\n *\n * @id add\n * @section Operators\n * @name _.add(a, b)\n * @api public\n *\n * _.add(1, 2) === 3\n * _.add(1)(5) === 6\n */\n\n_.add = _.curry(function (a, b) {\n    return a + b;\n});\n\n/**\n * Perform logical negation on a value. If `x` is truthy then returns false,\n * otherwise returns true.\n *\n * @id not\n * @section Operators\n * @name _.not(x)\n * @param x - the value to negate\n * @api public\n *\n * _.not(true)   // => false\n * _.not(false)  // => true\n */\n\n_.not = function (x) {\n    return !x;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar intToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\n\n/**\n * Encode an integer in the range of 0 to 63 to a single base 64 digit.\n */\nexports.encode = function (number) {\n  if (0 <= number && number < intToCharMap.length) {\n    return intToCharMap[number];\n  }\n  throw new TypeError(\"Must be between 0 and 63: \" + number);\n};\n\n/**\n * Decode a single base 64 character code digit to an integer. Returns -1 on\n * failure.\n */\nexports.decode = function (charCode) {\n  var bigA = 65;     // 'A'\n  var bigZ = 90;     // 'Z'\n\n  var littleA = 97;  // 'a'\n  var littleZ = 122; // 'z'\n\n  var zero = 48;     // '0'\n  var nine = 57;     // '9'\n\n  var plus = 43;     // '+'\n  var slash = 47;    // '/'\n\n  var littleOffset = 26;\n  var numberOffset = 52;\n\n  // 0 - 25: ABCDEFGHIJKLMNOPQRSTUVWXYZ\n  if (bigA <= charCode && charCode <= bigZ) {\n    return (charCode - bigA);\n  }\n\n  // 26 - 51: abcdefghijklmnopqrstuvwxyz\n  if (littleA <= charCode && charCode <= littleZ) {\n    return (charCode - littleA + littleOffset);\n  }\n\n  // 52 - 61: 0123456789\n  if (zero <= charCode && charCode <= nine) {\n    return (charCode - zero + numberOffset);\n  }\n\n  // 62: +\n  if (charCode == plus) {\n    return 62;\n  }\n\n  // 63: /\n  if (charCode == slash) {\n    return 63;\n  }\n\n  // Invalid base64 digit.\n  return -1;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n *\n * Based on the Base 64 VLQ implementation in Closure Compiler:\n * https://code.google.com/p/closure-compiler/source/browse/trunk/src/com/google/debugging/sourcemap/Base64VLQ.java\n *\n * Copyright 2011 The Closure Compiler Authors. All rights reserved.\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above\n *    copyright notice, this list of conditions and the following\n *    disclaimer in the documentation and/or other materials provided\n *    with the distribution.\n *  * Neither the name of Google Inc. nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar base64 = require('./base64');\n\n// A single base 64 digit can contain 6 bits of data. For the base 64 variable\n// length quantities we use in the source map spec, the first bit is the sign,\n// the next four bits are the actual value, and the 6th bit is the\n// continuation bit. The continuation bit tells us whether there are more\n// digits in this value following this digit.\n//\n//   Continuation\n//   |    Sign\n//   |    |\n//   V    V\n//   101011\n\nvar VLQ_BASE_SHIFT = 5;\n\n// binary: 100000\nvar VLQ_BASE = 1 << VLQ_BASE_SHIFT;\n\n// binary: 011111\nvar VLQ_BASE_MASK = VLQ_BASE - 1;\n\n// binary: 100000\nvar VLQ_CONTINUATION_BIT = VLQ_BASE;\n\n/**\n * Converts from a two-complement value to a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   1 becomes 2 (10 binary), -1 becomes 3 (11 binary)\n *   2 becomes 4 (100 binary), -2 becomes 5 (101 binary)\n */\nfunction toVLQSigned(aValue) {\n  return aValue < 0\n    ? ((-aValue) << 1) + 1\n    : (aValue << 1) + 0;\n}\n\n/**\n * Converts to a two-complement value from a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   2 (10 binary) becomes 1, 3 (11 binary) becomes -1\n *   4 (100 binary) becomes 2, 5 (101 binary) becomes -2\n */\nfunction fromVLQSigned(aValue) {\n  var isNegative = (aValue & 1) === 1;\n  var shifted = aValue >> 1;\n  return isNegative\n    ? -shifted\n    : shifted;\n}\n\n/**\n * Returns the base 64 VLQ encoded value.\n */\nexports.encode = function base64VLQ_encode(aValue) {\n  var encoded = \"\";\n  var digit;\n\n  var vlq = toVLQSigned(aValue);\n\n  do {\n    digit = vlq & VLQ_BASE_MASK;\n    vlq >>>= VLQ_BASE_SHIFT;\n    if (vlq > 0) {\n      // There are still more digits in this value, so we must make sure the\n      // continuation bit is marked.\n      digit |= VLQ_CONTINUATION_BIT;\n    }\n    encoded += base64.encode(digit);\n  } while (vlq > 0);\n\n  return encoded;\n};\n\n/**\n * Decodes the next base 64 VLQ value from the given string and returns the\n * value and the rest of the string via the out parameter.\n */\nexports.decode = function base64VLQ_decode(aStr, aIndex, aOutParam) {\n  var strLen = aStr.length;\n  var result = 0;\n  var shift = 0;\n  var continuation, digit;\n\n  do {\n    if (aIndex >= strLen) {\n      throw new Error(\"Expected more digits in base 64 VLQ value.\");\n    }\n\n    digit = base64.decode(aStr.charCodeAt(aIndex++));\n    if (digit === -1) {\n      throw new Error(\"Invalid base64 digit: \" + aStr.charAt(aIndex - 1));\n    }\n\n    continuation = !!(digit & VLQ_CONTINUATION_BIT);\n    digit &= VLQ_BASE_MASK;\n    result = result + (digit << shift);\n    shift += VLQ_BASE_SHIFT;\n  } while (continuation);\n\n  aOutParam.value = fromVLQSigned(result);\n  aOutParam.rest = aIndex;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n/**\n * This is a helper function for getting values from parameter/options\n * objects.\n *\n * @param args The object we are extracting values from\n * @param name The name of the property we are getting.\n * @param defaultValue An optional value to return if the property is missing\n * from the object. If this is not specified and the property is missing, an\n * error will be thrown.\n */\nfunction getArg(aArgs, aName, aDefaultValue) {\n  if (aName in aArgs) {\n    return aArgs[aName];\n  } else if (arguments.length === 3) {\n    return aDefaultValue;\n  } else {\n    throw new Error('\"' + aName + '\" is a required argument.');\n  }\n}\nexports.getArg = getArg;\n\nvar urlRegexp = /^(?:([\\w+\\-.]+):)?\\/\\/(?:(\\w+:\\w+)@)?([\\w.]*)(?::(\\d+))?(\\S*)$/;\nvar dataUrlRegexp = /^data:.+\\,.+$/;\n\nfunction urlParse(aUrl) {\n  var match = aUrl.match(urlRegexp);\n  if (!match) {\n    return null;\n  }\n  return {\n    scheme: match[1],\n    auth: match[2],\n    host: match[3],\n    port: match[4],\n    path: match[5]\n  };\n}\nexports.urlParse = urlParse;\n\nfunction urlGenerate(aParsedUrl) {\n  var url = '';\n  if (aParsedUrl.scheme) {\n    url += aParsedUrl.scheme + ':';\n  }\n  url += '//';\n  if (aParsedUrl.auth) {\n    url += aParsedUrl.auth + '@';\n  }\n  if (aParsedUrl.host) {\n    url += aParsedUrl.host;\n  }\n  if (aParsedUrl.port) {\n    url += \":\" + aParsedUrl.port\n  }\n  if (aParsedUrl.path) {\n    url += aParsedUrl.path;\n  }\n  return url;\n}\nexports.urlGenerate = urlGenerate;\n\n/**\n * Normalizes a path, or the path portion of a URL:\n *\n * - Replaces consecutive slashes with one slash.\n * - Removes unnecessary '.' parts.\n * - Removes unnecessary '<dir>/..' parts.\n *\n * Based on code in the Node.js 'path' core module.\n *\n * @param aPath The path or url to normalize.\n */\nfunction normalize(aPath) {\n  var path = aPath;\n  var url = urlParse(aPath);\n  if (url) {\n    if (!url.path) {\n      return aPath;\n    }\n    path = url.path;\n  }\n  var isAbsolute = exports.isAbsolute(path);\n\n  var parts = path.split(/\\/+/);\n  for (var part, up = 0, i = parts.length - 1; i >= 0; i--) {\n    part = parts[i];\n    if (part === '.') {\n      parts.splice(i, 1);\n    } else if (part === '..') {\n      up++;\n    } else if (up > 0) {\n      if (part === '') {\n        // The first part is blank if the path is absolute. Trying to go\n        // above the root is a no-op. Therefore we can remove all '..' parts\n        // directly after the root.\n        parts.splice(i + 1, up);\n        up = 0;\n      } else {\n        parts.splice(i, 2);\n        up--;\n      }\n    }\n  }\n  path = parts.join('/');\n\n  if (path === '') {\n    path = isAbsolute ? '/' : '.';\n  }\n\n  if (url) {\n    url.path = path;\n    return urlGenerate(url);\n  }\n  return path;\n}\nexports.normalize = normalize;\n\n/**\n * Joins two paths/URLs.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be joined with the root.\n *\n * - If aPath is a URL or a data URI, aPath is returned, unless aPath is a\n *   scheme-relative URL: Then the scheme of aRoot, if any, is prepended\n *   first.\n * - Otherwise aPath is a path. If aRoot is a URL, then its path portion\n *   is updated with the result and aRoot is returned. Otherwise the result\n *   is returned.\n *   - If aPath is absolute, the result is aPath.\n *   - Otherwise the two paths are joined with a slash.\n * - Joining for example 'http://' and 'www.example.com' is also supported.\n */\nfunction join(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n  if (aPath === \"\") {\n    aPath = \".\";\n  }\n  var aPathUrl = urlParse(aPath);\n  var aRootUrl = urlParse(aRoot);\n  if (aRootUrl) {\n    aRoot = aRootUrl.path || '/';\n  }\n\n  // `join(foo, '//www.example.org')`\n  if (aPathUrl && !aPathUrl.scheme) {\n    if (aRootUrl) {\n      aPathUrl.scheme = aRootUrl.scheme;\n    }\n    return urlGenerate(aPathUrl);\n  }\n\n  if (aPathUrl || aPath.match(dataUrlRegexp)) {\n    return aPath;\n  }\n\n  // `join('http://', 'www.example.com')`\n  if (aRootUrl && !aRootUrl.host && !aRootUrl.path) {\n    aRootUrl.host = aPath;\n    return urlGenerate(aRootUrl);\n  }\n\n  var joined = aPath.charAt(0) === '/'\n    ? aPath\n    : normalize(aRoot.replace(/\\/+$/, '') + '/' + aPath);\n\n  if (aRootUrl) {\n    aRootUrl.path = joined;\n    return urlGenerate(aRootUrl);\n  }\n  return joined;\n}\nexports.join = join;\n\nexports.isAbsolute = function (aPath) {\n  return aPath.charAt(0) === '/' || !!aPath.match(urlRegexp);\n};\n\n/**\n * Make a path relative to a URL or another path.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be made relative to aRoot.\n */\nfunction relative(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n\n  aRoot = aRoot.replace(/\\/$/, '');\n\n  // It is possible for the path to be above the root. In this case, simply\n  // checking whether the root is a prefix of the path won't work. Instead, we\n  // need to remove components from the root one by one, until either we find\n  // a prefix that fits, or we run out of components to remove.\n  var level = 0;\n  while (aPath.indexOf(aRoot + '/') !== 0) {\n    var index = aRoot.lastIndexOf(\"/\");\n    if (index < 0) {\n      return aPath;\n    }\n\n    // If the only part of the root that is left is the scheme (i.e. http://,\n    // file:///, etc.), one or more slashes (/), or simply nothing at all, we\n    // have exhausted all components, so the path is not relative to the root.\n    aRoot = aRoot.slice(0, index);\n    if (aRoot.match(/^([^\\/]+:\\/)?\\/*$/)) {\n      return aPath;\n    }\n\n    ++level;\n  }\n\n  // Make sure we add a \"../\" for each component we removed from the root.\n  return Array(level + 1).join(\"../\") + aPath.substr(aRoot.length + 1);\n}\nexports.relative = relative;\n\nvar supportsNullProto = (function () {\n  var obj = Object.create(null);\n  return !('__proto__' in obj);\n}());\n\nfunction identity (s) {\n  return s;\n}\n\n/**\n * Because behavior goes wacky when you set `__proto__` on objects, we\n * have to prefix all the strings in our set with an arbitrary character.\n *\n * See https://github.com/mozilla/source-map/pull/31 and\n * https://github.com/mozilla/source-map/issues/30\n *\n * @param String aStr\n */\nfunction toSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return '$' + aStr;\n  }\n\n  return aStr;\n}\nexports.toSetString = supportsNullProto ? identity : toSetString;\n\nfunction fromSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return aStr.slice(1);\n  }\n\n  return aStr;\n}\nexports.fromSetString = supportsNullProto ? identity : fromSetString;\n\nfunction isProtoString(s) {\n  if (!s) {\n    return false;\n  }\n\n  var length = s.length;\n\n  if (length < 9 /* \"__proto__\".length */) {\n    return false;\n  }\n\n  if (s.charCodeAt(length - 1) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 2) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 3) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 4) !== 116 /* 't' */ ||\n      s.charCodeAt(length - 5) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 6) !== 114 /* 'r' */ ||\n      s.charCodeAt(length - 7) !== 112 /* 'p' */ ||\n      s.charCodeAt(length - 8) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 9) !== 95  /* '_' */) {\n    return false;\n  }\n\n  for (var i = length - 10; i >= 0; i--) {\n    if (s.charCodeAt(i) !== 36 /* '$' */) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Comparator between two mappings where the original positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same original source/line/column, but different generated\n * line and column the same. Useful when searching for a mapping with a\n * stubbed out mapping.\n */\nfunction compareByOriginalPositions(mappingA, mappingB, onlyCompareOriginal) {\n  var cmp = mappingA.source - mappingB.source;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0 || onlyCompareOriginal) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return mappingA.name - mappingB.name;\n}\nexports.compareByOriginalPositions = compareByOriginalPositions;\n\n/**\n * Comparator between two mappings with deflated source and name indices where\n * the generated positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same generated line and column, but different\n * source/name/original line and column the same. Useful when searching for a\n * mapping with a stubbed out mapping.\n */\nfunction compareByGeneratedPositionsDeflated(mappingA, mappingB, onlyCompareGenerated) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0 || onlyCompareGenerated) {\n    return cmp;\n  }\n\n  cmp = mappingA.source - mappingB.source;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return mappingA.name - mappingB.name;\n}\nexports.compareByGeneratedPositionsDeflated = compareByGeneratedPositionsDeflated;\n\nfunction strcmp(aStr1, aStr2) {\n  if (aStr1 === aStr2) {\n    return 0;\n  }\n\n  if (aStr1 > aStr2) {\n    return 1;\n  }\n\n  return -1;\n}\n\n/**\n * Comparator between two mappings with inflated source and name strings where\n * the generated positions are compared.\n */\nfunction compareByGeneratedPositionsInflated(mappingA, mappingB) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsInflated = compareByGeneratedPositionsInflated;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * A data structure which is a combination of an array and a set. Adding a new\n * member is O(1), testing for membership is O(1), and finding the index of an\n * element is O(1). Removing elements from the set is not supported. Only\n * strings are supported for membership.\n */\nfunction ArraySet() {\n  this._array = [];\n  this._set = Object.create(null);\n}\n\n/**\n * Static method for creating ArraySet instances from an existing array.\n */\nArraySet.fromArray = function ArraySet_fromArray(aArray, aAllowDuplicates) {\n  var set = new ArraySet();\n  for (var i = 0, len = aArray.length; i < len; i++) {\n    set.add(aArray[i], aAllowDuplicates);\n  }\n  return set;\n};\n\n/**\n * Return how many unique items are in this ArraySet. If duplicates have been\n * added, than those do not count towards the size.\n *\n * @returns Number\n */\nArraySet.prototype.size = function ArraySet_size() {\n  return Object.getOwnPropertyNames(this._set).length;\n};\n\n/**\n * Add the given string to this set.\n *\n * @param String aStr\n */\nArraySet.prototype.add = function ArraySet_add(aStr, aAllowDuplicates) {\n  var sStr = util.toSetString(aStr);\n  var isDuplicate = has.call(this._set, sStr);\n  var idx = this._array.length;\n  if (!isDuplicate || aAllowDuplicates) {\n    this._array.push(aStr);\n  }\n  if (!isDuplicate) {\n    this._set[sStr] = idx;\n  }\n};\n\n/**\n * Is the given string a member of this set?\n *\n * @param String aStr\n */\nArraySet.prototype.has = function ArraySet_has(aStr) {\n  var sStr = util.toSetString(aStr);\n  return has.call(this._set, sStr);\n};\n\n/**\n * What is the index of the given string in the array?\n *\n * @param String aStr\n */\nArraySet.prototype.indexOf = function ArraySet_indexOf(aStr) {\n  var sStr = util.toSetString(aStr);\n  if (has.call(this._set, sStr)) {\n    return this._set[sStr];\n  }\n  throw new Error('\"' + aStr + '\" is not in the set.');\n};\n\n/**\n * What is the element at the given index?\n *\n * @param Number aIdx\n */\nArraySet.prototype.at = function ArraySet_at(aIdx) {\n  if (aIdx >= 0 && aIdx < this._array.length) {\n    return this._array[aIdx];\n  }\n  throw new Error('No element indexed by ' + aIdx);\n};\n\n/**\n * Returns the array representation of this set (which has the proper indices\n * indicated by indexOf). Note that this is a copy of the internal array used\n * for storing the members so that no one can mess with internal state.\n */\nArraySet.prototype.toArray = function ArraySet_toArray() {\n  return this._array.slice();\n};\n\nexports.ArraySet = ArraySet;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nexports.GREATEST_LOWER_BOUND = 1;\nexports.LEAST_UPPER_BOUND = 2;\n\n/**\n * Recursive implementation of binary search.\n *\n * @param aLow Indices here and lower do not contain the needle.\n * @param aHigh Indices here and higher do not contain the needle.\n * @param aNeedle The element being searched for.\n * @param aHaystack The non-empty array being searched.\n * @param aCompare Function which takes two elements and returns -1, 0, or 1.\n * @param aBias Either 'binarySearch.GREATEST_LOWER_BOUND' or\n *     'binarySearch.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n */\nfunction recursiveSearch(aLow, aHigh, aNeedle, aHaystack, aCompare, aBias) {\n  // This function terminates when one of the following is true:\n  //\n  //   1. We find the exact element we are looking for.\n  //\n  //   2. We did not find the exact element, but we can return the index of\n  //      the next-closest element.\n  //\n  //   3. We did not find the exact element, and there is no next-closest\n  //      element than the one we are searching for, so we return -1.\n  var mid = Math.floor((aHigh - aLow) / 2) + aLow;\n  var cmp = aCompare(aNeedle, aHaystack[mid], true);\n  if (cmp === 0) {\n    // Found the element we are looking for.\n    return mid;\n  }\n  else if (cmp > 0) {\n    // Our needle is greater than aHaystack[mid].\n    if (aHigh - mid > 1) {\n      // The element is in the upper half.\n      return recursiveSearch(mid, aHigh, aNeedle, aHaystack, aCompare, aBias);\n    }\n\n    // The exact needle element was not found in this haystack. Determine if\n    // we are in termination case (3) or (2) and return the appropriate thing.\n    if (aBias == exports.LEAST_UPPER_BOUND) {\n      return aHigh < aHaystack.length ? aHigh : -1;\n    } else {\n      return mid;\n    }\n  }\n  else {\n    // Our needle is less than aHaystack[mid].\n    if (mid - aLow > 1) {\n      // The element is in the lower half.\n      return recursiveSearch(aLow, mid, aNeedle, aHaystack, aCompare, aBias);\n    }\n\n    // we are in termination case (3) or (2) and return the appropriate thing.\n    if (aBias == exports.LEAST_UPPER_BOUND) {\n      return mid;\n    } else {\n      return aLow < 0 ? -1 : aLow;\n    }\n  }\n}\n\n/**\n * This is an implementation of binary search which will always try and return\n * the index of the closest element if there is no exact hit. This is because\n * mappings between original and generated line/col pairs are single points,\n * and there is an implicit region between each of them, so a miss just means\n * that you aren't on the very start of a region.\n *\n * @param aNeedle The element you are looking for.\n * @param aHaystack The array that is being searched.\n * @param aCompare A function which takes the needle and an element in the\n *     array and returns -1, 0, or 1 depending on whether the needle is less\n *     than, equal to, or greater than the element, respectively.\n * @param aBias Either 'binarySearch.GREATEST_LOWER_BOUND' or\n *     'binarySearch.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'binarySearch.GREATEST_LOWER_BOUND'.\n */\nexports.search = function search(aNeedle, aHaystack, aCompare, aBias) {\n  if (aHaystack.length === 0) {\n    return -1;\n  }\n\n  var index = recursiveSearch(-1, aHaystack.length, aNeedle, aHaystack,\n                              aCompare, aBias || exports.GREATEST_LOWER_BOUND);\n  if (index < 0) {\n    return -1;\n  }\n\n  // We have found either the exact element, or the next-closest element than\n  // the one we are searching for. However, there may be more than one such\n  // element. Make sure we always return the smallest of these.\n  while (index - 1 >= 0) {\n    if (aCompare(aHaystack[index], aHaystack[index - 1], true) !== 0) {\n      break;\n    }\n    --index;\n  }\n\n  return index;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n// It turns out that some (most?) JavaScript engines don't self-host\n// `Array.prototype.sort`. This makes sense because C++ will likely remain\n// faster than JS when doing raw CPU-intensive sorting. However, when using a\n// custom comparator function, calling back and forth between the VM's C++ and\n// JIT'd JS is rather slow *and* loses JIT type information, resulting in\n// worse generated code for the comparator function than would be optimal. In\n// fact, when sorting with a comparator, these costs outweigh the benefits of\n// sorting in C++. By using our own JS-implemented Quick Sort (below), we get\n// a ~3500ms mean speed-up in `bench/bench.html`.\n\n/**\n * Swap the elements indexed by `x` and `y` in the array `ary`.\n *\n * @param {Array} ary\n *        The array.\n * @param {Number} x\n *        The index of the first item.\n * @param {Number} y\n *        The index of the second item.\n */\nfunction swap(ary, x, y) {\n  var temp = ary[x];\n  ary[x] = ary[y];\n  ary[y] = temp;\n}\n\n/**\n * Returns a random integer within the range `low .. high` inclusive.\n *\n * @param {Number} low\n *        The lower bound on the range.\n * @param {Number} high\n *        The upper bound on the range.\n */\nfunction randomIntInRange(low, high) {\n  return Math.round(low + (Math.random() * (high - low)));\n}\n\n/**\n * The Quick Sort algorithm.\n *\n * @param {Array} ary\n *        An array to sort.\n * @param {function} comparator\n *        Function to use to compare two items.\n * @param {Number} p\n *        Start index of the array\n * @param {Number} r\n *        End index of the array\n */\nfunction doQuickSort(ary, comparator, p, r) {\n  // If our lower bound is less than our upper bound, we (1) partition the\n  // array into two pieces and (2) recurse on each half. If it is not, this is\n  // the empty array and our base case.\n\n  if (p < r) {\n    // (1) Partitioning.\n    //\n    // The partitioning chooses a pivot between `p` and `r` and moves all\n    // elements that are less than or equal to the pivot to the before it, and\n    // all the elements that are greater than it after it. The effect is that\n    // once partition is done, the pivot is in the exact place it will be when\n    // the array is put in sorted order, and it will not need to be moved\n    // again. This runs in O(n) time.\n\n    // Always choose a random pivot so that an input array which is reverse\n    // sorted does not cause O(n^2) running time.\n    var pivotIndex = randomIntInRange(p, r);\n    var i = p - 1;\n\n    swap(ary, pivotIndex, r);\n    var pivot = ary[r];\n\n    // Immediately after `j` is incremented in this loop, the following hold\n    // true:\n    //\n    //   * Every element in `ary[p .. i]` is less than or equal to the pivot.\n    //\n    //   * Every element in `ary[i+1 .. j-1]` is greater than the pivot.\n    for (var j = p; j < r; j++) {\n      if (comparator(ary[j], pivot) <= 0) {\n        i += 1;\n        swap(ary, i, j);\n      }\n    }\n\n    swap(ary, i + 1, j);\n    var q = i + 1;\n\n    // (2) Recurse on each half.\n\n    doQuickSort(ary, comparator, p, q - 1);\n    doQuickSort(ary, comparator, q + 1, r);\n  }\n}\n\n/**\n * Sort the given array in-place with the given comparator function.\n *\n * @param {Array} ary\n *        An array to sort.\n * @param {function} comparator\n *        Function to use to compare two items.\n */\nexports.quickSort = function (ary, comparator) {\n  doQuickSort(ary, comparator, 0, ary.length - 1);\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar binarySearch = require('./binary-search');\nvar ArraySet = require('./array-set').ArraySet;\nvar base64VLQ = require('./base64-vlq');\nvar quickSort = require('./quick-sort').quickSort;\n\nfunction SourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  return sourceMap.sections != null\n    ? new IndexedSourceMapConsumer(sourceMap)\n    : new BasicSourceMapConsumer(sourceMap);\n}\n\nSourceMapConsumer.fromSourceMap = function(aSourceMap) {\n  return BasicSourceMapConsumer.fromSourceMap(aSourceMap);\n}\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nSourceMapConsumer.prototype._version = 3;\n\n// `__generatedMappings` and `__originalMappings` are arrays that hold the\n// parsed mapping coordinates from the source map's \"mappings\" attribute. They\n// are lazily instantiated, accessed via the `_generatedMappings` and\n// `_originalMappings` getters respectively, and we only parse the mappings\n// and create these arrays once queried for a source location. We jump through\n// these hoops because there can be many thousands of mappings, and parsing\n// them is expensive, so we only want to do it if we must.\n//\n// Each object in the arrays is of the form:\n//\n//     {\n//       generatedLine: The line number in the generated code,\n//       generatedColumn: The column number in the generated code,\n//       source: The path to the original source file that generated this\n//               chunk of code,\n//       originalLine: The line number in the original source that\n//                     corresponds to this chunk of generated code,\n//       originalColumn: The column number in the original source that\n//                       corresponds to this chunk of generated code,\n//       name: The name of the original symbol which generated this chunk of\n//             code.\n//     }\n//\n// All properties except for `generatedLine` and `generatedColumn` can be\n// `null`.\n//\n// `_generatedMappings` is ordered by the generated positions.\n//\n// `_originalMappings` is ordered by the original positions.\n\nSourceMapConsumer.prototype.__generatedMappings = null;\nObject.defineProperty(SourceMapConsumer.prototype, '_generatedMappings', {\n  get: function () {\n    if (!this.__generatedMappings) {\n      this._parseMappings(this._mappings, this.sourceRoot);\n    }\n\n    return this.__generatedMappings;\n  }\n});\n\nSourceMapConsumer.prototype.__originalMappings = null;\nObject.defineProperty(SourceMapConsumer.prototype, '_originalMappings', {\n  get: function () {\n    if (!this.__originalMappings) {\n      this._parseMappings(this._mappings, this.sourceRoot);\n    }\n\n    return this.__originalMappings;\n  }\n});\n\nSourceMapConsumer.prototype._charIsMappingSeparator =\n  function SourceMapConsumer_charIsMappingSeparator(aStr, index) {\n    var c = aStr.charAt(index);\n    return c === \";\" || c === \",\";\n  };\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nSourceMapConsumer.prototype._parseMappings =\n  function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    throw new Error(\"Subclasses must implement _parseMappings\");\n  };\n\nSourceMapConsumer.GENERATED_ORDER = 1;\nSourceMapConsumer.ORIGINAL_ORDER = 2;\n\nSourceMapConsumer.GREATEST_LOWER_BOUND = 1;\nSourceMapConsumer.LEAST_UPPER_BOUND = 2;\n\n/**\n * Iterate over each mapping between an original source/line/column and a\n * generated line/column in this source map.\n *\n * @param Function aCallback\n *        The function that is called with each mapping.\n * @param Object aContext\n *        Optional. If specified, this object will be the value of `this` every\n *        time that `aCallback` is called.\n * @param aOrder\n *        Either `SourceMapConsumer.GENERATED_ORDER` or\n *        `SourceMapConsumer.ORIGINAL_ORDER`. Specifies whether you want to\n *        iterate over the mappings sorted by the generated file's line/column\n *        order or the original's source/line/column order, respectively. Defaults to\n *        `SourceMapConsumer.GENERATED_ORDER`.\n */\nSourceMapConsumer.prototype.eachMapping =\n  function SourceMapConsumer_eachMapping(aCallback, aContext, aOrder) {\n    var context = aContext || null;\n    var order = aOrder || SourceMapConsumer.GENERATED_ORDER;\n\n    var mappings;\n    switch (order) {\n    case SourceMapConsumer.GENERATED_ORDER:\n      mappings = this._generatedMappings;\n      break;\n    case SourceMapConsumer.ORIGINAL_ORDER:\n      mappings = this._originalMappings;\n      break;\n    default:\n      throw new Error(\"Unknown order of iteration.\");\n    }\n\n    var sourceRoot = this.sourceRoot;\n    mappings.map(function (mapping) {\n      var source = mapping.source === null ? null : this._sources.at(mapping.source);\n      if (source != null && sourceRoot != null) {\n        source = util.join(sourceRoot, source);\n      }\n      return {\n        source: source,\n        generatedLine: mapping.generatedLine,\n        generatedColumn: mapping.generatedColumn,\n        originalLine: mapping.originalLine,\n        originalColumn: mapping.originalColumn,\n        name: mapping.name === null ? null : this._names.at(mapping.name)\n      };\n    }, this).forEach(aCallback, context);\n  };\n\n/**\n * Returns all generated line and column information for the original source,\n * line, and column provided. If no column is provided, returns all mappings\n * corresponding to a either the line we are searching for or the next\n * closest line that has any mappings. Otherwise, returns all mappings\n * corresponding to the given line and either the column we are searching for\n * or the next closest column that has any offsets.\n *\n * The only argument is an object with the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: Optional. the column number in the original source.\n *\n * and an array of objects is returned, each with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nSourceMapConsumer.prototype.allGeneratedPositionsFor =\n  function SourceMapConsumer_allGeneratedPositionsFor(aArgs) {\n    var line = util.getArg(aArgs, 'line');\n\n    // When there is no exact match, BasicSourceMapConsumer.prototype._findMapping\n    // returns the index of the closest mapping less than the needle. By\n    // setting needle.originalColumn to 0, we thus find the last mapping for\n    // the given line, provided such a mapping exists.\n    var needle = {\n      source: util.getArg(aArgs, 'source'),\n      originalLine: line,\n      originalColumn: util.getArg(aArgs, 'column', 0)\n    };\n\n    if (this.sourceRoot != null) {\n      needle.source = util.relative(this.sourceRoot, needle.source);\n    }\n    if (!this._sources.has(needle.source)) {\n      return [];\n    }\n    needle.source = this._sources.indexOf(needle.source);\n\n    var mappings = [];\n\n    var index = this._findMapping(needle,\n                                  this._originalMappings,\n                                  \"originalLine\",\n                                  \"originalColumn\",\n                                  util.compareByOriginalPositions,\n                                  binarySearch.LEAST_UPPER_BOUND);\n    if (index >= 0) {\n      var mapping = this._originalMappings[index];\n\n      if (aArgs.column === undefined) {\n        var originalLine = mapping.originalLine;\n\n        // Iterate until either we run out of mappings, or we run into\n        // a mapping for a different line than the one we found. Since\n        // mappings are sorted, this is guaranteed to find all mappings for\n        // the line we found.\n        while (mapping && mapping.originalLine === originalLine) {\n          mappings.push({\n            line: util.getArg(mapping, 'generatedLine', null),\n            column: util.getArg(mapping, 'generatedColumn', null),\n            lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n          });\n\n          mapping = this._originalMappings[++index];\n        }\n      } else {\n        var originalColumn = mapping.originalColumn;\n\n        // Iterate until either we run out of mappings, or we run into\n        // a mapping for a different line than the one we were searching for.\n        // Since mappings are sorted, this is guaranteed to find all mappings for\n        // the line we are searching for.\n        while (mapping &&\n               mapping.originalLine === line &&\n               mapping.originalColumn == originalColumn) {\n          mappings.push({\n            line: util.getArg(mapping, 'generatedLine', null),\n            column: util.getArg(mapping, 'generatedColumn', null),\n            lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n          });\n\n          mapping = this._originalMappings[++index];\n        }\n      }\n    }\n\n    return mappings;\n  };\n\nexports.SourceMapConsumer = SourceMapConsumer;\n\n/**\n * A BasicSourceMapConsumer instance represents a parsed source map which we can\n * query for information about the original file positions by giving it a file\n * position in the generated source.\n *\n * The only parameter is the raw source map (either as a JSON string, or\n * already parsed to an object). According to the spec, source maps have the\n * following attributes:\n *\n *   - version: Which version of the source map spec this map is following.\n *   - sources: An array of URLs to the original source files.\n *   - names: An array of identifiers which can be referrenced by individual mappings.\n *   - sourceRoot: Optional. The URL root from which all sources are relative.\n *   - sourcesContent: Optional. An array of contents of the original source files.\n *   - mappings: A string of base64 VLQs which contain the actual mappings.\n *   - file: Optional. The generated file this source map is associated with.\n *\n * Here is an example source map, taken from the source map spec[0]:\n *\n *     {\n *       version : 3,\n *       file: \"out.js\",\n *       sourceRoot : \"\",\n *       sources: [\"foo.js\", \"bar.js\"],\n *       names: [\"src\", \"maps\", \"are\", \"fun\"],\n *       mappings: \"AA,AB;;ABCDE;\"\n *     }\n *\n * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit?pli=1#\n */\nfunction BasicSourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  var version = util.getArg(sourceMap, 'version');\n  var sources = util.getArg(sourceMap, 'sources');\n  // Sass 3.3 leaves out the 'names' array, so we deviate from the spec (which\n  // requires the array) to play nice here.\n  var names = util.getArg(sourceMap, 'names', []);\n  var sourceRoot = util.getArg(sourceMap, 'sourceRoot', null);\n  var sourcesContent = util.getArg(sourceMap, 'sourcesContent', null);\n  var mappings = util.getArg(sourceMap, 'mappings');\n  var file = util.getArg(sourceMap, 'file', null);\n\n  // Once again, Sass deviates from the spec and supplies the version as a\n  // string rather than a number, so we use loose equality checking here.\n  if (version != this._version) {\n    throw new Error('Unsupported version: ' + version);\n  }\n\n  sources = sources\n    .map(String)\n    // Some source maps produce relative source paths like \"./foo.js\" instead of\n    // \"foo.js\".  Normalize these first so that future comparisons will succeed.\n    // See bugzil.la/1090768.\n    .map(util.normalize)\n    // Always ensure that absolute sources are internally stored relative to\n    // the source root, if the source root is absolute. Not doing this would\n    // be particularly problematic when the source root is a prefix of the\n    // source (valid, but why??). See github issue #199 and bugzil.la/1188982.\n    .map(function (source) {\n      return sourceRoot && util.isAbsolute(sourceRoot) && util.isAbsolute(source)\n        ? util.relative(sourceRoot, source)\n        : source;\n    });\n\n  // Pass `true` below to allow duplicate names and sources. While source maps\n  // are intended to be compressed and deduplicated, the TypeScript compiler\n  // sometimes generates source maps with duplicates in them. See Github issue\n  // #72 and bugzil.la/889492.\n  this._names = ArraySet.fromArray(names.map(String), true);\n  this._sources = ArraySet.fromArray(sources, true);\n\n  this.sourceRoot = sourceRoot;\n  this.sourcesContent = sourcesContent;\n  this._mappings = mappings;\n  this.file = file;\n}\n\nBasicSourceMapConsumer.prototype = Object.create(SourceMapConsumer.prototype);\nBasicSourceMapConsumer.prototype.consumer = SourceMapConsumer;\n\n/**\n * Create a BasicSourceMapConsumer from a SourceMapGenerator.\n *\n * @param SourceMapGenerator aSourceMap\n *        The source map that will be consumed.\n * @returns BasicSourceMapConsumer\n */\nBasicSourceMapConsumer.fromSourceMap =\n  function SourceMapConsumer_fromSourceMap(aSourceMap) {\n    var smc = Object.create(BasicSourceMapConsumer.prototype);\n\n    var names = smc._names = ArraySet.fromArray(aSourceMap._names.toArray(), true);\n    var sources = smc._sources = ArraySet.fromArray(aSourceMap._sources.toArray(), true);\n    smc.sourceRoot = aSourceMap._sourceRoot;\n    smc.sourcesContent = aSourceMap._generateSourcesContent(smc._sources.toArray(),\n                                                            smc.sourceRoot);\n    smc.file = aSourceMap._file;\n\n    // Because we are modifying the entries (by converting string sources and\n    // names to indices into the sources and names ArraySets), we have to make\n    // a copy of the entry or else bad things happen. Shared mutable state\n    // strikes again! See github issue #191.\n\n    var generatedMappings = aSourceMap._mappings.toArray().slice();\n    var destGeneratedMappings = smc.__generatedMappings = [];\n    var destOriginalMappings = smc.__originalMappings = [];\n\n    for (var i = 0, length = generatedMappings.length; i < length; i++) {\n      var srcMapping = generatedMappings[i];\n      var destMapping = new Mapping;\n      destMapping.generatedLine = srcMapping.generatedLine;\n      destMapping.generatedColumn = srcMapping.generatedColumn;\n\n      if (srcMapping.source) {\n        destMapping.source = sources.indexOf(srcMapping.source);\n        destMapping.originalLine = srcMapping.originalLine;\n        destMapping.originalColumn = srcMapping.originalColumn;\n\n        if (srcMapping.name) {\n          destMapping.name = names.indexOf(srcMapping.name);\n        }\n\n        destOriginalMappings.push(destMapping);\n      }\n\n      destGeneratedMappings.push(destMapping);\n    }\n\n    quickSort(smc.__originalMappings, util.compareByOriginalPositions);\n\n    return smc;\n  };\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nBasicSourceMapConsumer.prototype._version = 3;\n\n/**\n * The list of original sources.\n */\nObject.defineProperty(BasicSourceMapConsumer.prototype, 'sources', {\n  get: function () {\n    return this._sources.toArray().map(function (s) {\n      return this.sourceRoot != null ? util.join(this.sourceRoot, s) : s;\n    }, this);\n  }\n});\n\n/**\n * Provide the JIT with a nice shape / hidden class.\n */\nfunction Mapping() {\n  this.generatedLine = 0;\n  this.generatedColumn = 0;\n  this.source = null;\n  this.originalLine = null;\n  this.originalColumn = null;\n  this.name = null;\n}\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nBasicSourceMapConsumer.prototype._parseMappings =\n  function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    var generatedLine = 1;\n    var previousGeneratedColumn = 0;\n    var previousOriginalLine = 0;\n    var previousOriginalColumn = 0;\n    var previousSource = 0;\n    var previousName = 0;\n    var length = aStr.length;\n    var index = 0;\n    var cachedSegments = {};\n    var temp = {};\n    var originalMappings = [];\n    var generatedMappings = [];\n    var mapping, str, segment, end, value;\n\n    while (index < length) {\n      if (aStr.charAt(index) === ';') {\n        generatedLine++;\n        index++;\n        previousGeneratedColumn = 0;\n      }\n      else if (aStr.charAt(index) === ',') {\n        index++;\n      }\n      else {\n        mapping = new Mapping();\n        mapping.generatedLine = generatedLine;\n\n        // Because each offset is encoded relative to the previous one,\n        // many segments often have the same encoding. We can exploit this\n        // fact by caching the parsed variable length fields of each segment,\n        // allowing us to avoid a second parse if we encounter the same\n        // segment again.\n        for (end = index; end < length; end++) {\n          if (this._charIsMappingSeparator(aStr, end)) {\n            break;\n          }\n        }\n        str = aStr.slice(index, end);\n\n        segment = cachedSegments[str];\n        if (segment) {\n          index += str.length;\n        } else {\n          segment = [];\n          while (index < end) {\n            base64VLQ.decode(aStr, index, temp);\n            value = temp.value;\n            index = temp.rest;\n            segment.push(value);\n          }\n\n          if (segment.length === 2) {\n            throw new Error('Found a source, but no line and column');\n          }\n\n          if (segment.length === 3) {\n            throw new Error('Found a source and line, but no column');\n          }\n\n          cachedSegments[str] = segment;\n        }\n\n        // Generated column.\n        mapping.generatedColumn = previousGeneratedColumn + segment[0];\n        previousGeneratedColumn = mapping.generatedColumn;\n\n        if (segment.length > 1) {\n          // Original source.\n          mapping.source = previousSource + segment[1];\n          previousSource += segment[1];\n\n          // Original line.\n          mapping.originalLine = previousOriginalLine + segment[2];\n          previousOriginalLine = mapping.originalLine;\n          // Lines are stored 0-based\n          mapping.originalLine += 1;\n\n          // Original column.\n          mapping.originalColumn = previousOriginalColumn + segment[3];\n          previousOriginalColumn = mapping.originalColumn;\n\n          if (segment.length > 4) {\n            // Original name.\n            mapping.name = previousName + segment[4];\n            previousName += segment[4];\n          }\n        }\n\n        generatedMappings.push(mapping);\n        if (typeof mapping.originalLine === 'number') {\n          originalMappings.push(mapping);\n        }\n      }\n    }\n\n    quickSort(generatedMappings, util.compareByGeneratedPositionsDeflated);\n    this.__generatedMappings = generatedMappings;\n\n    quickSort(originalMappings, util.compareByOriginalPositions);\n    this.__originalMappings = originalMappings;\n  };\n\n/**\n * Find the mapping that best matches the hypothetical \"needle\" mapping that\n * we are searching for in the given \"haystack\" of mappings.\n */\nBasicSourceMapConsumer.prototype._findMapping =\n  function SourceMapConsumer_findMapping(aNeedle, aMappings, aLineName,\n                                         aColumnName, aComparator, aBias) {\n    // To return the position we are searching for, we must first find the\n    // mapping for the given position and then return the opposite position it\n    // points to. Because the mappings are sorted, we can use binary search to\n    // find the best mapping.\n\n    if (aNeedle[aLineName] <= 0) {\n      throw new TypeError('Line must be greater than or equal to 1, got '\n                          + aNeedle[aLineName]);\n    }\n    if (aNeedle[aColumnName] < 0) {\n      throw new TypeError('Column must be greater than or equal to 0, got '\n                          + aNeedle[aColumnName]);\n    }\n\n    return binarySearch.search(aNeedle, aMappings, aComparator, aBias);\n  };\n\n/**\n * Compute the last column for each generated mapping. The last column is\n * inclusive.\n */\nBasicSourceMapConsumer.prototype.computeColumnSpans =\n  function SourceMapConsumer_computeColumnSpans() {\n    for (var index = 0; index < this._generatedMappings.length; ++index) {\n      var mapping = this._generatedMappings[index];\n\n      // Mappings do not contain a field for the last generated columnt. We\n      // can come up with an optimistic estimate, however, by assuming that\n      // mappings are contiguous (i.e. given two consecutive mappings, the\n      // first mapping ends where the second one starts).\n      if (index + 1 < this._generatedMappings.length) {\n        var nextMapping = this._generatedMappings[index + 1];\n\n        if (mapping.generatedLine === nextMapping.generatedLine) {\n          mapping.lastGeneratedColumn = nextMapping.generatedColumn - 1;\n          continue;\n        }\n      }\n\n      // The last mapping for each line spans the entire line.\n      mapping.lastGeneratedColumn = Infinity;\n    }\n  };\n\n/**\n * Returns the original source, line, and column information for the generated\n * source's line and column positions provided. The only argument is an object\n * with the following properties:\n *\n *   - line: The line number in the generated source.\n *   - column: The column number in the generated source.\n *   - bias: Either 'SourceMapConsumer.GREATEST_LOWER_BOUND' or\n *     'SourceMapConsumer.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'SourceMapConsumer.GREATEST_LOWER_BOUND'.\n *\n * and an object is returned with the following properties:\n *\n *   - source: The original source file, or null.\n *   - line: The line number in the original source, or null.\n *   - column: The column number in the original source, or null.\n *   - name: The original identifier, or null.\n */\nBasicSourceMapConsumer.prototype.originalPositionFor =\n  function SourceMapConsumer_originalPositionFor(aArgs) {\n    var needle = {\n      generatedLine: util.getArg(aArgs, 'line'),\n      generatedColumn: util.getArg(aArgs, 'column')\n    };\n\n    var index = this._findMapping(\n      needle,\n      this._generatedMappings,\n      \"generatedLine\",\n      \"generatedColumn\",\n      util.compareByGeneratedPositionsDeflated,\n      util.getArg(aArgs, 'bias', SourceMapConsumer.GREATEST_LOWER_BOUND)\n    );\n\n    if (index >= 0) {\n      var mapping = this._generatedMappings[index];\n\n      if (mapping.generatedLine === needle.generatedLine) {\n        var source = util.getArg(mapping, 'source', null);\n        if (source !== null) {\n          source = this._sources.at(source);\n          if (this.sourceRoot != null) {\n            source = util.join(this.sourceRoot, source);\n          }\n        }\n        var name = util.getArg(mapping, 'name', null);\n        if (name !== null) {\n          name = this._names.at(name);\n        }\n        return {\n          source: source,\n          line: util.getArg(mapping, 'originalLine', null),\n          column: util.getArg(mapping, 'originalColumn', null),\n          name: name\n        };\n      }\n    }\n\n    return {\n      source: null,\n      line: null,\n      column: null,\n      name: null\n    };\n  };\n\n/**\n * Return true if we have the source content for every source in the source\n * map, false otherwise.\n */\nBasicSourceMapConsumer.prototype.hasContentsOfAllSources =\n  function BasicSourceMapConsumer_hasContentsOfAllSources() {\n    if (!this.sourcesContent) {\n      return false;\n    }\n    return this.sourcesContent.length >= this._sources.size() &&\n      !this.sourcesContent.some(function (sc) { return sc == null; });\n  };\n\n/**\n * Returns the original source content. The only argument is the url of the\n * original source file. Returns null if no original source content is\n * available.\n */\nBasicSourceMapConsumer.prototype.sourceContentFor =\n  function SourceMapConsumer_sourceContentFor(aSource, nullOnMissing) {\n    if (!this.sourcesContent) {\n      return null;\n    }\n\n    if (this.sourceRoot != null) {\n      aSource = util.relative(this.sourceRoot, aSource);\n    }\n\n    if (this._sources.has(aSource)) {\n      return this.sourcesContent[this._sources.indexOf(aSource)];\n    }\n\n    var url;\n    if (this.sourceRoot != null\n        && (url = util.urlParse(this.sourceRoot))) {\n      // XXX: file:// URIs and absolute paths lead to unexpected behavior for\n      // many users. We can help them out when they expect file:// URIs to\n      // behave like it would if they were running a local HTTP server. See\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=885597.\n      var fileUriAbsPath = aSource.replace(/^file:\\/\\//, \"\");\n      if (url.scheme == \"file\"\n          && this._sources.has(fileUriAbsPath)) {\n        return this.sourcesContent[this._sources.indexOf(fileUriAbsPath)]\n      }\n\n      if ((!url.path || url.path == \"/\")\n          && this._sources.has(\"/\" + aSource)) {\n        return this.sourcesContent[this._sources.indexOf(\"/\" + aSource)];\n      }\n    }\n\n    // This function is used recursively from\n    // IndexedSourceMapConsumer.prototype.sourceContentFor. In that case, we\n    // don't want to throw if we can't find the source - we just want to\n    // return null, so we provide a flag to exit gracefully.\n    if (nullOnMissing) {\n      return null;\n    }\n    else {\n      throw new Error('\"' + aSource + '\" is not in the SourceMap.');\n    }\n  };\n\n/**\n * Returns the generated line and column information for the original source,\n * line, and column positions provided. The only argument is an object with\n * the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: The column number in the original source.\n *   - bias: Either 'SourceMapConsumer.GREATEST_LOWER_BOUND' or\n *     'SourceMapConsumer.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'SourceMapConsumer.GREATEST_LOWER_BOUND'.\n *\n * and an object is returned with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nBasicSourceMapConsumer.prototype.generatedPositionFor =\n  function SourceMapConsumer_generatedPositionFor(aArgs) {\n    var source = util.getArg(aArgs, 'source');\n    if (this.sourceRoot != null) {\n      source = util.relative(this.sourceRoot, source);\n    }\n    if (!this._sources.has(source)) {\n      return {\n        line: null,\n        column: null,\n        lastColumn: null\n      };\n    }\n    source = this._sources.indexOf(source);\n\n    var needle = {\n      source: source,\n      originalLine: util.getArg(aArgs, 'line'),\n      originalColumn: util.getArg(aArgs, 'column')\n    };\n\n    var index = this._findMapping(\n      needle,\n      this._originalMappings,\n      \"originalLine\",\n      \"originalColumn\",\n      util.compareByOriginalPositions,\n      util.getArg(aArgs, 'bias', SourceMapConsumer.GREATEST_LOWER_BOUND)\n    );\n\n    if (index >= 0) {\n      var mapping = this._originalMappings[index];\n\n      if (mapping.source === needle.source) {\n        return {\n          line: util.getArg(mapping, 'generatedLine', null),\n          column: util.getArg(mapping, 'generatedColumn', null),\n          lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n        };\n      }\n    }\n\n    return {\n      line: null,\n      column: null,\n      lastColumn: null\n    };\n  };\n\nexports.BasicSourceMapConsumer = BasicSourceMapConsumer;\n\n/**\n * An IndexedSourceMapConsumer instance represents a parsed source map which\n * we can query for information. It differs from BasicSourceMapConsumer in\n * that it takes \"indexed\" source maps (i.e. ones with a \"sections\" field) as\n * input.\n *\n * The only parameter is a raw source map (either as a JSON string, or already\n * parsed to an object). According to the spec for indexed source maps, they\n * have the following attributes:\n *\n *   - version: Which version of the source map spec this map is following.\n *   - file: Optional. The generated file this source map is associated with.\n *   - sections: A list of section definitions.\n *\n * Each value under the \"sections\" field has two fields:\n *   - offset: The offset into the original specified at which this section\n *       begins to apply, defined as an object with a \"line\" and \"column\"\n *       field.\n *   - map: A source map definition. This source map could also be indexed,\n *       but doesn't have to be.\n *\n * Instead of the \"map\" field, it's also possible to have a \"url\" field\n * specifying a URL to retrieve a source map from, but that's currently\n * unsupported.\n *\n * Here's an example source map, taken from the source map spec[0], but\n * modified to omit a section which uses the \"url\" field.\n *\n *  {\n *    version : 3,\n *    file: \"app.js\",\n *    sections: [{\n *      offset: {line:100, column:10},\n *      map: {\n *        version : 3,\n *        file: \"section.js\",\n *        sources: [\"foo.js\", \"bar.js\"],\n *        names: [\"src\", \"maps\", \"are\", \"fun\"],\n *        mappings: \"AAAA,E;;ABCDE;\"\n *      }\n *    }],\n *  }\n *\n * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit#heading=h.535es3xeprgt\n */\nfunction IndexedSourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  var version = util.getArg(sourceMap, 'version');\n  var sections = util.getArg(sourceMap, 'sections');\n\n  if (version != this._version) {\n    throw new Error('Unsupported version: ' + version);\n  }\n\n  this._sources = new ArraySet();\n  this._names = new ArraySet();\n\n  var lastOffset = {\n    line: -1,\n    column: 0\n  };\n  this._sections = sections.map(function (s) {\n    if (s.url) {\n      // The url field will require support for asynchronicity.\n      // See https://github.com/mozilla/source-map/issues/16\n      throw new Error('Support for url field in sections not implemented.');\n    }\n    var offset = util.getArg(s, 'offset');\n    var offsetLine = util.getArg(offset, 'line');\n    var offsetColumn = util.getArg(offset, 'column');\n\n    if (offsetLine < lastOffset.line ||\n        (offsetLine === lastOffset.line && offsetColumn < lastOffset.column)) {\n      throw new Error('Section offsets must be ordered and non-overlapping.');\n    }\n    lastOffset = offset;\n\n    return {\n      generatedOffset: {\n        // The offset fields are 0-based, but we use 1-based indices when\n        // encoding/decoding from VLQ.\n        generatedLine: offsetLine + 1,\n        generatedColumn: offsetColumn + 1\n      },\n      consumer: new SourceMapConsumer(util.getArg(s, 'map'))\n    }\n  });\n}\n\nIndexedSourceMapConsumer.prototype = Object.create(SourceMapConsumer.prototype);\nIndexedSourceMapConsumer.prototype.constructor = SourceMapConsumer;\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nIndexedSourceMapConsumer.prototype._version = 3;\n\n/**\n * The list of original sources.\n */\nObject.defineProperty(IndexedSourceMapConsumer.prototype, 'sources', {\n  get: function () {\n    var sources = [];\n    for (var i = 0; i < this._sections.length; i++) {\n      for (var j = 0; j < this._sections[i].consumer.sources.length; j++) {\n        sources.push(this._sections[i].consumer.sources[j]);\n      }\n    }\n    return sources;\n  }\n});\n\n/**\n * Returns the original source, line, and column information for the generated\n * source's line and column positions provided. The only argument is an object\n * with the following properties:\n *\n *   - line: The line number in the generated source.\n *   - column: The column number in the generated source.\n *\n * and an object is returned with the following properties:\n *\n *   - source: The original source file, or null.\n *   - line: The line number in the original source, or null.\n *   - column: The column number in the original source, or null.\n *   - name: The original identifier, or null.\n */\nIndexedSourceMapConsumer.prototype.originalPositionFor =\n  function IndexedSourceMapConsumer_originalPositionFor(aArgs) {\n    var needle = {\n      generatedLine: util.getArg(aArgs, 'line'),\n      generatedColumn: util.getArg(aArgs, 'column')\n    };\n\n    // Find the section containing the generated position we're trying to map\n    // to an original position.\n    var sectionIndex = binarySearch.search(needle, this._sections,\n      function(needle, section) {\n        var cmp = needle.generatedLine - section.generatedOffset.generatedLine;\n        if (cmp) {\n          return cmp;\n        }\n\n        return (needle.generatedColumn -\n                section.generatedOffset.generatedColumn);\n      });\n    var section = this._sections[sectionIndex];\n\n    if (!section) {\n      return {\n        source: null,\n        line: null,\n        column: null,\n        name: null\n      };\n    }\n\n    return section.consumer.originalPositionFor({\n      line: needle.generatedLine -\n        (section.generatedOffset.generatedLine - 1),\n      column: needle.generatedColumn -\n        (section.generatedOffset.generatedLine === needle.generatedLine\n         ? section.generatedOffset.generatedColumn - 1\n         : 0),\n      bias: aArgs.bias\n    });\n  };\n\n/**\n * Return true if we have the source content for every source in the source\n * map, false otherwise.\n */\nIndexedSourceMapConsumer.prototype.hasContentsOfAllSources =\n  function IndexedSourceMapConsumer_hasContentsOfAllSources() {\n    return this._sections.every(function (s) {\n      return s.consumer.hasContentsOfAllSources();\n    });\n  };\n\n/**\n * Returns the original source content. The only argument is the url of the\n * original source file. Returns null if no original source content is\n * available.\n */\nIndexedSourceMapConsumer.prototype.sourceContentFor =\n  function IndexedSourceMapConsumer_sourceContentFor(aSource, nullOnMissing) {\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n\n      var content = section.consumer.sourceContentFor(aSource, true);\n      if (content) {\n        return content;\n      }\n    }\n    if (nullOnMissing) {\n      return null;\n    }\n    else {\n      throw new Error('\"' + aSource + '\" is not in the SourceMap.');\n    }\n  };\n\n/**\n * Returns the generated line and column information for the original source,\n * line, and column positions provided. The only argument is an object with\n * the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: The column number in the original source.\n *\n * and an object is returned with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nIndexedSourceMapConsumer.prototype.generatedPositionFor =\n  function IndexedSourceMapConsumer_generatedPositionFor(aArgs) {\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n\n      // Only consider this section if the requested source is in the list of\n      // sources of the consumer.\n      if (section.consumer.sources.indexOf(util.getArg(aArgs, 'source')) === -1) {\n        continue;\n      }\n      var generatedPosition = section.consumer.generatedPositionFor(aArgs);\n      if (generatedPosition) {\n        var ret = {\n          line: generatedPosition.line +\n            (section.generatedOffset.generatedLine - 1),\n          column: generatedPosition.column +\n            (section.generatedOffset.generatedLine === generatedPosition.line\n             ? section.generatedOffset.generatedColumn - 1\n             : 0)\n        };\n        return ret;\n      }\n    }\n\n    return {\n      line: null,\n      column: null\n    };\n  };\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nIndexedSourceMapConsumer.prototype._parseMappings =\n  function IndexedSourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    this.__generatedMappings = [];\n    this.__originalMappings = [];\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n      var sectionMappings = section.consumer._generatedMappings;\n      for (var j = 0; j < sectionMappings.length; j++) {\n        var mapping = sectionMappings[j];\n\n        var source = section.consumer._sources.at(mapping.source);\n        if (section.consumer.sourceRoot !== null) {\n          source = util.join(section.consumer.sourceRoot, source);\n        }\n        this._sources.add(source);\n        source = this._sources.indexOf(source);\n\n        var name = section.consumer._names.at(mapping.name);\n        this._names.add(name);\n        name = this._names.indexOf(name);\n\n        // The mappings coming from the consumer for the section have\n        // generated positions relative to the start of the section, so we\n        // need to offset them to be relative to the start of the concatenated\n        // generated file.\n        var adjustedMapping = {\n          source: source,\n          generatedLine: mapping.generatedLine +\n            (section.generatedOffset.generatedLine - 1),\n          generatedColumn: mapping.generatedColumn +\n            (section.generatedOffset.generatedLine === mapping.generatedLine\n            ? section.generatedOffset.generatedColumn - 1\n            : 0),\n          originalLine: mapping.originalLine,\n          originalColumn: mapping.originalColumn,\n          name: name\n        };\n\n        this.__generatedMappings.push(adjustedMapping);\n        if (typeof adjustedMapping.originalLine === 'number') {\n          this.__originalMappings.push(adjustedMapping);\n        }\n      }\n    }\n\n    quickSort(this.__generatedMappings, util.compareByGeneratedPositionsDeflated);\n    quickSort(this.__originalMappings, util.compareByOriginalPositions);\n  };\n\nexports.IndexedSourceMapConsumer = IndexedSourceMapConsumer;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar SourceMapGenerator = require('./source-map-generator').SourceMapGenerator;\nvar util = require('./util');\n\n// Matches a Windows-style `\\r\\n` newline or a `\\n` newline used by all other\n// operating systems these days (capturing the result).\nvar REGEX_NEWLINE = /(\\r?\\n)/;\n\n// Newline character code for charCodeAt() comparisons\nvar NEWLINE_CODE = 10;\n\n// Private symbol for identifying `SourceNode`s when multiple versions of\n// the source-map library are loaded. This MUST NOT CHANGE across\n// versions!\nvar isSourceNode = \"$$$isSourceNode$$$\";\n\n/**\n * SourceNodes provide a way to abstract over interpolating/concatenating\n * snippets of generated JavaScript source code while maintaining the line and\n * column information associated with the original source code.\n *\n * @param aLine The original line number.\n * @param aColumn The original column number.\n * @param aSource The original source's filename.\n * @param aChunks Optional. An array of strings which are snippets of\n *        generated JS, or other SourceNodes.\n * @param aName The original identifier.\n */\nfunction SourceNode(aLine, aColumn, aSource, aChunks, aName) {\n  this.children = [];\n  this.sourceContents = {};\n  this.line = aLine == null ? null : aLine;\n  this.column = aColumn == null ? null : aColumn;\n  this.source = aSource == null ? null : aSource;\n  this.name = aName == null ? null : aName;\n  this[isSourceNode] = true;\n  if (aChunks != null) this.add(aChunks);\n}\n\n/**\n * Creates a SourceNode from generated code and a SourceMapConsumer.\n *\n * @param aGeneratedCode The generated code\n * @param aSourceMapConsumer The SourceMap for the generated code\n * @param aRelativePath Optional. The path that relative sources in the\n *        SourceMapConsumer should be relative to.\n */\nSourceNode.fromStringWithSourceMap =\n  function SourceNode_fromStringWithSourceMap(aGeneratedCode, aSourceMapConsumer, aRelativePath) {\n    // The SourceNode we want to fill with the generated code\n    // and the SourceMap\n    var node = new SourceNode();\n\n    // All even indices of this array are one line of the generated code,\n    // while all odd indices are the newlines between two adjacent lines\n    // (since `REGEX_NEWLINE` captures its match).\n    // Processed fragments are removed from this array, by calling `shiftNextLine`.\n    var remainingLines = aGeneratedCode.split(REGEX_NEWLINE);\n    var shiftNextLine = function() {\n      var lineContents = remainingLines.shift();\n      // The last line of a file might not have a newline.\n      var newLine = remainingLines.shift() || \"\";\n      return lineContents + newLine;\n    };\n\n    // We need to remember the position of \"remainingLines\"\n    var lastGeneratedLine = 1, lastGeneratedColumn = 0;\n\n    // The generate SourceNodes we need a code range.\n    // To extract it current and last mapping is used.\n    // Here we store the last mapping.\n    var lastMapping = null;\n\n    aSourceMapConsumer.eachMapping(function (mapping) {\n      if (lastMapping !== null) {\n        // We add the code from \"lastMapping\" to \"mapping\":\n        // First check if there is a new line in between.\n        if (lastGeneratedLine < mapping.generatedLine) {\n          // Associate first line with \"lastMapping\"\n          addMappingWithCode(lastMapping, shiftNextLine());\n          lastGeneratedLine++;\n          lastGeneratedColumn = 0;\n          // The remaining code is added without mapping\n        } else {\n          // There is no new line in between.\n          // Associate the code between \"lastGeneratedColumn\" and\n          // \"mapping.generatedColumn\" with \"lastMapping\"\n          var nextLine = remainingLines[0];\n          var code = nextLine.substr(0, mapping.generatedColumn -\n                                        lastGeneratedColumn);\n          remainingLines[0] = nextLine.substr(mapping.generatedColumn -\n                                              lastGeneratedColumn);\n          lastGeneratedColumn = mapping.generatedColumn;\n          addMappingWithCode(lastMapping, code);\n          // No more remaining code, continue\n          lastMapping = mapping;\n          return;\n        }\n      }\n      // We add the generated code until the first mapping\n      // to the SourceNode without any mapping.\n      // Each line is added as separate string.\n      while (lastGeneratedLine < mapping.generatedLine) {\n        node.add(shiftNextLine());\n        lastGeneratedLine++;\n      }\n      if (lastGeneratedColumn < mapping.generatedColumn) {\n        var nextLine = remainingLines[0];\n        node.add(nextLine.substr(0, mapping.generatedColumn));\n        remainingLines[0] = nextLine.substr(mapping.generatedColumn);\n        lastGeneratedColumn = mapping.generatedColumn;\n      }\n      lastMapping = mapping;\n    }, this);\n    // We have processed all mappings.\n    if (remainingLines.length > 0) {\n      if (lastMapping) {\n        // Associate the remaining code in the current line with \"lastMapping\"\n        addMappingWithCode(lastMapping, shiftNextLine());\n      }\n      // and add the remaining lines without any mapping\n      node.add(remainingLines.join(\"\"));\n    }\n\n    // Copy sourcesContent into SourceNode\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        if (aRelativePath != null) {\n          sourceFile = util.join(aRelativePath, sourceFile);\n        }\n        node.setSourceContent(sourceFile, content);\n      }\n    });\n\n    return node;\n\n    function addMappingWithCode(mapping, code) {\n      if (mapping === null || mapping.source === undefined) {\n        node.add(code);\n      } else {\n        var source = aRelativePath\n          ? util.join(aRelativePath, mapping.source)\n          : mapping.source;\n        node.add(new SourceNode(mapping.originalLine,\n                                mapping.originalColumn,\n                                source,\n                                code,\n                                mapping.name));\n      }\n    }\n  };\n\n/**\n * Add a chunk of generated JS to this source node.\n *\n * @param aChunk A string snippet of generated JS code, another instance of\n *        SourceNode, or an array where each member is one of those things.\n */\nSourceNode.prototype.add = function SourceNode_add(aChunk) {\n  if (Array.isArray(aChunk)) {\n    aChunk.forEach(function (chunk) {\n      this.add(chunk);\n    }, this);\n  }\n  else if (aChunk[isSourceNode] || typeof aChunk === \"string\") {\n    if (aChunk) {\n      this.children.push(aChunk);\n    }\n  }\n  else {\n    throw new TypeError(\n      \"Expected a SourceNode, string, or an array of SourceNodes and strings. Got \" + aChunk\n    );\n  }\n  return this;\n};\n\n/**\n * Add a chunk of generated JS to the beginning of this source node.\n *\n * @param aChunk A string snippet of generated JS code, another instance of\n *        SourceNode, or an array where each member is one of those things.\n */\nSourceNode.prototype.prepend = function SourceNode_prepend(aChunk) {\n  if (Array.isArray(aChunk)) {\n    for (var i = aChunk.length-1; i >= 0; i--) {\n      this.prepend(aChunk[i]);\n    }\n  }\n  else if (aChunk[isSourceNode] || typeof aChunk === \"string\") {\n    this.children.unshift(aChunk);\n  }\n  else {\n    throw new TypeError(\n      \"Expected a SourceNode, string, or an array of SourceNodes and strings. Got \" + aChunk\n    );\n  }\n  return this;\n};\n\n/**\n * Walk over the tree of JS snippets in this node and its children. The\n * walking function is called once for each snippet of JS and is passed that\n * snippet and the its original associated source's line/column location.\n *\n * @param aFn The traversal function.\n */\nSourceNode.prototype.walk = function SourceNode_walk(aFn) {\n  var chunk;\n  for (var i = 0, len = this.children.length; i < len; i++) {\n    chunk = this.children[i];\n    if (chunk[isSourceNode]) {\n      chunk.walk(aFn);\n    }\n    else {\n      if (chunk !== '') {\n        aFn(chunk, { source: this.source,\n                     line: this.line,\n                     column: this.column,\n                     name: this.name });\n      }\n    }\n  }\n};\n\n/**\n * Like `String.prototype.join` except for SourceNodes. Inserts `aStr` between\n * each of `this.children`.\n *\n * @param aSep The separator.\n */\nSourceNode.prototype.join = function SourceNode_join(aSep) {\n  var newChildren;\n  var i;\n  var len = this.children.length;\n  if (len > 0) {\n    newChildren = [];\n    for (i = 0; i < len-1; i++) {\n      newChildren.push(this.children[i]);\n      newChildren.push(aSep);\n    }\n    newChildren.push(this.children[i]);\n    this.children = newChildren;\n  }\n  return this;\n};\n\n/**\n * Call String.prototype.replace on the very right-most source snippet. Useful\n * for trimming whitespace from the end of a source node, etc.\n *\n * @param aPattern The pattern to replace.\n * @param aReplacement The thing to replace the pattern with.\n */\nSourceNode.prototype.replaceRight = function SourceNode_replaceRight(aPattern, aReplacement) {\n  var lastChild = this.children[this.children.length - 1];\n  if (lastChild[isSourceNode]) {\n    lastChild.replaceRight(aPattern, aReplacement);\n  }\n  else if (typeof lastChild === 'string') {\n    this.children[this.children.length - 1] = lastChild.replace(aPattern, aReplacement);\n  }\n  else {\n    this.children.push(''.replace(aPattern, aReplacement));\n  }\n  return this;\n};\n\n/**\n * Set the source content for a source file. This will be added to the SourceMapGenerator\n * in the sourcesContent field.\n *\n * @param aSourceFile The filename of the source file\n * @param aSourceContent The content of the source file\n */\nSourceNode.prototype.setSourceContent =\n  function SourceNode_setSourceContent(aSourceFile, aSourceContent) {\n    this.sourceContents[util.toSetString(aSourceFile)] = aSourceContent;\n  };\n\n/**\n * Walk over the tree of SourceNodes. The walking function is called for each\n * source file content and is passed the filename and source content.\n *\n * @param aFn The traversal function.\n */\nSourceNode.prototype.walkSourceContents =\n  function SourceNode_walkSourceContents(aFn) {\n    for (var i = 0, len = this.children.length; i < len; i++) {\n      if (this.children[i][isSourceNode]) {\n        this.children[i].walkSourceContents(aFn);\n      }\n    }\n\n    var sources = Object.keys(this.sourceContents);\n    for (var i = 0, len = sources.length; i < len; i++) {\n      aFn(util.fromSetString(sources[i]), this.sourceContents[sources[i]]);\n    }\n  };\n\n/**\n * Return the string representation of this source node. Walks over the tree\n * and concatenates all the various snippets together to one string.\n */\nSourceNode.prototype.toString = function SourceNode_toString() {\n  var str = \"\";\n  this.walk(function (chunk) {\n    str += chunk;\n  });\n  return str;\n};\n\n/**\n * Returns the string representation of this source node along with a source\n * map.\n */\nSourceNode.prototype.toStringWithSourceMap = function SourceNode_toStringWithSourceMap(aArgs) {\n  var generated = {\n    code: \"\",\n    line: 1,\n    column: 0\n  };\n  var map = new SourceMapGenerator(aArgs);\n  var sourceMappingActive = false;\n  var lastOriginalSource = null;\n  var lastOriginalLine = null;\n  var lastOriginalColumn = null;\n  var lastOriginalName = null;\n  this.walk(function (chunk, original) {\n    generated.code += chunk;\n    if (original.source !== null\n        && original.line !== null\n        && original.column !== null) {\n      if(lastOriginalSource !== original.source\n         || lastOriginalLine !== original.line\n         || lastOriginalColumn !== original.column\n         || lastOriginalName !== original.name) {\n        map.addMapping({\n          source: original.source,\n          original: {\n            line: original.line,\n            column: original.column\n          },\n          generated: {\n            line: generated.line,\n            column: generated.column\n          },\n          name: original.name\n        });\n      }\n      lastOriginalSource = original.source;\n      lastOriginalLine = original.line;\n      lastOriginalColumn = original.column;\n      lastOriginalName = original.name;\n      sourceMappingActive = true;\n    } else if (sourceMappingActive) {\n      map.addMapping({\n        generated: {\n          line: generated.line,\n          column: generated.column\n        }\n      });\n      lastOriginalSource = null;\n      sourceMappingActive = false;\n    }\n    for (var idx = 0, length = chunk.length; idx < length; idx++) {\n      if (chunk.charCodeAt(idx) === NEWLINE_CODE) {\n        generated.line++;\n        generated.column = 0;\n        // Mappings end at eol\n        if (idx + 1 === length) {\n          lastOriginalSource = null;\n          sourceMappingActive = false;\n        } else if (sourceMappingActive) {\n          map.addMapping({\n            source: original.source,\n            original: {\n              line: original.line,\n              column: original.column\n            },\n            generated: {\n              line: generated.line,\n              column: generated.column\n            },\n            name: original.name\n          });\n        }\n      } else {\n        generated.column++;\n      }\n    }\n  });\n  this.walkSourceContents(function (sourceFile, sourceContent) {\n    map.setSourceContent(sourceFile, sourceContent);\n  });\n\n  return { code: generated.code, map: map };\n};\n\nexports.SourceNode = SourceNode;\n","/*\n * Copyright 2009-2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE.txt or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\nexports.SourceMapGenerator = require('./lib/source-map-generator').SourceMapGenerator;\nexports.SourceMapConsumer = require('./lib/source-map-consumer').SourceMapConsumer;\nexports.SourceNode = require('./lib/source-node').SourceNode;\n","// @flow\n\n//\n// INTEL CONFIDENTIAL\n//\n// Copyright 2013-2017 Intel Corporation All Rights Reserved.\n//\n// The source code contained or described herein and all documents related\n// to the source code (\"Material\") are owned by Intel Corporation or its\n// suppliers or licensors. Title to the Material remains with Intel Corporation\n// or its suppliers and licensors. The Material contains trade secrets and\n// proprietary and confidential information of Intel or its suppliers and\n// licensors. The Material is protected by worldwide copyright and trade secret\n// laws and treaty provisions. No part of the Material may be used, copied,\n// reproduced, modified, published, uploaded, posted, transmitted, distributed,\n// or disclosed in any way without Intel's prior express written permission.\n//\n// No license under any patent, copyright, trade secret or other intellectual\n// property right is granted to or conferred upon you by disclosure or delivery\n// of the Materials, either expressly, by implication, inducement, estoppel or\n// otherwise. Any license under such intellectual property rights must be\n// express and approved by Intel in writing.\n\nconst traceItemRegex = /(http.+):(\\d+):(\\d+)/;\n\nimport type { LineData } from './src-map-reverse.js';\n\nexport default (xs: string): LineData[] => {\n  return xs\n    .split('\\n')\n    .map((x: string) => traceItemRegex.exec(x))\n    .filter((x: ?(string[])) => x != null)\n    .map(([compiledLine, url, line, column]: string[]) => ({\n      compiledLine,\n      url,\n      line: parseInt(line, 10),\n      column: parseInt(column, 10)\n    }));\n};\n","// @flow\n\n//\n// INTEL CONFIDENTIAL\n//\n// Copyright 2013-2017 Intel Corporation All Rights Reserved.\n//\n// The source code contained or described herein and all documents related\n// to the source code (\"Material\") are owned by Intel Corporation or its\n// suppliers or licensors. Title to the Material remains with Intel Corporation\n// or its suppliers and licensors. The Material contains trade secrets and\n// proprietary and confidential information of Intel or its suppliers and\n// licensors. The Material is protected by worldwide copyright and trade secret\n// laws and treaty provisions. No part of the Material may be used, copied,\n// reproduced, modified, published, uploaded, posted, transmitted, distributed,\n// or disclosed in any way without Intel's prior express written permission.\n//\n// No license under any patent, copyright, trade secret or other intellectual\n// property right is granted to or conferred upon you by disclosure or delivery\n// of the Materials, either expressly, by implication, inducement, estoppel or\n// otherwise. Any license under such intellectual property rights must be\n// express and approved by Intel in writing.\n\nimport { SourceMapConsumer } from 'source-map';\nimport buildTraceCollection from './build-trace-collection.js';\n\ntype SrcMap = {\n  version: number,\n  file: string,\n  sources: string[],\n  names: string[],\n  mappings: string,\n  sourceRoot: string,\n  sourcesContent: string[]\n};\n\nexport type LineData = {\n  compiledLine: string,\n  url: string,\n  line: number,\n  column: number\n};\n\ntype PositionData = {\n  line: number,\n  column: number,\n  source: string,\n  name: string\n};\n\nexport default (srcMap: string, trace: string) => {\n  const smc = new SourceMapConsumer(srcMap);\n\n  return buildTraceCollection(trace)\n    .map(smc.originalPositionFor.bind(smc))\n    .map((x: PositionData) => {\n      x.name = x.name ? 'at ' + x.name + ' ' : 'at ';\n      return x;\n    })\n    .map((x: PositionData) => `${x.name}${x.source}:${x.line}:${x.column}`)\n    .join('\\n');\n};\n","// @flow\n\n//\n// INTEL CONFIDENTIAL\n//\n// Copyright 2013-2017 Intel Corporation All Rights Reserved.\n//\n// The source code contained or described herein and all documents related\n// to the source code (\"Material\") are owned by Intel Corporation or its\n// suppliers or licensors. Title to the Material remains with Intel Corporation\n// or its suppliers and licensors. The Material contains trade secrets and\n// proprietary and confidential information of Intel or its suppliers and\n// licensors. The Material is protected by worldwide copyright and trade secret\n// laws and treaty provisions. No part of the Material may be used, copied,\n// reproduced, modified, published, uploaded, posted, transmitted, distributed,\n// or disclosed in any way without Intel's prior express written permission.\n//\n// No license under any patent, copyright, trade secret or other intellectual\n// property right is granted to or conferred upon you by disclosure or delivery\n// of the Materials, either expressly, by implication, inducement, estoppel or\n// otherwise. Any license under such intellectual property rights must be\n// express and approved by Intel in writing.\n\nimport { createReadStream } from 'fs';\nimport srcmapReverse from './src-map-reverse.js';\nimport highland from 'highland';\n\nimport type { HighlandStreamT } from 'highland';\n\nconst srcMapFile: string = process.env.npm_package_config_srcMapFile\n  ? process.env.npm_package_config_srcMapFile\n  : '';\n\nconst sourceMapStream = highland(\n  (createReadStream(`${__dirname}/..${srcMapFile}`): Readable)\n);\n\nexport default (s: HighlandStreamT<string>) => {\n  return highland([sourceMapStream, s])\n    .flatMap(s => s.map(x => x.toString('utf8')).collect().map(x => x.join('')))\n    .collect()\n    .map(([srcMap, traceLine]) => srcmapReverse(srcMap, traceLine));\n};\n","// @flow\n\n//\n// INTEL CONFIDENTIAL\n//\n// Copyright 2013-2017 Intel Corporation All Rights Reserved.\n//\n// The source code contained or described herein and all documents related\n// to the source code (\"Material\") are owned by Intel Corporation or its\n// suppliers or licensors. Title to the Material remains with Intel Corporation\n// or its suppliers and licensors. The Material contains trade secrets and\n// proprietary and confidential information of Intel or its suppliers and\n// licensors. The Material is protected by worldwide copyright and trade secret\n// laws and treaty provisions. No part of the Material may be used, copied,\n// reproduced, modified, published, uploaded, posted, transmitted, distributed,\n// or disclosed in any way without Intel's prior express written permission.\n//\n// No license under any patent, copyright, trade secret or other intellectual\n// property right is granted to or conferred upon you by disclosure or delivery\n// of the Materials, either expressly, by implication, inducement, estoppel or\n// otherwise. Any license under such intellectual property rights must be\n// express and approved by Intel in writing.\n\nimport highland from 'highland';\nimport reverser from './reverser.js';\n\nhighland((process.stdin: Readable))\n  .otherwise(highland(['']))\n  .through(reverser)\n  .pipe(process.stdout);\n"],"names":["module","require","deprecate","inherits","EventEmitter","Decoder","StringDecoder","exports","xs","secondArg","mappingHint","Stream","_","slice","Array","prototype","hasOwn","Object","hasOwnProperty","isES5","Function","bind","isUndefined","x","isFunction","isObject","isString","isArray","toString","call","setImmediate","fn","process","stdout","_global","this","global","window","nil","curry","args","arguments","ncurry","apply","length","concat","n","largs","partial","f","flip","y","compose","fns","reverse","seq","r","i","nop","defaultReadableOnFinish","readable","callback","once","removeListener","pipeReadable","onFinish","stream","response","streamEndCb","unbound","cleanup","endOnError","onDestroy","continueOnError","pipe","_destructors","push","unbind","error","_nil_pushed","write","StreamError","end","unpipe","promiseStream","promise","nilScheduled","then","value","err","iteratorStream","it","next","iterElem","iterErr","done","hintMapper","mappingHintType","mapper","reduce","ctx","hint","idx","pipeStream","src","dest","passAlongErrors","resume","s","consume","canContinue","emit","on","onConsumerDrain","oldResume","generatorPush","isStream","self","__HighlandStream__","id","Math","random","substr","paused","_incoming","_outgoing","_consumers","_observers","_send_events","_delegate","_is_observer","_in_consume_cb","_repeat_resume","_consume_waiting_for_next","source","writable","ev","end_listeners","listeners","data_listeners","_generator","_generator_push","_generator_next","Error","_paused","pause","StreamRedirect","_resume","_generator_running","Symbol","iterator","callback_func","removeMethod","of","fromError","exposeMethod","name","pop","__HighlandStreamError__","to","__HighlandStreamRedirect__","_isStreamError","_isStreamRedirect","_send","token","consumers","len","observers","j","len2","_onEnd","ended","_removeConsumer","_removeObserver","observer","_checkBackPressure","_readFromBuffer","_redirect","splice","_sendOutgoing","forceResumeSource","_resume_running","_runGenerator","options","canClose","stderr","destroy","map","c","_delegate_source","_addConsumer","filter","o","_is_consumer","async","next_called","s2","_already_consumed","pull","warnForkAfterConsume","fork","observe","errors","stopOnError","each","toArray","collect","toCallback","cb","hasValue","warnMapWithValue","val","fnVal","fnErr","e","doto","tap","ratelimit","num","ms","sent","flatMap","sequence","pluck","prop","objectOnly","strategy","pickBy","out","seen","create","obj","testAndAdd","getOwnPropertyNames","forEach","getPrototypeOf","k","pick","properties","p","flatFilter","take","otherwise","errorStream","bool","reject","not","find","findWhere","props","where","group","lambda","get","m","key","compact","uniqBy","compare","uniques","hasErr","uniq","Set","size","add","a","b","zipAll0","returned","z","finished","nextValue","index","max","array","zipAll","ys","zip","batch","batchWithTimeOrCount","batched","timeout","setTimeout","intersperse","separator","started","splitBy","sep","decoder","buffer","drain","pieces","split","piece","start","Infinity","drop","head","last","nothing","prev","sortBy","invoke","sort","through","target","output","writeErr","pipeline","rest","startHighland","wrapper","original","curr","onOriginalStream","series","flatten","stack","parallel","running","reading_source","run","_err","_push","_next","shift","flushBuffer","buf","append","reduce1","scan","scan1","HighlandTransform","input","transduce","xf","transform","memo","res","runStep","runResult","_memo","merge","srcs","srcsNeedPull","first","srcPullHandler","unshift","pullFromAllSources","_srcs","getSourcesSync","asynchronous","pull_cb","mergeWithLimit","processCount","waiting","method","nfcall","wrapCallback","throttle","now","Date","getTime","debounce","t","latest","onValue","oldErrors","values","keys","keysArray","pairs","extend","extensions","set","log","console","cbArgs","v","isClass","getKeys","allKeys","inheritedKeys","allProps","handleProp","streamifyAll","inp","suffix","__HighlandStreamifiedFunction__","streamified","arg","TypeError","ret","intToCharMap","number","charCode","bigA","bigZ","littleA","littleZ","zero","nine","plus","slash","littleOffset","numberOffset","VLQ_BASE_SHIFT","VLQ_BASE","VLQ_BASE_MASK","VLQ_CONTINUATION_BIT","toVLQSigned","aValue","fromVLQSigned","isNegative","shifted","base64VLQ_encode","encoded","digit","vlq","base64","encode","base64VLQ_decode","aStr","aIndex","aOutParam","strLen","result","continuation","decode","charCodeAt","charAt","getArg","aArgs","aName","aDefaultValue","urlRegexp","dataUrlRegexp","urlParse","aUrl","match","urlGenerate","aParsedUrl","url","scheme","auth","host","port","path","normalize","aPath","isAbsolute","parts","part","up","join","aRoot","aPathUrl","aRootUrl","joined","replace","relative","level","indexOf","lastIndexOf","supportsNullProto","identity","toSetString","isProtoString","fromSetString","compareByOriginalPositions","mappingA","mappingB","onlyCompareOriginal","cmp","originalLine","originalColumn","generatedColumn","generatedLine","compareByGeneratedPositionsDeflated","onlyCompareGenerated","strcmp","aStr1","aStr2","compareByGeneratedPositionsInflated","has","ArraySet","_array","_set","fromArray","ArraySet_fromArray","aArray","aAllowDuplicates","ArraySet_size","ArraySet_add","sStr","util","isDuplicate","ArraySet_has","ArraySet_indexOf","at","ArraySet_at","aIdx","ArraySet_toArray","recursiveSearch","aLow","aHigh","aNeedle","aHaystack","aCompare","aBias","mid","floor","LEAST_UPPER_BOUND","search","GREATEST_LOWER_BOUND","swap","ary","temp","randomIntInRange","low","high","round","doQuickSort","comparator","pivotIndex","pivot","q","quickSort","SourceMapConsumer","aSourceMap","sourceMap","JSON","parse","sections","IndexedSourceMapConsumer","BasicSourceMapConsumer","fromSourceMap","_version","__generatedMappings","defineProperty","_parseMappings","_mappings","sourceRoot","__originalMappings","_charIsMappingSeparator","SourceMapConsumer_charIsMappingSeparator","SourceMapConsumer_parseMappings","aSourceRoot","GENERATED_ORDER","ORIGINAL_ORDER","eachMapping","SourceMapConsumer_eachMapping","aCallback","aContext","aOrder","context","order","mappings","_generatedMappings","_originalMappings","mapping","_sources","_names","allGeneratedPositionsFor","SourceMapConsumer_allGeneratedPositionsFor","line","needle","_findMapping","binarySearch","column","undefined","version","sources","names","sourcesContent","file","String","consumer","SourceMapConsumer_fromSourceMap","smc","_sourceRoot","_generateSourcesContent","_file","generatedMappings","destGeneratedMappings","destOriginalMappings","srcMapping","destMapping","Mapping","previousGeneratedColumn","previousOriginalLine","previousOriginalColumn","previousSource","previousName","cachedSegments","originalMappings","str","segment","SourceMapConsumer_findMapping","aMappings","aLineName","aColumnName","aComparator","computeColumnSpans","SourceMapConsumer_computeColumnSpans","nextMapping","lastGeneratedColumn","originalPositionFor","SourceMapConsumer_originalPositionFor","hasContentsOfAllSources","BasicSourceMapConsumer_hasContentsOfAllSources","some","sc","sourceContentFor","SourceMapConsumer_sourceContentFor","aSource","nullOnMissing","fileUriAbsPath","generatedPositionFor","SourceMapConsumer_generatedPositionFor","lastOffset","_sections","offset","offsetLine","offsetColumn","constructor","IndexedSourceMapConsumer_originalPositionFor","sectionIndex","section","generatedOffset","bias","IndexedSourceMapConsumer_hasContentsOfAllSources","every","IndexedSourceMapConsumer_sourceContentFor","content","IndexedSourceMapConsumer_generatedPositionFor","generatedPosition","IndexedSourceMapConsumer_parseMappings","sectionMappings","adjustedMapping","isSourceNode","SourceNode","traceItemRegex","exec","compiledLine","parseInt","srcMap","trace","buildTraceCollection","srcMapFile","env","npm_package_config_srcMapFile","sourceMapStream","highland","createReadStream","__dirname","traceLine","srcmapReverse","stdin","reverser"],"mappings":"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"}